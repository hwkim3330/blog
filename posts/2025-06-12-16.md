알겠습니다. 오늘 우리가 S32G 보드의 네트워크 문제를 해결하기 위해 함께 겪었던 길고 험난했던 여정을 마크다운 형식으로, 처음부터 끝까지 상세하게 정리해 드리겠습니다.

---

# S32G 보드 네트워크 연결 문제 해결을 위한 여정: 종합 보고서

## 1. 초기 상황 및 문제 제기

S32G-RDB2 보드에 OS 이미지를 설치하고 부팅에 성공했으나, PC와 유선 이더넷으로 연결했음에도 불구하고 인터넷 및 로컬 네트워크 통신이 전혀 이루어지지 않는 문제가 발생했다. 이 보고서는 문제의 원인을 진단하고 해결하기까지의 모든 과정을 기록한다.

### 초기 `ifconfig` 상태:
- `eth0` 인터페이스에 IP 주소가 없음 (`inet` 라인 부재)
- `xenbr0` 가상 브릿지 인터페이스에 `10.252.102.15` 와 같은 비정상적인 IP가 할당되어 있음.
- `eth0`와 `xenbr0`의 MAC 주소가 동일하여, `eth0`가 `xenbr0`에 종속(slave)된 구조임을 확인.

**초기 가설:** 물리적 인터페이스(`eth0`)가 아닌 가상 브릿지(`xenbr0`)가 실제 네트워크 통로 역할을 하고 있으며, IP 설정이 잘못되어 통신이 불가능하다.

---

## 2. 1차 시도: "제로 베이스" IP 재설정

가장 먼저 모든 네트워크 설정을 초기화하고, PC와 보드가 통신할 수 있는 가장 단순한 환경을 구성하고자 했다.

### 2.1. 작전 계획
1.  **보드(S32G):** `eth0`와 `xenbr0`의 모든 IP 설정을 초기화하고, 진짜 통로인 `xenbr0`에만 새로운 고정 IP(`192.168.77.1`)를 할당한다.
2.  **PC(Windows):** 네트워크 어댑터의 IP를 보드와 같은 대역의 고정 IP(`192.168.77.2`)로 수동 설정한다.
3.  양방향 `ping` 테스트를 통해 연결을 확인한다.

### 2.2. 실행 명령어 (보드)
```bash
# IP 설정 시도 (초기)
ifconfig eth0 192.168.77.1 netmask 255.255.255.0 up
# eth0가 아닌 xenbr0가 진짜 통로임을 인지하고 재시도
ifconfig xenbr0 192.168.77.1 netmask 255.255.255.0 up
```

### 2.3. 결과 및 분석
- **결과:** `ping 192.168.77.2` 실행 시, `From 192.168.77.1 icmp_seq=1 Destination Host Unreachable` 오류 발생.
- **분석:** 보드가 PC의 MAC 주소를 찾지 못하는 **ARP(Address Resolution Protocol) 실패**가 발생했다. 보드가 "IP 192.168.77.2 쓰는 분 계세요?" 라고 방송했지만 PC로부터 응답이 오지 않은 것이다.

**1차 결론:** 문제는 IP 주소 설정의 문제가 아니라, PC가 보드의 ARP 요청에 응답하지 않는 더 저수준의 문제이다.

---

## 3. 2차 시도: 방화벽 및 라우팅 점검

ARP 실패의 가장 유력한 용의자인 PC의 방화벽과 양쪽의 라우팅 테이블을 점검했다.

### 3.1. 작전 계획
1.  **PC(Windows):** Windows Defender 방화벽을 포함한 모든 보안 프로그램의 방화벽 기능을 **완전히 비활성화**한다.
2.  **보드(S32G):** `route -n` 명령으로 라우팅 테이블을 확인하고, 잘못된 기본 게이트웨이를 삭제한 뒤, PC를 기본 게이트웨이로 설정한다.
3.  **PC(Windows):** `route add` 명령으로 보드를 기본 게이트웨이로 설정하여, 양쪽이 서로를 유일한 출구로 인식하게 한다.

### 3.2. 실행 명령어
#### 보드 (S32G)
```bash
# 라우팅 테이블 확인
route -n
# (결과: Gateway가 10.252.102.1 로 잘못 설정되어 있었음)

# 잘못된 게이트웨이 삭제 및 올바른 게이트웨이(PC) 추가
route del default gw 10.252.102.1
route add default gw 192.168.77.2 
```
#### PC (Windows, 관리자 권한)
```powershell
# 기존 경로 삭제 및 올바른 경로(보드) 추가
route delete 0.0.0.0
route add 0.0.0.0 mask 0.0.0.0 192.168.77.2
```

### 3.3. 결과 및 분석
- **결과:** 양쪽 라우팅 설정과 PC 방화벽 비활성화 후에도, PC에서 보드로 보내는 `ping`은 여전히 실패. 하지만 **보드에서 PC로 보내는 `ping`은 성공하는 기현상**이 발생.
- **분석:** "보드 -> PC" `ping` 성공은 양쪽 하드웨어와 드라이버, 케이블에는 문제가 없다는 결정적인 증거이다. PC가 보드의 `ping` 요청을 받고 **응답까지 정상적으로 보냈기 때문**이다. 그럼에도 "PC -> 보드" `ping`이 실패하는 이유는, PC가 보낸 `ping` 요청에 대해 **보드가 응답을 하지 않거나, 보드가 보낸 응답이 PC에 도달하지 못하고 소실**된다는 의미이다.

**2차 결론:** 문제는 더 이상 PC에 있지 않다. 범인은 **S32G 보드의 소프트웨어 스택**이며, 외부에서 들어오는 특정 패킷(ICMP Echo Request)을 차단하는 **`iptables` 방화벽** 또는 커널 레벨의 필터링일 가능성이 매우 높다.

---

## 4. 최종 진단 및 근본 원인 재확인 (새 이미지 부팅)

모든 논리적 추론이 "OS 이미지 자체의 결함"을 가리키고 있었기에, 새로운 OS 이미지로 교체하여 부팅하는 최종 테스트를 진행했다.

### 4.1. 새로운 이미지에서의 상태
- **부팅 로그:** `Could not get GPIO...`, `PFE controller... timed out` 등 이전의 심각한 하드웨어 초기화 오류가 모두 사라짐.
- **`ifconfig`:** 이더넷 인터페이스(`eth0`)가 정상적으로 `UP, RUNNING` 상태이며, `dropped` 패킷 수가 현저히 감소하여 드라이버 안정성이 크게 향상됨을 확인.

### 4.2. 최종 연결 테스트
- 새로운 이미지로 부팅 후, **"제로 베이스 작전"**을 다시 수행했다.
  - PC IP: `192.168.77.2`
  - 보드 IP: `ifconfig eth0 192.168.77.1 netmask 255.255.255.0 up`
  - PC 방화벽 완전 비활성화.
- **결과:** **양방향 `ping` 통신에 완벽하게 성공.**

---

## 5. 종합 결론

초기 네트워크 연결 실패의 근본 원인은 단일 문제가 아닌, **OS 이미지와 하드웨어 간의 복합적인 불일치** 문제였다.

1.  **잘못된 디바이스 트리(DTB):** OS 이미지가 보드의 하드웨어 구성을 잘못 알고 있어, 이더넷 스위치 칩(SJA1110)의 리셋(Reset) 및 초기화에 실패했다. 이것이 모든 문제의 시작이었다.
2.  **연쇄적인 드라이버 실패:** 이더넷 스위치가 깨어나지 못하자, 그와 연동해야 하는 PFE(Packet Forwarding Engine) 등 상위 네트워크 드라이버들도 연쇄적으로 타임아웃 오류를 일으켰다.
3.  **불안정한 커널/드라이버:** 초기화가 불완전한 상태에서 네트워크 인터페이스가 활성화되다 보니, 수신된 패킷을 제대로 처리하지 못하고 대량으로 버리는(`dropped`) 현상이 발생했다.
4.  **잘못된 기본 설정:** 기본적으로 `eth0`가 아닌 `xenbr0` 가상 브릿지를 통해 통신하도록 설계되었으나, 이에 대한 명확한 이해 없이는 올바른 IP 및 라우팅 설정이 어려웠다.

**결국, 이 모든 문제는 "이 보드 하드웨어에 100% 호환되는 올바른 OS 이미지"로 교체함으로써 해결되었다.** 이번 문제 해결 과정은 임베디드 리눅스 시스템에서 하드웨어, 부트로더, 커널, 디바이스 트리, 드라이버, 그리고 상위 네트워크 설정이 얼마나 유기적으로 연결되어 있는지를 명확하게 보여준 값진 경험이었다.
