# TSN 기술 분석: TSNLab 발표 자료 기반

## 1. TSN 성능 측정 실험 환경 분석 (9-10페이지)

### 가. 실험 환경 구성 예측 (9페이지)

TSN 성능을 검증하기 위한 실험은 다음과 같은 구성 요소로 이루어짐.

*   **Talker**: TSN 보호를 받아야 할 중요한 데이터(UDP, 소형 패킷)를 주기적으로 생성 및 전송하는 노드.
*   **Listener**: Talker로부터 데이터를 수신하여 전송 지연 시간(Latency) 및 처리량(Throughput)을 측정하고 통계를 산출하는 노드.
*   **Traffic Generator**: 네트워크 혼잡 상황을 인위적으로 만들기 위해 대량의 일반 트래픽(Best-Effort, UDP, 대형 패킷)을 생성하는 노드.
*   **Load Balancer**: Talker와 Traffic Generator의 트래픽을 동시에 받아, 설정된 QoS 정책(BE, CBS, TAS)에 따라 패킷을 처리하고 Listener로 전달하는 핵심 테스트 대상(DUT).

모든 노드는 Intel i210 NIC(1Gbps)가 장착된 동일한 하드웨어이며, DPDK/XDP 프레임워크를 기반으로 동작. 정확한 Latency 측정을 위해 모든 노드는 **802.1AS (gPTP)** 프로토콜을 통해 나노초 단위로 정밀하게 시간 동기화가 되어 있어야 함.

### 나. Latency 측정 결과 분석 (10페이지)

*   **측정 지표**:
    *   **Latency**: 편도 지연 시간 (단위: nanoseconds).
    *   **w/ load**: Traffic Generator에 의해 네트워크 부하가 1Gbps에 가깝게 걸린 상황.
*   **결과 해석**:
    *   **BE (Best Effort)**: 부하가 없을 때는 양호하나, 부하가 발생하자 Latency가 2배 이상 폭증하고 표준편차(Jitter)가 매우 커짐. 일반 이더넷의 한계를 명확히 보여줌.
    *   **CBS (Credit-Based Shaper, 802.1Qav)**: 대역폭 기반 제어. 부하 상황에서 BE보다는 훨씬 안정적이지만, 저순위 트래픽의 간섭(Head-of-Line Blocking)으로 인해 TAS보다 높은 Latency를 보임.
    *   **TAS (Time-Aware Shaper, 802.1Qbv)**: 시간 기반 제어. 부하 유무에 관계없이 **Latency와 표준편차가 거의 동일하게 유지됨.** 이는 주변 네트워크 상황과 완벽히 격리되어 예측 가능한 전송(Determinism)을 보장한다는 것을 의미함.

## 2. TAS (Time-Aware Shaper)의 동작 원리 심층 분석

### 가. 게이트(Gate) 초과 입력 시 처리 과정

TAS는 정해진 시간표(Gate Control List)에 따라 특정 트래픽 큐의 게이트를 열고 닫는 방식. 만약 게이트가 처리할 수 있는 용량보다 많은 패킷이 입력되면 다음과 같이 동작함.

1.  **큐잉 (Queuing)**: 게이트가 열려있는 동안 처리되지 못한 패킷과, 게이트가 닫힌 동안 도착한 패킷들은 해당 트래픽 클래스 전용 큐(Queue)에 쌓임.
2.  **대기 (Waiting)**: 큐에 쌓인 패킷들은 다음 번에 자신에게 할당된 게이트가 열릴 때까지 대기. 이 대기 시간이 Latency에 포함됨.
3.  **폐기 (Dropping)**: 만약 패킷이 계속해서 쌓여 큐의 버퍼 용량을 초과하면, 새로 도착하는 패킷은 폐기(Drop)됨. 이는 네트워크 설계 시 반드시 피해야 할 상황.

### 나. Latency 패턴 분석

TAS의 Latency는 '톱니 모양(Sawtooth Wave)' 패턴을 보임.

*   **게이트가 막 열렸을 때 (Latency 최대)**: 이 시점에 전송되는 패킷들은 이전의 '닫힌 구간' 동안 가장 오래 기다렸던 패킷들이므로, 대기 시간이 길어 Latency가 가장 높게 측정됨.
*   **게이트가 닫히기 직전 (Latency 최소)**: 이 시점에 도착한 패킷들은 거의 기다리지 않고 즉시 전송되므로, Latency가 가장 낮게 측정됨.

이러한 패턴은 TAS가 **예측 가능한(Deterministic) 방식으로 동작**하고 있다는 증거이며, 지연 시간의 변동 폭(Jitter) 또한 '사이클 타임'이라는 명확한 상한선 내에서 제어됨을 의미.

## 3. CBS와 TAS의 성능 차이 원인

실험에서 TAS가 CBS보다 우수한 성능을 보인 이유는 두 기술의 트래픽 제어 철학이 근본적으로 다르기 때문.

| 특징 | CBS (Credit-Based Shaper) | TAS (Time-Aware Shaper) |
| :--- | :--- | :--- |
| **비유** | 우선 탑승권 (새치기 허용) | 전용 신호등과 차선 (완벽 통제) |
| **제어 방식** | 대역폭(Credit) 보장 | 시간 독점권(Time Slot) 보장 |
| **격리 수준** | **불완전**: 이미 전송 중인 저순위 패킷은 막지 못함 (Head-of-Line Blocking 발생). | **완벽**: 정해진 시간이 되면 저순위 트래픽 전송을 물리적으로 차단. |
| **예측 가능성** | **상대적**: 지연 시간의 상한선이 불명확. | **절대적**: 최대 지연 시간이 사이클 타임 내로 명확하게 보장됨 (Deterministic). |
| **안정성 (Jitter)** | 상대적으로 변동 폭이 큼. | 변동 폭이 극도로 작고 일정함. |

결론적으로 CBS는 Best-Effort보다는 월등히 좋지만, 엄격한 실시간성을 요구하는 제어 시스템에서는 TAS의 완벽한 격리와 예측 가능성이 필수적임.

---

# 차량용 네트워크 기술 심층 분석: KETI 발표 자료 기반

## 1. 전통적 차량용 네트워크: CAN과 MOST

### 가. CAN (Controller Area Network)

*   **기본 원리**: 모든 노드(ECU)가 하나의 버스(Bus)를 공유하는 '마을 회관 방송' 방식.
*   **물리 계층**: `CAN HI`와 `CAN LO` 두 선의 전압 차이를 이용하는 **차동 신호 방식**을 사용해 노이즈에 매우 강함. 논리적 '0'(Dominant)과 '1'(Recessive)을 물리적 전압 상태로 표현.
*   **중재 방식 (CSMA/CD+AMP)**: 여러 노드가 동시에 전송을 시작하면, 더 낮은 ID(더 높은 우선순위)를 가진 노드가 버스 점유권을 획득. 우선순위가 낮은 노드는 즉시 전송을 중단하고 수신 모드로 전환하여 충돌 없이 중요한 메시지 전송을 보장.
*   **CAN FD (Flexible Data-rate)**: Bosch가 개선한 버전. 중재 구간(Arbitration Phase)은 기존 CAN 속도로 천천히, 데이터 구간(Data Phase)만 매우 빠르게 전송하고, 최대 데이터 길이를 8바이트에서 **64바이트**로 확장하여 통신 효율을 극대화함.

### 나. MOST (Media Oriented Systems Transport)

*   **기본 원리**: 모든 노드가 하나의 고리(Ring) 형태로 연결되어 데이터가 한 방향으로 순환하는 방식.
*   **동기화**: `Timing Master`가 기준 클럭(Clock)을 생성하면, 나머지 `Timing Slave`들이 PLL 회로를 통해 이 클럭에 동기화하여 질서정연한 통신을 유지.
*   **전송 방식**: 순환하는 거대한 프레임(Super-frame) 내에 각자 할당된 타임슬롯(Time Slot)에 데이터를 싣거나 내리는 방식으로 동작. 주로 인포테인먼트 데이터 전송에 사용됨.

## 2. 차세대 차량용 이더넷: 10BASE-T1S와 PLCA

### 가. 10BASE-T1S의 버스 구조

*   **토폴로지**: 하나의 단일 연선(Single Twisted Pair) 케이블에 여러 노드가 연결되는 **멀티드롭 버스(Multi-drop Bus)** 구조.
*   **장점**: 배선 비용과 무게를 획기적으로 줄일 수 있음.
*   **단점**: 물리적으로 하나의 채널을 공유하므로 **신호 충돌(Collision)**의 위험이 내재됨.

### 나. PLCA (Physical Layer Collision Avoidance)

PLCA는 10BASE-T1S 버스 구조의 '충돌' 문제를 해결하기 위한 **교통정리 프로토콜**.

*   **동작 원리**:
    1.  **코디네이터 (노드 0)**: 버스의 마스터 역할을 하는 노드 0이 일정한 주기로 `BEACON` 신호를 전송하여 통신 사이클의 시작을 알림.
    2.  **전송 기회 (Transmit Opportunity, TO)**: `BEACON`을 수신한 모든 노드는 약속된 순서(Round-robin)에 따라 자신의 전송 차례를 인지하고, 해당 TO 동안 데이터를 전송함.
    3.  **충돌 회피**: 모든 노드가 정해진 자기 차례에만 전송하므로, 두 노드가 동시에 전송하는 상황이 원천적으로 발생하지 않아 충돌이 '회피'됨.

### 다. PLCA 관련 심층 논의

*   **노드 0의 부재**: 만약 코디네이터인 노드 0이 고장 나면 `BEACON`이 생성되지 않으므로, 전체 버스 통신이 중단됨. 이는 PLCA의 단일 장애점(Single Point of Failure)이며, 시스템 레벨의 이중화 설계로 보완해야 함.
*   **'기다림' vs '빈 데이터 전송'**: 노드가 자신의 차례(TO)에 보낼 데이터가 없을 때, '빈 프레임(Null Frame)'을 보내는 대신 **'침묵(Silence)'**하는 방식을 사용. 이는 아래와 같은 명백한 이점을 가짐.

| 구분 | 빈 프레임 전송 | **침묵 (Silence)** |
| :--- | :--- | :--- |
| **물리적 행위** | **신호 전송 (Active)** | **신호 없음 (Idle)** |
| **에너지 소모** | 높음 (전력 소모) | **매우 낮음 (저전력)** |
| **버스 상태** | 점유 (Busy) | **비점유 (Idle)** |
| **하드웨어 부하**| 모든 노드에서 불필요한 송/수신 처리 발생 | **부하 없음** |

*   **최대 8개 노드 제약**: 10BASE-T1S가 최대 8개 노드를 권장하는 이유는 다음과 같음.
    1.  **물리적 한계**: 노드 수가 늘어날수록 연결 지점에서의 신호 반사 및 감쇠가 심해져 통신 품질이 저하됨.
    2.  **성능 한계**: 노드 수가 많아지면 한 사이클을 도는 데 걸리는 시간이 길어져 최대 지연 시간(Latency)이 증가하고, 실시간성을 만족하기 어려워짐.

---

# 기술적 아이디어 및 특허 가능성 탐구

## PoDL 환경에서의 Keep-Alive를 위한 빈 프레임 전송

*   **아이디어**: PoDL(Power over Data Lines)로 전력을 공급받는 저전력 센서의 안정적인 전력 공급 및 연결 상태 확인을 위해, 버스가 오랫동안 유휴(Idle) 상태일 때 주기적으로 '빈 프레임(Null Frame)'을 전송하는 기술.
*   **특허 가능성**:
    *   **신규성/진보성**: 단순히 '빈 프레임을 보낸다'는 것만으로는 부족할 수 있으나, **"PoDL 환경에서", "저전력 장치의 안정성을 위해", "특정 조건 하에서(예: 유휴 시간 임계값 초과 시)", "미리 정의된 형식의 프레임을 전송"** 하는 구체적인 방법 및 시스템으로 구성하면 기존 기술과 차별화되어 특허 요건을 만족할 가능성이 있음. 기존 기술의 단점(대역폭 낭비)을 특정 목적(전력 유지)을 위해 역발상으로 활용했다는 점에서 진보성을 주장할 수 있음.
*   **기술적 고려사항**:
    *   **장점**: 전력 공급 안정화, 연결 상태 확인(Keep-alive).
    *   **단점**: 에너지 효율 저하, 대역폭 낭비, PLCA와 같은 스케줄링 프로토콜과의 충돌 문제.
    *   **구체화**: 누가(마스터/슬레이브), 언제(주기/이벤트 기반), 어떤 프레임을 보낼지에 대한 정교한 제어 로직 설계가 필요함.
