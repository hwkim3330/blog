(base) kim@kim-System-Product-Name:~/velocitydrivesp-support1/support/docker$ cd ..
(base) kim@kim-System-Product-Name:~/velocitydrivesp-support1/support$ cd ..
(base) kim@kim-System-Product-Name:~/velocitydrivesp-support1$ cd ..
(base) kim@kim-System-Product-Name:~$ git clone https://github.com/microchip-ung/velocitydrivesp-support && cd velocitydrivesp-support
Cloning into 'velocitydrivesp-support'...
remote: Enumerating objects: 1342, done.
remote: Counting objects: 100% (1342/1342), done.
remote: Compressing objects: 100% (1067/1067), done.
remote: Total 1342 (delta 173), reused 1338 (delta 170), pack-reused 0 (from 0)
Receiving objects: 100% (1342/1342), 4.86 MiB | 17.23 MiB/s, done.
Resolving deltas: 100% (173/173), done.
(base) kim@kim-System-Product-Name:~/velocitydrivesp-support$ cd velocitydrivesp-support
bash: cd: velocitydrivesp-support: No such file or directory
(base) kim@kim-System-Product-Name:~/velocitydrivesp-support$ sudo chmod a+rw /dev/ttyACM0 && ls -la /dev/ttyACM0
[sudo] password for kim: 
crw-rw-rw- 1 root dialout 166, 0 Jul 28 12:57 /dev/ttyACM0
(base) kim@kim-System-Product-Name:~/velocitydrivesp-support$ sudo curl -o /usr/local/bin/dr https://raw.githubusercontent.com/microchip-ung/docker-run/refs/heads/main/dr && sudo chmod +x /usr/local/bin/dr
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
100  6297  100  6297    0     0  18657      0 --:--:-- --:--:-- --:--:-- 18685
(base) kim@kim-System-Product-Name:~/velocitydrivesp-support$ docker images
REPOSITORY                                      TAG              IMAGE ID       CREATED          SIZE
<none>                                          <none>           471961a1fbf2   4 minutes ago    607MB
<none>                                          <none>           20ecff132a12   11 minutes ago   607MB
velocitydrivesp-gui                             latest           201e0734ddfe   15 minutes ago   607MB
<none>                                          <none>           c596fafa93d2   45 minutes ago   607MB
<none>                                          <none>           30cd7c37a8cd   2 hours ago      1.99GB
mchp-tools/velocitydrivesp-support              latest           593a0ac16a12   3 hours ago      2GB
ubuntu                                          22.04            1d3ca894b30c   13 days ago      77.9MB
ghcr.io/microchip-ung/velocitydrivesp-support   1                05d6c24ecf21   8 months ago     1.99GB
ubuntu                                          jammy-20240405   7af9ba4f0a47   15 months ago    77.9MB
(base) kim@kim-System-Product-Name:~/velocitydrivesp-support$ # On Fedora 41
$ sudo dnf install docker-cli docker-ce containerd
# On Fedora 40
$ sudo dnf install moby-engine containerd
$: command not found
$: command not found
(base) kim@kim-System-Product-Name:~/velocitydrivesp-support$ cat <<EOF > ipatch-set-ptp-instance.yaml
- ? "/ieee1588-ptp:ptp/instances/instance"
  : instance-index: 0
    default-ds:
      external-port-config-enable: true
    mchp-velocitysp-ptp:automotive:
      profile: bridge
    ports:
      port:
      - port-index: 12       # Master
        external-port-config-port-ds:
          desired-state: master
EOF

sudo dr mup1cc -d /dev/ttyACM0 -m ipatch -i ipatch-set-ptp-instance.yaml
Opening serial port at /dev/ttyACM0
(base) kim@kim-System-Product-Name:~/velocitydrivesp-support$ cat <<EOF > ipatch-set-servo0.yaml
- ? "/ieee1588-ptp:ptp/instances/instance[instance-index='0']/mchp-velocitysp-ptp:servos/servo"
  : servo-index: 0
    servo-type: pi
    ltc-index: 0
EOF

sudo dr mup1cc -d /dev/ttyACM0 -m ipatch -i ipatch-set-servo0.yaml
Opening serial port at /dev/ttyACM0
(base) kim@kim-System-Product-Name:~/velocitydrivesp-support$ cat <<EOF > fetch-ptp-instance.yaml
- "/ieee1588-ptp:ptp/instances/instance[instance-index='0']"
EOF
sudo dr mup1cc -d /dev/ttyACM0 -m fetch -i fetch-ptp-instance.yaml
Opening serial port at /dev/ttyACM0
---
- "/ieee1588-ptp:ptp/instances/instance":
    instance-index: 0
    default-ds:
      clock-identity: 02-06-3F-FF-FE-F5-0E-00
      priority1: 246
      priority2: 248
      domain-number: 0
      instance-enable: true
      external-port-config-enable: true
      max-steps-removed: 255
      instance-type: relay
    parent-ds:
      parent-port-identity:
        clock-identity: 00-00-00-00-00-00-00-00
        port-number: 0
      grandmaster-identity: 02-06-3F-FF-FE-F5-0E-00
      grandmaster-clock-quality:
        clock-class: ieee1588-ptp:cc-default
        clock-accuracy: mchp-velocitysp-ptp:ca-time-accurate-unknown
      grandmaster-priority1: 246
      grandmaster-priority2: 248
      ieee802-dot1as-ptp:cumulative-rate-ratio: 0
    ports:
      port:
      - port-index: 12
        port-ds:
          port-state: master
          mean-link-delay: '0'
          log-sync-interval: -3
          log-min-pdelay-req-interval: 0
          port-enable: true
          ieee802-dot1as-ptp:as-capable: true
          ieee802-dot1as-ptp:mean-link-delay-thresh: '52428800'
          ieee802-dot1as-ptp:neighbor-rate-ratio: 0
          ieee802-dot1as-ptp:sync-receipt-timeout: 3
          ieee802-dot1as-ptp:use-mgt-log-gptp-cap-interval: false
          ieee802-dot1as-ptp:mgt-log-gptp-cap-interval: 0
          ieee802-dot1as-ptp:use-mgt-one-step-tx-oper: false
          ieee802-dot1as-ptp:mgt-one-step-tx-oper: 0
        timestamp-correction-port-ds:
          egress-latency: '0'
          ingress-latency: '0'
        external-port-config-port-ds:
          desired-state: master
    mchp-velocitysp-ptp:servos:
      servo:
      - servo-index: 0
        servo-type: pi
        ltc-index: 0
        offset: '0'
        state: 0
    mchp-velocitysp-ptp:automotive:
      profile: bridge
      oper-log-pdelay-req-interval: 1
      oper-log-sync-interval: 0
    mchp-velocitysp-ptp:l2:
      mac-address: 00-00-00-00-00-00
      mac-address-enable: false
      vlan: 1
      vlan-enable: false
(base) kim@kim-System-Product-Name:~/velocitydrivesp-support$ cat <<EOF > fetch-ptp-instance.yaml
- "/ieee1588-ptp:ptp/instances/instance[instance-index='0']"
EOF
sudo dr mup1cc -d /dev/ttyACM0 -m fetch -i fetch-ptp-instance.yaml
Opening serial port at /dev/ttyACM0
---
- "/ieee1588-ptp:ptp/instances/instance":
    instance-index: 0
    default-ds:
      clock-identity: 02-06-3F-FF-FE-F5-0E-00
      priority1: 246
      priority2: 248
      domain-number: 0
      instance-enable: true
      external-port-config-enable: true
      max-steps-removed: 255
      instance-type: relay
    parent-ds:
      parent-port-identity:
        clock-identity: 00-00-00-00-00-00-00-00
        port-number: 0
      grandmaster-identity: 02-06-3F-FF-FE-F5-0E-00
      grandmaster-clock-quality:
        clock-class: ieee1588-ptp:cc-default
        clock-accuracy: mchp-velocitysp-ptp:ca-time-accurate-unknown
      grandmaster-priority1: 246
      grandmaster-priority2: 248
      ieee802-dot1as-ptp:cumulative-rate-ratio: 0
    ports:
      port:
      - port-index: 12
        port-ds:
          port-state: master
          mean-link-delay: '0'
          log-sync-interval: -3
          log-min-pdelay-req-interval: 0
          port-enable: true
          ieee802-dot1as-ptp:as-capable: true
          ieee802-dot1as-ptp:mean-link-delay-thresh: '52428800'
          ieee802-dot1as-ptp:neighbor-rate-ratio: 0
          ieee802-dot1as-ptp:sync-receipt-timeout: 3
          ieee802-dot1as-ptp:use-mgt-log-gptp-cap-interval: false
          ieee802-dot1as-ptp:mgt-log-gptp-cap-interval: 0
          ieee802-dot1as-ptp:use-mgt-one-step-tx-oper: false
          ieee802-dot1as-ptp:mgt-one-step-tx-oper: 0
        timestamp-correction-port-ds:
          egress-latency: '0'
          ingress-latency: '0'
        external-port-config-port-ds:
          desired-state: master
    mchp-velocitysp-ptp:servos:
      servo:
      - servo-index: 0
        servo-type: pi
        ltc-index: 0
        offset: '0'
        state: 0
    mchp-velocitysp-ptp:automotive:
      profile: bridge
      oper-log-pdelay-req-interval: 1
      oper-log-sync-interval: 0
    mchp-velocitysp-ptp:l2:
      mac-address: 00-00-00-00-00-00
      mac-address-enable: false
      vlan: 1
      vlan-enable: false
(base) kim@kim-System-Product-Name:~/velocitydrivesp-support$ echo '--- {}' > fetch-port-status.yaml
(base) kim@kim-System-Product-Name:~/velocitydrivesp-support$ dr mup1cc -d /dev/ttyACM0 -m fetch -i fetch-port-status.yaml
Opening serial port at /dev/ttyACM0
TRACE: "main: start scheduler\n"
TRACE: "\n"
TRACE: "\n"
/home/kim/velocitydrivesp-support/support/yang-enc/yang-enc.rb:516:in `json_seq2cbor': Input is not an Array! (RuntimeError)
	from /home/kim/velocitydrivesp-support/support/scripts/mup1cc:309:in `<main>'
(base) kim@kim-System-Product-Name:~/velocitydrivesp-support$ # 1) 삭제·초기화 + 생성·IP 설정
cat <<EOF > ipatch-reset-set-ip.yaml
# ——————————————————————————————————————
# 1) 기존 L3V1 인터페이스 삭제
- ? "/ietf-interfaces:interfaces/interface[name='L3V1']"
  :

# 2) L3V1 인터페이스 생성·활성화
- ? "/ietf-interfaces:interfaces/interface"
  : name:    "L3V1"
    type:    iana-if-type:l3ipvlan
    enabled: true

# 3) IPv4 설정 (포워딩 해제 + 주소 할당)
- ? "/ietf-interfaces:interfaces/interface[name='L3V1']/ietf-ip:ipv4"
  : forwarding: false
    address:
      - ip:            "169.254.59.100"
        prefix-length: 16
EOF

# 적용
dr mup1cc -d /dev/ttyACM0 -m ipatch -i ipatch-reset-set-ip.yaml
Opening serial port at /dev/ttyACM0
TRACE: "main: start scheduler\n"
TRACE: "\n"
TRACE: "\n"
TRACE: "00:00:18-715940 "
TRACE: "cc/error 1647 : "
TRACE: "SID 2036 (parent SID 2033) has state = VALID and has not been handled by the module!"
TRACE: "\n"
ERROR: response code 5.00
(base) kim@kim-System-Product-Name:~/velocitydrivesp-support$ ping 169.254.59.100
PING 169.254.59.100 (169.254.59.100) 56(84) bytes of data.
64 bytes from 169.254.59.100: icmp_seq=1 ttl=31 time=3.65 ms
64 bytes from 169.254.59.100: icmp_seq=2 ttl=31 time=2.26 ms
64 bytes from 169.254.59.100: icmp_seq=3 ttl=31 time=0.911 ms
64 bytes from 169.254.59.100: icmp_seq=4 ttl=31 time=1.02 ms
64 bytes from 169.254.59.100: icmp_seq=5 ttl=31 time=0.898 ms
64 bytes from 169.254.59.100: icmp_seq=6 ttl=31 time=0.506 ms
64 bytes from 169.254.59.100: icmp_seq=7 ttl=31 time=2.51 ms
64 bytes from 169.254.59.100: icmp_seq=8 ttl=31 time=2.44 ms
64 bytes from 169.254.59.100: icmp_seq=9 ttl=31 time=0.648 ms
64 bytes from 169.254.59.100: icmp_seq=10 ttl=31 time=2.16 ms
^C
--- 169.254.59.100 ping statistics ---
10 packets transmitted, 10 received, 0% packet loss, time 9140ms
rtt min/avg/max/mdev = 0.506/1.700/3.651/0.989 ms
(base) kim@kim-System-Product-Name:~/velocitydrivesp-support$ # management 포트가 enp7s0에 물려 있다면:
sudo tcpdump -i enp7s0 -w mgmt-port.pcap -n
[sudo] password for kim: 
tcpdump: listening on enp7s0, link-type EN10MB (Ethernet), snapshot length 262144 bytes
^[[A
^C96 packets captured
96 packets received by filter
0 packets dropped by kernel
(base) kim@kim-System-Product-Name:~/velocitydrivesp-support$ ^C
(base) kim@kim-System-Product-Name:~/velocitydrivesp-support$ # 10µs cycle (5µs open / 5µs close), TXTIME‑assist 모드
BT=$(( $(date +%s%N) + 3_000_000_000 ))
sudo ip netns exec ns1 tc qdisc replace dev enp7s0 root handle 100: taprio \
  clockid CLOCK_TAI num_tc 1 \
  map 0 0 0 0 0 0 0 0 queues 1@1 \
  base-time $BT \
  sched-entry S 1 5000 sched-entry S 0 5000 \
  flags 0x1

echo "✔ TAS 적용: 10µs cycle (sender enp7s0)"
bash: 1753750921443569079 + 3_000_000_000: value too great for base (error token is "3_000_000_000")
[sudo] password for kim: 
Error: There should be at least one entry in the schedule.
✔ TAS 적용: 10µs cycle (sender enp7s0)
(base) kim@kim-System-Product-Name:~/velocitydrivesp-support$ # TAS 모드에서 throughput 측정용 서버
sudo ip netns exec ns2 iperf3 -s -p 5201
-----------------------------------------------------------
Server listening on 5201 (test #1)
-----------------------------------------------------------
Accepted connection from 169.254.59.170, port 59672
[  5] local 169.254.59.100 port 5201 connected to 169.254.59.170 port 60289
[ ID] Interval           Transfer     Bitrate         Jitter    Lost/Total Datagrams
[  5]   0.00-1.00   sec   114 MBytes   955 Mbits/sec  0.013 ms  0/82484 (0%)  
[  5]   1.00-2.00   sec   114 MBytes   956 Mbits/sec  0.011 ms  0/82560 (0%)  
[  5]   2.00-3.00   sec   114 MBytes   955 Mbits/sec  0.013 ms  129/82560 (0.16%)  
[  5]   3.00-4.00   sec   114 MBytes   956 Mbits/sec  0.016 ms  0/82561 (0%)  
[  5]   3.00-4.00   sec   114 MBytes   956 Mbits/sec  0.016 ms  0/82561 (0%)  
- - - - - - - - - - - - - - - - - - - - - - - - -
[ ID] Interval           Transfer     Bitrate         Jitter    Lost/Total Datagrams
[  5]   0.00-4.00   sec   552 MBytes  1.16 Gbits/sec  0.010 ms  129/400071 (0.032%)  receiver
iperf3: the client has terminated
-----------------------------------------------------------
Server listening on 5201 (test #2)
-----------------------------------------------------------
Accepted connection from 169.254.59.170, port 45582
[  5] local 169.254.59.100 port 5201 connected to 169.254.59.170 port 54110
[ ID] Interval           Transfer     Bitrate         Jitter    Lost/Total Datagrams
[  5]   0.00-1.00   sec   114 MBytes   956 Mbits/sec  0.009 ms  0/82507 (0%)  
[  5]   1.00-2.00   sec   113 MBytes   948 Mbits/sec  0.029 ms  0/81796 (0%)  
[  5]   2.00-3.00   sec   113 MBytes   947 Mbits/sec  0.010 ms  0/81714 (0%)  
[  5]   3.00-4.00   sec   113 MBytes   947 Mbits/sec  0.014 ms  0/81710 (0%)  
[  5]   4.00-5.00   sec   113 MBytes   947 Mbits/sec  0.023 ms  0/81706 (0%)  
[  5]   5.00-6.00   sec   113 MBytes   947 Mbits/sec  0.038 ms  0/81717 (0%)  
[  5]   6.00-7.00   sec   113 MBytes   947 Mbits/sec  0.011 ms  0/81720 (0%)  
[  5]   7.00-8.00   sec   113 MBytes   950 Mbits/sec  0.029 ms  0/82005 (0%)  
[  5]   8.00-9.00   sec   114 MBytes   956 Mbits/sec  0.008 ms  0/82560 (0%)  
[  5]   9.00-10.00  sec   114 MBytes   956 Mbits/sec  0.029 ms  0/82560 (0%)  
[  5]  10.00-11.00  sec   114 MBytes   956 Mbits/sec  0.016 ms  0/82561 (0%)  
[  5]  11.00-12.00  sec   114 MBytes   953 Mbits/sec  0.009 ms  0/82306 (0%)  
[  5]  12.00-13.00  sec   113 MBytes   946 Mbits/sec  0.041 ms  0/81703 (0%)  
[  5]  13.00-14.00  sec   113 MBytes   946 Mbits/sec  0.009 ms  0/81699 (0%)  
[  5]  14.00-15.00  sec   113 MBytes   947 Mbits/sec  0.030 ms  0/81707 (0%)  
[  5]  15.00-16.00  sec   113 MBytes   946 Mbits/sec  0.028 ms  0/81699 (0%)  
[  5]  16.00-17.00  sec   113 MBytes   947 Mbits/sec  0.011 ms  0/81710 (0%)  
[  5]  17.00-18.00  sec   113 MBytes   947 Mbits/sec  0.016 ms  0/81705 (0%)  
[  5]  18.00-19.00  sec   114 MBytes   955 Mbits/sec  0.022 ms  0/82405 (0%)  
[  5]  19.00-20.00  sec   114 MBytes   956 Mbits/sec  0.011 ms  0/82560 (0%)  
[  5]  20.00-21.00  sec   114 MBytes   956 Mbits/sec  0.010 ms  0/82560 (0%)  
[  5]  21.00-22.00  sec   114 MBytes   956 Mbits/sec  0.029 ms  0/82510 (0%)  
[  5]  22.00-23.00  sec   113 MBytes   947 Mbits/sec  0.019 ms  0/81708 (0%)  
[  5]  23.00-24.00  sec   113 MBytes   947 Mbits/sec  0.019 ms  0/81724 (0%)  
[  5]  24.00-25.00  sec   113 MBytes   946 Mbits/sec  0.014 ms  0/81698 (0%)  
[  5]  25.00-26.00  sec   113 MBytes   947 Mbits/sec  0.014 ms  0/81717 (0%)  
[  5]  26.00-27.00  sec   113 MBytes   946 Mbits/sec  0.032 ms  0/81697 (0%)  
[  5]  27.00-28.00  sec   113 MBytes   947 Mbits/sec  0.029 ms  0/81715 (0%)  
[  5]  28.00-29.00  sec   113 MBytes   952 Mbits/sec  0.008 ms  0/82167 (0%)  
[  5]  29.00-30.00  sec   114 MBytes   956 Mbits/sec  0.010 ms  0/82560 (0%)  
[  5]  30.00-31.00  sec   114 MBytes   956 Mbits/sec  0.015 ms  0/82560 (0%)  
[  5]  31.00-32.00  sec   114 MBytes   956 Mbits/sec  0.010 ms  0/82560 (0%)  
[  5]  32.00-33.00  sec   114 MBytes   956 Mbits/sec  0.009 ms  0/82559 (0%)  
[  5]  33.00-34.00  sec   114 MBytes   956 Mbits/sec  0.009 ms  0/82561 (0%)  
[  5]  34.00-35.00  sec   114 MBytes   956 Mbits/sec  0.015 ms  0/82554 (0%)  
[  5]  35.00-36.00  sec   114 MBytes   956 Mbits/sec  0.015 ms  0/82559 (0%)  
[  5]  36.00-37.00  sec   114 MBytes   956 Mbits/sec  0.020 ms  0/82558 (0%)  
[  5]  37.00-38.00  sec   114 MBytes   956 Mbits/sec  0.015 ms  0/82558 (0%)  
[  5]  38.00-39.00  sec   114 MBytes   956 Mbits/sec  0.018 ms  0/82558 (0%)  
[  5]  39.00-40.00  sec   114 MBytes   956 Mbits/sec  0.020 ms  0/82557 (0%)  
[  5]  40.00-41.00  sec   114 MBytes   956 Mbits/sec  0.019 ms  0/82564 (0%)  
[  5]  41.00-42.00  sec   114 MBytes   956 Mbits/sec  0.033 ms  0/82558 (0%)  
[  5]  42.00-43.00  sec   114 MBytes   956 Mbits/sec  0.021 ms  0/82559 (0%)  
[  5]  43.00-44.00  sec   114 MBytes   956 Mbits/sec  0.020 ms  0/82560 (0%)  
[  5]  44.00-45.00  sec   114 MBytes   952 Mbits/sec  0.046 ms  0/82207 (0%)  
[  5]  45.00-46.00  sec   113 MBytes   946 Mbits/sec  0.025 ms  0/81706 (0%)  
[  5]  46.00-47.00  sec   113 MBytes   947 Mbits/sec  0.010 ms  0/81719 (0%)  
[  5]  47.00-48.00  sec   113 MBytes   947 Mbits/sec  0.047 ms  0/81714 (0%)  
[  5]  48.00-49.00  sec   113 MBytes   947 Mbits/sec  0.014 ms  0/81716 (0%)  
[  5]  49.00-50.00  sec   113 MBytes   946 Mbits/sec  0.057 ms  0/81690 (0%)  
[  5]  50.00-51.00  sec   113 MBytes   947 Mbits/sec  0.016 ms  0/81726 (0%)  
[  5]  51.00-52.00  sec   114 MBytes   955 Mbits/sec  0.018 ms  0/82454 (0%)  
[  5]  52.00-53.00  sec   114 MBytes   956 Mbits/sec  0.010 ms  0/82558 (0%)  
[  5]  53.00-54.00  sec   114 MBytes   956 Mbits/sec  0.012 ms  0/82567 (0%)  
[  5]  54.00-55.00  sec   114 MBytes   956 Mbits/sec  0.020 ms  0/82554 (0%)  
[  5]  55.00-56.00  sec   114 MBytes   956 Mbits/sec  0.023 ms  0/82560 (0%)  
[  5]  56.00-57.00  sec   114 MBytes   956 Mbits/sec  0.014 ms  0/82566 (0%)  
[  5]  57.00-58.00  sec   114 MBytes   956 Mbits/sec  0.013 ms  0/82553 (0%)  
[  5]  58.00-59.00  sec   114 MBytes   956 Mbits/sec  0.010 ms  0/82560 (0%)  
[  5]  59.00-60.00  sec   114 MBytes   956 Mbits/sec  0.011 ms  0/82560 (0%)  
[  5]  60.00-60.00  sec   133 KBytes  1.08 Gbits/sec  0.015 ms  0/94 (0%)  
- - - - - - - - - - - - - - - - - - - - - - - - -
[ ID] Interval           Transfer     Bitrate         Jitter    Lost/Total Datagrams
[  5]   0.00-60.00  sec  6.65 GBytes   952 Mbits/sec  0.015 ms  0/4931436 (0%)  receiver
-----------------------------------------------------------
Server listening on 5201 (test #3)
-----------------------------------------------------------
Accepted connection from 169.254.59.170, port 47190
[  5] local 169.254.59.100 port 5201 connected to 169.254.59.170 port 54897
[ ID] Interval           Transfer     Bitrate         Jitter    Lost/Total Datagrams
[  5]   0.00-1.00   sec   114 MBytes   956 Mbits/sec  0.031 ms  0/82534 (0%)  
[  5]   1.00-2.00   sec   114 MBytes   956 Mbits/sec  0.041 ms  0/82560 (0%)  
[  5]   2.00-3.00   sec   114 MBytes   956 Mbits/sec  0.009 ms  0/82560 (0%)  
[  5]   3.00-4.00   sec   114 MBytes   956 Mbits/sec  0.031 ms  0/82560 (0%)  
[  5]   4.00-5.00   sec   114 MBytes   956 Mbits/sec  0.012 ms  0/82514 (0%)  
[  5]   5.00-6.00   sec   113 MBytes   946 Mbits/sec  0.009 ms  0/81697 (0%)  
[  5]   6.00-7.00   sec   113 MBytes   947 Mbits/sec  0.017 ms  0/81720 (0%)  
[  5]   7.00-8.00   sec   113 MBytes   946 Mbits/sec  0.010 ms  0/81700 (0%)  
[  5]   8.00-9.00   sec   113 MBytes   946 Mbits/sec  0.019 ms  0/81703 (0%)  
[  5]   9.00-10.00  sec   113 MBytes   946 Mbits/sec  0.026 ms  0/81697 (0%)  
[  5]  10.00-11.00  sec   113 MBytes   947 Mbits/sec  0.009 ms  0/81709 (0%)  
[  5]  11.00-12.00  sec   113 MBytes   952 Mbits/sec  0.033 ms  0/82191 (0%)  
[  5]  12.00-13.00  sec   114 MBytes   956 Mbits/sec  0.020 ms  0/82561 (0%)  
[  5]  13.00-14.00  sec   114 MBytes   956 Mbits/sec  0.012 ms  0/82560 (0%)  
[  5]  14.00-15.00  sec   114 MBytes   956 Mbits/sec  0.014 ms  0/82560 (0%)  
[  5]  15.00-16.00  sec   114 MBytes   956 Mbits/sec  0.030 ms  0/82560 (0%)  
[  5]  16.00-17.00  sec   114 MBytes   956 Mbits/sec  0.029 ms  0/82560 (0%)  
[  5]  17.00-18.00  sec   114 MBytes   956 Mbits/sec  0.010 ms  0/82560 (0%)  
[  5]  18.00-19.00  sec   114 MBytes   956 Mbits/sec  0.011 ms  0/82560 (0%)  
[  5]  19.00-20.00  sec   114 MBytes   956 Mbits/sec  0.014 ms  0/82560 (0%)  
[  5]  20.00-21.00  sec   114 MBytes   956 Mbits/sec  0.023 ms  0/82560 (0%)  
[  5]  21.00-22.00  sec   114 MBytes   956 Mbits/sec  0.008 ms  0/82560 (0%)  
[  5]  22.00-23.00  sec   114 MBytes   956 Mbits/sec  0.025 ms  0/82560 (0%)  
[  5]  23.00-24.00  sec   114 MBytes   956 Mbits/sec  0.012 ms  0/82560 (0%)  
[  5]  24.00-25.00  sec   114 MBytes   956 Mbits/sec  0.022 ms  0/82560 (0%)  
[  5]  25.00-26.00  sec   114 MBytes   956 Mbits/sec  0.037 ms  0/82560 (0%)  
[  5]  26.00-27.00  sec   109 MBytes   911 Mbits/sec  0.017 ms  2630/81237 (3.2%)  
[  5]  27.00-28.00  sec   114 MBytes   956 Mbits/sec  0.011 ms  0/82568 (0%)  
[  5]  28.00-29.00  sec   114 MBytes   956 Mbits/sec  0.050 ms  0/82560 (0%)  
[  5]  29.00-30.00  sec   114 MBytes   956 Mbits/sec  0.009 ms  0/82560 (0%)  
[  5]  30.00-31.00  sec   114 MBytes   956 Mbits/sec  0.014 ms  0/82552 (0%)  
[  5]  31.00-32.00  sec   114 MBytes   956 Mbits/sec  0.013 ms  0/82564 (0%)  
[  5]  32.00-33.00  sec   114 MBytes   956 Mbits/sec  0.019 ms  0/82560 (0%)  
[  5]  33.00-34.00  sec   114 MBytes   956 Mbits/sec  0.010 ms  0/82562 (0%)  
[  5]  34.00-35.00  sec   114 MBytes   956 Mbits/sec  0.013 ms  0/82555 (0%)  
[  5]  35.00-36.00  sec   114 MBytes   956 Mbits/sec  0.022 ms  0/82557 (0%)  
[  5]  36.00-37.00  sec   114 MBytes   956 Mbits/sec  0.019 ms  0/82564 (0%)  
[  5]  37.00-38.00  sec   114 MBytes   956 Mbits/sec  0.016 ms  0/82556 (0%)  
[  5]  38.00-39.00  sec   114 MBytes   956 Mbits/sec  0.021 ms  0/82559 (0%)  
[  5]  39.00-40.00  sec   114 MBytes   956 Mbits/sec  0.018 ms  0/82559 (0%)  
[  5]  40.00-41.00  sec   114 MBytes   956 Mbits/sec  0.045 ms  0/82559 (0%)  
[  5]  41.00-42.00  sec   114 MBytes   956 Mbits/sec  0.017 ms  0/82560 (0%)  
[  5]  42.00-43.00  sec   114 MBytes   956 Mbits/sec  0.028 ms  0/82558 (0%)  
[  5]  43.00-44.00  sec   114 MBytes   956 Mbits/sec  0.010 ms  0/82560 (0%)  
[  5]  44.00-45.00  sec   114 MBytes   956 Mbits/sec  0.033 ms  0/82560 (0%)  
[  5]  45.00-46.00  sec   114 MBytes   956 Mbits/sec  0.010 ms  0/82560 (0%)  
[  5]  46.00-47.00  sec   114 MBytes   956 Mbits/sec  0.012 ms  0/82560 (0%)  
^C[  5]  47.00-47.59  sec  66.7 MBytes   956 Mbits/sec  0.009 ms  0/48326 (0%)  
- - - - - - - - - - - - - - - - - - - - - - - - -
[ ID] Interval           Transfer     Bitrate         Jitter    Lost/Total Datagrams
[  5]   0.00-47.59  sec  5.29 GBytes   954 Mbits/sec  0.009 ms  2630/3921742 (0.067%)  receiver
iperf3: interrupt - the server has terminated
(base) kim@kim-System-Product-Name:~/velocitydrivesp-support$ # UDP 포화 트래픽용 서버
sudo ip netns exec ns2 iperf3 -s -p 5201
[sudo] password for kim: 
-----------------------------------------------------------
Server listening on 5201 (test #1)
-----------------------------------------------------------
Accepted connection from 169.254.59.170, port 40202
[  5] local 169.254.59.100 port 5201 connected to 169.254.59.170 port 49724
[ ID] Interval           Transfer     Bitrate         Jitter    Lost/Total Datagrams
[  5]   0.00-1.00   sec   114 MBytes   956 Mbits/sec  0.010 ms  0/82538 (0%)  
[  5]   1.00-2.00   sec   114 MBytes   956 Mbits/sec  0.009 ms  0/82560 (0%)  
[  5]   2.00-3.00   sec   114 MBytes   956 Mbits/sec  0.016 ms  0/82560 (0%)  
[  5]   3.00-4.00   sec   113 MBytes   947 Mbits/sec  0.025 ms  0/81744 (0%)  
[  5]   4.00-5.00   sec   113 MBytes   947 Mbits/sec  0.015 ms  0/81711 (0%)  
[  5]   5.00-6.00   sec   113 MBytes   946 Mbits/sec  0.010 ms  0/81680 (0%)  
[  5]   6.00-7.00   sec   113 MBytes   947 Mbits/sec  0.012 ms  0/81718 (0%)  
[  5]   7.00-8.00   sec   113 MBytes   946 Mbits/sec  0.020 ms  0/81701 (0%)  
[  5]   8.00-9.00   sec   113 MBytes   947 Mbits/sec  0.011 ms  0/81705 (0%)  
[  5]   9.00-10.00  sec   113 MBytes   951 Mbits/sec  0.019 ms  0/82106 (0%)  
[  5]  10.00-11.00  sec   114 MBytes   956 Mbits/sec  0.021 ms  0/82560 (0%)  
[  5]  11.00-12.00  sec   114 MBytes   956 Mbits/sec  0.053 ms  0/82560 (0%)  
[  5]  12.00-13.00  sec   114 MBytes   956 Mbits/sec  0.009 ms  0/82560 (0%)  
[  5]  13.00-14.00  sec   114 MBytes   956 Mbits/sec  0.029 ms  0/82560 (0%)  
[  5]  14.00-15.00  sec   114 MBytes   956 Mbits/sec  0.027 ms  0/82560 (0%)  
[  5]  15.00-16.00  sec   112 MBytes   942 Mbits/sec  0.014 ms  1023/82475 (1.2%)  
[  5]  16.00-17.00  sec   111 MBytes   934 Mbits/sec  0.052 ms  1732/82226 (2.1%)  
[  5]  17.00-18.00  sec   114 MBytes   956 Mbits/sec  0.019 ms  0/82552 (0%)  
[  5]  18.00-19.00  sec   114 MBytes   956 Mbits/sec  0.009 ms  0/82557 (0%)  
[  5]  19.00-20.00  sec   114 MBytes   956 Mbits/sec  0.008 ms  0/82560 (0%)  
[  5]  20.00-21.00  sec   114 MBytes   956 Mbits/sec  0.010 ms  0/82560 (0%)  
[  5]  21.00-22.00  sec   114 MBytes   956 Mbits/sec  0.028 ms  0/82560 (0%)  
[  5]  22.00-23.00  sec   114 MBytes   956 Mbits/sec  0.008 ms  0/82561 (0%)  
[  5]  23.00-24.00  sec   114 MBytes   956 Mbits/sec  0.022 ms  0/82559 (0%)  
[  5]  24.00-25.00  sec   114 MBytes   956 Mbits/sec  0.042 ms  0/82560 (0%)  
[  5]  25.00-26.00  sec   114 MBytes   956 Mbits/sec  0.009 ms  0/82561 (0%)  
[  5]  26.00-27.00  sec   114 MBytes   956 Mbits/sec  0.022 ms  0/82561 (0%)  
[  5]  27.00-28.00  sec   114 MBytes   956 Mbits/sec  0.009 ms  0/82559 (0%)  
[  5]  28.00-29.00  sec   114 MBytes   956 Mbits/sec  0.030 ms  0/82560 (0%)  
[  5]  29.00-30.00  sec   114 MBytes   956 Mbits/sec  0.017 ms  0/82560 (0%)  
[  5]  30.00-31.00  sec   114 MBytes   956 Mbits/sec  0.023 ms  0/82560 (0%)  
[  5]  31.00-32.00  sec   114 MBytes   956 Mbits/sec  0.009 ms  0/82560 (0%)  
[  5]  32.00-33.00  sec   114 MBytes   956 Mbits/sec  0.023 ms  0/82560 (0%)  
[  5]  33.00-34.00  sec   114 MBytes   956 Mbits/sec  0.017 ms  0/82560 (0%)  
[  5]  34.00-35.00  sec   114 MBytes   956 Mbits/sec  0.019 ms  0/82560 (0%)  
[  5]  35.00-36.00  sec   114 MBytes   956 Mbits/sec  0.032 ms  0/82560 (0%)  
[  5]  36.00-37.00  sec   114 MBytes   956 Mbits/sec  0.023 ms  0/82560 (0%)  
[  5]  37.00-38.00  sec   114 MBytes   956 Mbits/sec  0.012 ms  0/82560 (0%)  
[  5]  38.00-39.00  sec   114 MBytes   956 Mbits/sec  0.008 ms  0/82560 (0%)  
[  5]  39.00-40.00  sec   114 MBytes   956 Mbits/sec  0.011 ms  0/82560 (0%)  
[  5]  40.00-41.00  sec   114 MBytes   956 Mbits/sec  0.015 ms  0/82560 (0%)  
[  5]  41.00-42.00  sec   114 MBytes   956 Mbits/sec  0.009 ms  0/82560 (0%)  
[  5]  42.00-43.00  sec   114 MBytes   956 Mbits/sec  0.012 ms  0/82560 (0%)  
[  5]  43.00-44.00  sec   114 MBytes   956 Mbits/sec  0.022 ms  0/82560 (0%)  
[  5]  44.00-45.00  sec   114 MBytes   956 Mbits/sec  0.017 ms  0/82559 (0%)  
[  5]  45.00-46.00  sec   114 MBytes   956 Mbits/sec  0.021 ms  0/82559 (0%)  
[  5]  46.00-47.00  sec   114 MBytes   956 Mbits/sec  0.027 ms  0/82549 (0%)  
[  5]  47.00-48.00  sec   114 MBytes   956 Mbits/sec  0.044 ms  0/82558 (0%)  
[  5]  48.00-49.00  sec   114 MBytes   956 Mbits/sec  0.054 ms  0/82560 (0%)  
[  5]  49.00-50.00  sec   114 MBytes   956 Mbits/sec  0.026 ms  0/82559 (0%)  
[  5]  50.00-51.00  sec   114 MBytes   956 Mbits/sec  0.013 ms  0/82560 (0%)  
[  5]  51.00-52.00  sec   114 MBytes   956 Mbits/sec  0.024 ms  0/82561 (0%)  
[  5]  52.00-53.00  sec   114 MBytes   956 Mbits/sec  0.032 ms  0/82559 (0%)  
[  5]  53.00-54.00  sec   114 MBytes   956 Mbits/sec  0.018 ms  0/82560 (0%)  
[  5]  54.00-55.00  sec   114 MBytes   956 Mbits/sec  0.040 ms  0/82560 (0%)  
[  5]  55.00-56.00  sec   114 MBytes   956 Mbits/sec  0.015 ms  0/82560 (0%)  
[  5]  56.00-57.00  sec   114 MBytes   956 Mbits/sec  0.020 ms  0/82561 (0%)  
[  5]  57.00-58.00  sec   114 MBytes   956 Mbits/sec  0.015 ms  0/82559 (0%)  
[  5]  58.00-59.00  sec   114 MBytes   956 Mbits/sec  0.019 ms  0/82561 (0%)  
[  5]  59.00-60.00  sec   114 MBytes   956 Mbits/sec  0.012 ms  0/82560 (0%)  
[  5]  60.00-60.00  sec   198 KBytes   938 Mbits/sec  0.034 ms  0/140 (0%)  
- - - - - - - - - - - - - - - - - - - - - - - - -
[ ID] Interval           Transfer     Bitrate         Jitter    Lost/Total Datagrams
[  5]   0.00-60.00  sec  6.67 GBytes   955 Mbits/sec  0.034 ms  2755/4947720 (0.056%)  receiver
-----------------------------------------------------------
Server listening on 5201 (test #2)
-----------------------------------------------------------
^Ciperf3: interrupt - the server has terminated
(base) kim@kim-System-Product-Name:~/velocitydrivesp-support$ bash setup_namespaces.sh
bash: setup_namespaces.sh: No such file or directory
(base) kim@kim-System-Product-Name:~/velocitydrivesp-support$ cat << 'EOF' > setup_namespaces.sh
#!/usr/bin/env bash
set -e

# 1) 기존 네임스페이스 삭제
sudo ip netns del ns1 2>/dev/null || true
sudo ip netns del ns2 2>/dev/null || true

# 2) 네임스페이스 생성
sudo ip netns add ns1
sudo ip netns add ns2

# 3) 물리 NIC down → 네임스페이스로 이동
sudo ip link set dev enp7s0 down
sudo ip link set dev enp9s0 down
sudo ip link set dev enp7s0 netns ns1
sudo ip link set dev enp9s0 netns ns2

# 4) 네임스페이스별 인터페이스 업 & IP 할당
sudo ip netns exec ns1 ip link set lo up
sudo ip netns exec ns1 ip link set dev enp7s0 up
sudo ip netns exec ns1 ip addr add 169.254.59.170/16 dev enp7s0

sudo ip netns exec ns2 ip link set lo up
sudo ip netns exec ns2 ip link set dev enp9s0 up
sudo ip netns exec ns2 ip addr add 169.254.59.100/16 dev enp9s0

echo "✔ 네임스페이스 및 NIC 설정 완료"
EOF

chmod +x setup_namespaces.sh
(base) kim@kim-System-Product-Name:~/velocitydrivesp-support$ bash setup_namespaces.sh
Cannot find device "enp9s0"
(base) kim@kim-System-Product-Name:~/velocitydrivesp-support$ # 1) root qdisc 를 prio 로 교체 (bands=8)
sudo ip netns exec ns1 tc qdisc replace dev enp7s0 root handle 1: prio bands 8 priomap 0 1 2 3 4 5 6 7

# 2) VLAN 태그 없이 skbedit 으로 PCP=6 설정 → band0 로 분류
sudo ip netns exec ns1 tc filter add dev enp7s0 protocol ip parent 1: prio 1 u32 \
  match ip dst 169.254.59.100/32 \
  action skbedit priority 0
Cannot find device "enp7s0"
Cannot find device "enp7s0"
(base) kim@kim-System-Product-Name:~/velocitydrivesp-support$ # 1) 기존 네임스페이스 삭제
sudo ip netns del ns1 2>/dev/null || true
sudo ip netns del ns2 2>/dev/null || true

# 2) 네임스페이스 생성
sudo ip netns add ns1
sudo ip netns add ns2

# 3) 물리 NIC down → 네임스페이스로 이동
sudo ip link set dev enp7s0 down
sudo ip link set dev enp9s0 down
sudo ip link set dev enp7s0 netns ns1
sudo ip link set dev enp9s0 netns ns2

# 4) 네임스페이스별 인터페이스 업 & IP 할당
sudo ip netns exec ns1 ip link set lo up
sudo ip netns exec ns1 ip link set dev enp7s0 up
sudo ip netns exec ns1 ip addr add 169.254.59.170/16 dev enp7s0

sudo ip netns exec ns2 ip link set lo up
sudo ip netns exec ns2 ip link set dev enp9s0 up
sudo ip netns exec ns2 ip addr add 169.254.59.100/16 dev enp9s0

echo "✔ 네임스페이스 및 NIC 설정 완료"
✔ 네임스페이스 및 NIC 설정 완료
(base) kim@kim-System-Product-Name:~/velocitydrivesp-support$ # 1) 기존 네임스페이스 삭제
sudo ip netns del ns1 2>/dev/null || true
sudo ip netns del ns2 2>/dev/null || true

# 2) 네임스페이스 생성
sudo ip netns add ns1
sudo ip netns add ns2

# 3) 물리 NIC down → 네임스페이스로 이동
sudo ip link set dev enp7s0 down
sudo ip link set dev enp9s0 down
sudo ip link set dev enp7s0 netns ns1
sudo ip link set dev enp9s0 netns ns2

# 4) 네임스페이스별 인터페이스 업 & IP 할당
sudo ip netns exec ns1 ip link set lo up
sudo ip netns exec ns1 ip link set dev enp7s0 up
sudo ip netns exec ns1 ip addr add 169.254.59.170/16 dev enp7s0

sudo ip netns exec ns2 ip link set lo up
sudo ip netns exec ns2 ip link set dev enp9s0 up
sudo ip netns exec ns2 ip addr add 169.254.59.100/16 dev enp9s0

echo "✔ 네임스페이스 및 NIC 설정 완료"
✔ 네임스페이스 및 NIC 설정 완료
(base) kim@kim-System-Product-Name:~/velocitydrivesp-support$ ip link show
1: lo: <LOOPBACK,UP,LOWER_UP> mtu 65536 qdisc noqueue state UNKNOWN mode DEFAULT group default qlen 1000
    link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00
2: enp4s0: <NO-CARRIER,BROADCAST,MULTICAST,UP> mtu 1500 qdisc fq_codel state DOWN mode DEFAULT group default qlen 1000
    link/ether 68:1c:a2:13:24:09 brd ff:ff:ff:ff:ff:ff
3: enp5s0: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc fq_codel state UP mode DEFAULT group default qlen 1000
    link/ether 68:1c:a2:13:24:0a brd ff:ff:ff:ff:ff:ff
4: enp12s0: <NO-CARRIER,BROADCAST,MULTICAST,UP> mtu 1500 qdisc fq_codel state DOWN mode DEFAULT group default qlen 1000
    link/ether 00:e0:4c:68:be:60 brd ff:ff:ff:ff:ff:ff
5: enp13s0: <NO-CARRIER,BROADCAST,MULTICAST,UP> mtu 1500 qdisc fq_codel state DOWN mode DEFAULT group default qlen 1000
    link/ether 00:e0:4c:68:be:61 brd ff:ff:ff:ff:ff:ff
6: enp14s0: <NO-CARRIER,BROADCAST,MULTICAST,UP> mtu 1500 qdisc fq_codel state DOWN mode DEFAULT group default qlen 1000
    link/ether 00:e0:4c:68:be:62 brd ff:ff:ff:ff:ff:ff
7: enp15s0: <NO-CARRIER,BROADCAST,MULTICAST,UP> mtu 1500 qdisc fq_codel state DOWN mode DEFAULT group default qlen 1000
    link/ether 00:e0:4c:68:be:63 brd ff:ff:ff:ff:ff:ff
10: wlp6s0: <NO-CARRIER,BROADCAST,MULTICAST,UP> mtu 1500 qdisc noqueue state DOWN mode DORMANT group default qlen 1000
    link/ether 00:26:66:4c:ca:44 brd ff:ff:ff:ff:ff:ff
11: docker0: <NO-CARRIER,BROADCAST,MULTICAST,UP> mtu 1500 qdisc noqueue state DOWN mode DEFAULT group default 
    link/ether 02:42:50:04:67:3f brd ff:ff:ff:ff:ff:ff
(base) kim@kim-System-Product-Name:~/velocitydrivesp-support$ 
(base) kim@kim-System-Product-Name:~/velocitydrivesp-support$ 
(base) kim@kim-System-Product-Name:~/velocitydrivesp-support$ # 1) root qdisc 를 prio 로 교체 (bands=8)
sudo ip netns exec ns1 tc qdisc replace dev enp7s0 root handle 1: prio bands 8 priomap 0 1 2 3 4 5 6 7

# 2) VLAN 태그 없이 skbedit 으로 PCP=6 설정 → band0 로 분류
sudo ip netns exec ns1 tc filter add dev enp7s0 protocol ip parent 1: prio 1 u32 \
  match ip dst 169.254.59.100/32 \
  action skbedit priority 0
(base) kim@kim-System-Product-Name:~/velocitydrivesp-support$ # 1) root qdisc 를 prio 로 교체 (bands=8)
sudo ip netns exec ns1 tc qdisc replace dev enp7s0 root handle 1: prio bands 8 priomap 0 1 2 3 4 5 6 7

# 2) VLAN 태그 없이 skbedit 으로 PCP=6 설정 → band0 로 분류
sudo ip netns exec ns1 tc filter add dev enp7s0 protocol ip parent 1: prio 1 u32 \
  match ip dst 169.254.59.100/32 \
  action skbedit priority 0
(base) kim@kim-System-Product-Name:~/velocitydrivesp-support$ sudo ip netns exec ns1 python3 sender.py 10 20000 169.254.59.100
^C
(base) kim@kim-System-Product-Name:~/velocitydrivesp-support$ ^C
(base) kim@kim-System-Product-Name:~/velocitydrivesp-support$ 
(base) kim@kim-System-Product-Name:~/velocitydrivesp-support$ 
(base) kim@kim-System-Product-Name:~/velocitydrivesp-support$ # veth0↔veth1 네임스페이스 초기화
sudo ip netns del ns1 2>/dev/null || true
sudo ip netns del ns2 2>/dev/null || true
sudo ip netns add ns1
sudo ip netns add ns2

# veth 페어 생성 & 이동
sudo ip link add veth0 type veth peer name veth1
sudo ip link set veth0 netns ns1
sudo ip link set veth1 netns ns2

# ns1 세팅
sudo ip netns exec ns1 ip link set lo up
sudo ip netns exec ns1 ip link set dev veth0 up
sudo ip netns exec ns1 ip addr add 10.0.0.1/24 dev veth0

# ns2 세팅
sudo ip netns exec ns2 ip link set lo up
sudo ip netns exec ns2 ip link set dev veth1 up
sudo ip netns exec ns2 ip addr add 10.0.0.2/24 dev veth1

echo "✔ veth 준비 완료: 10.0.0.1 ↔ 10.0.0.2"
✔ veth 준비 완료: 10.0.0.1 ↔ 10.0.0.2
(base) kim@kim-System-Product-Name:~/velocitydrivesp-support$ # 1) root qdisc → prio(bands=8)
sudo ip netns exec ns1 tc qdisc replace dev veth0 root handle 1: prio bands 8 priomap 0 1 2 3 4 5 6 7

# 2) u32 필터로 10.0.0.2 향하는 패킷을 band0(최상)으로  
sudo ip netns exec ns1 tc filter add dev veth0 protocol ip parent 1: prio 1 u32 \
    match ip dst 10.0.0.2/32 \
    action skbedit priority 0

echo "✔ Prio‑qdisc(802.1p 모의) 설정 완료"
✔ Prio‑qdisc(802.1p 모의) 설정 완료
(base) kim@kim-System-Product-Name:~/velocitydrivesp-support$ sudo ip netns exec ns2 iperf3 -s -p 5201
-----------------------------------------------------------
Server listening on 5201 (test #1)
-----------------------------------------------------------
Accepted connection from 10.0.0.1, port 56532
[  5] local 10.0.0.2 port 5201 connected to 10.0.0.1 port 41984
[ ID] Interval           Transfer     Bitrate         Jitter    Lost/Total Datagrams
[  5]   0.00-1.00   sec   701 MBytes  5.88 Gbits/sec  0.001 ms  0/507636 (0%)  
[  5]   1.00-2.00   sec   755 MBytes  6.34 Gbits/sec  0.001 ms  0/547066 (0%)  
[  5]   2.00-3.00   sec   758 MBytes  6.36 Gbits/sec  0.001 ms  0/549251 (0%)  
[  5]   3.00-4.00   sec   740 MBytes  6.21 Gbits/sec  0.001 ms  0/535736 (0%)  
[  5]   4.00-5.00   sec   773 MBytes  6.48 Gbits/sec  0.001 ms  1357/560971 (0.24%)  
[  5]   5.00-6.00   sec   765 MBytes  6.41 Gbits/sec  0.001 ms  1727/555431 (0.31%)  
[  5]   6.00-7.00   sec   784 MBytes  6.58 Gbits/sec  0.000 ms  1744/569644 (0.31%)  
[  5]   7.00-8.00   sec   774 MBytes  6.49 Gbits/sec  0.001 ms  0/560337 (0%)  
[  5]   8.00-9.00   sec   783 MBytes  6.57 Gbits/sec  0.001 ms  567/567903 (0.1%)  
[  5]   9.00-10.00  sec   772 MBytes  6.48 Gbits/sec  0.001 ms  805/560145 (0.14%)  
[  5]  10.00-11.00  sec   769 MBytes  6.45 Gbits/sec  0.001 ms  16/556642 (0.0029%)  
[  5]  11.00-12.00  sec   766 MBytes  6.42 Gbits/sec  0.001 ms  0/554354 (0%)  
[  5]  12.00-13.00  sec   765 MBytes  6.42 Gbits/sec  0.001 ms  0/553890 (0%)  
[  5]  13.00-14.00  sec   769 MBytes  6.45 Gbits/sec  0.001 ms  0/556771 (0%)  
[  5]  14.00-15.00  sec   766 MBytes  6.42 Gbits/sec  0.001 ms  0/554614 (0%)  
[  5]  15.00-16.00  sec   752 MBytes  6.31 Gbits/sec  0.001 ms  0/544710 (0%)  
[  5]  16.00-17.00  sec   759 MBytes  6.37 Gbits/sec  0.001 ms  0/549498 (0%)  
[  5]  17.00-18.00  sec   758 MBytes  6.36 Gbits/sec  0.001 ms  0/549248 (0%)  
[  5]  18.00-19.00  sec   758 MBytes  6.36 Gbits/sec  0.001 ms  0/549094 (0%)  
[  5]  18.00-19.00  sec   758 MBytes  6.36 Gbits/sec  0.001 ms  0/549094 (0%)  
- - - - - - - - - - - - - - - - - - - - - - - - -
[ ID] Interval           Transfer     Bitrate         Jitter    Lost/Total Datagrams
[SUM]  0.0-19.0 sec  5428 datagrams received out-of-order
[  5]   0.00-19.00  sec  14.2 GBytes  6.44 Gbits/sec  0.001 ms  6216/10572980 (0.059%)  receiver
iperf3: the client has terminated
-----------------------------------------------------------
Server listening on 5201 (test #2)
-----------------------------------------------------------
Accepted connection from 10.0.0.1, port 45216
[  5] local 10.0.0.2 port 5201 connected to 10.0.0.1 port 37414
[ ID] Interval           Transfer     Bitrate         Jitter    Lost/Total Datagrams
[  5]   0.00-1.00   sec   754 MBytes  6.33 Gbits/sec  0.001 ms  0/546107 (0%)  
[  5]   1.00-2.00   sec   754 MBytes  6.32 Gbits/sec  0.001 ms  0/545736 (0%)  
[  5]   2.00-3.00   sec   758 MBytes  6.36 Gbits/sec  0.001 ms  0/549070 (0%)  
[  5]   3.00-4.00   sec   755 MBytes  6.33 Gbits/sec  0.001 ms  45/546436 (0.0082%)  
[  5]   4.00-5.00   sec   763 MBytes  6.40 Gbits/sec  0.001 ms  695/553577 (0.13%)  
[  5]   5.00-6.00   sec   764 MBytes  6.41 Gbits/sec  0.001 ms  1122/554722 (0.2%)  
[  5]   6.00-7.00   sec   767 MBytes  6.43 Gbits/sec  0.001 ms  757/556229 (0.14%)  
[  5]   7.00-8.00   sec   774 MBytes  6.49 Gbits/sec  0.001 ms  0/560658 (0%)  
[  5]   8.00-9.00   sec   763 MBytes  6.40 Gbits/sec  0.001 ms  0/552890 (0%)  
[  5]   9.00-10.00  sec   755 MBytes  6.34 Gbits/sec  0.001 ms  266/547300 (0.049%)  
[  5]  10.00-11.00  sec   766 MBytes  6.42 Gbits/sec  0.001 ms  0/554570 (0%)  
[  5]  11.00-12.00  sec   766 MBytes  6.42 Gbits/sec  0.001 ms  71/554506 (0.013%)  
[  5]  12.00-13.00  sec   753 MBytes  6.32 Gbits/sec  0.001 ms  0/545553 (0%)  
[  5]  13.00-14.00  sec   765 MBytes  6.41 Gbits/sec  0.001 ms  0/553672 (0%)  
[  5]  14.00-15.00  sec   757 MBytes  6.35 Gbits/sec  0.001 ms  0/548424 (0%)  
[  5]  15.00-16.00  sec   753 MBytes  6.32 Gbits/sec  0.001 ms  79/545434 (0.014%)  
[  5]  16.00-17.00  sec   756 MBytes  6.34 Gbits/sec  0.001 ms  0/547492 (0%)  
[  5]  17.00-18.00  sec   760 MBytes  6.38 Gbits/sec  0.001 ms  0/550436 (0%)  
[  5]  18.00-19.00  sec   746 MBytes  6.26 Gbits/sec  0.001 ms  1314/541616 (0.24%)  
^C[  5]  19.00-19.99  sec   745 MBytes  6.30 Gbits/sec  0.002 ms  1342/540995 (0.25%)  
- - - - - - - - - - - - - - - - - - - - - - - - -
[ ID] Interval           Transfer     Bitrate         Jitter    Lost/Total Datagrams
[SUM]  0.0-20.0 sec  26787 datagrams received out-of-order
[  5]   0.00-19.99  sec  14.8 GBytes  6.37 Gbits/sec  0.002 ms  5691/10995424 (0.052%)  receiver
iperf3: interrupt - the server has terminated
(base) kim@kim-System-Product-Name:~/velocitydrivesp-support$ 
(base) kim@kim-System-Product-Name:~/velocitydrivesp-support$ ping 169.254.59.100
PING 169.254.59.100 (169.254.59.100) 56(84) bytes of data.
64 bytes from 169.254.59.100: icmp_seq=1 ttl=31 time=1.26 ms
64 bytes from 169.254.59.100: icmp_seq=2 ttl=31 time=1.09 ms
64 bytes from 169.254.59.100: icmp_seq=3 ttl=31 time=1.90 ms
64 bytes from 169.254.59.100: icmp_seq=4 ttl=31 time=1.52 ms
64 bytes from 169.254.59.100: icmp_seq=5 ttl=31 time=2.08 ms
64 bytes from 169.254.59.100: icmp_seq=6 ttl=31 time=1.14 ms
64 bytes from 169.254.59.100: icmp_seq=7 ttl=31 time=1.41 ms
64 bytes from 169.254.59.100: icmp_seq=8 ttl=31 time=2.24 ms
64 bytes from 169.254.59.100: icmp_seq=9 ttl=31 time=1.41 ms
64 bytes from 169.254.59.100: icmp_seq=10 ttl=31 time=0.635 ms
64 bytes from 169.254.59.100: icmp_seq=11 ttl=31 time=1.85 ms
64 bytes from 169.254.59.100: icmp_seq=12 ttl=31 time=1.46 ms
64 bytes from 169.254.59.100: icmp_seq=13 ttl=31 time=2.78 ms
64 bytes from 169.254.59.100: icmp_seq=14 ttl=31 time=1.48 ms
64 bytes from 169.254.59.100: icmp_seq=15 ttl=31 time=1.57 ms
64 bytes from 169.254.59.100: icmp_seq=16 ttl=31 time=1.90 ms
64 bytes from 169.254.59.100: icmp_seq=17 ttl=31 time=2.25 ms
64 bytes from 169.254.59.100: icmp_seq=18 ttl=31 time=2.54 ms
64 bytes from 169.254.59.100: icmp_seq=19 ttl=31 time=0.772 ms
64 bytes from 169.254.59.100: icmp_seq=20 ttl=31 time=0.410 ms
64 bytes from 169.254.59.100: icmp_seq=21 ttl=31 time=0.483 ms
64 bytes from 169.254.59.100: icmp_seq=22 ttl=31 time=1.96 ms
64 bytes from 169.254.59.100: icmp_seq=23 ttl=31 time=0.461 ms
64 bytes from 169.254.59.100: icmp_seq=24 ttl=31 time=1.05 ms
64 bytes from 169.254.59.100: icmp_seq=25 ttl=31 time=1.75 ms
64 bytes from 169.254.59.100: icmp_seq=26 ttl=31 time=1.94 ms
64 bytes from 169.254.59.100: icmp_seq=27 ttl=31 time=0.827 ms
64 bytes from 169.254.59.100: icmp_seq=28 ttl=31 time=1.13 ms
64 bytes from 169.254.59.100: icmp_seq=29 ttl=31 time=1.62 ms
64 bytes from 169.254.59.100: icmp_seq=30 ttl=31 time=1.47 ms
64 bytes from 169.254.59.100: icmp_seq=31 ttl=31 time=1.01 ms
64 bytes from 169.254.59.100: icmp_seq=32 ttl=31 time=1.00 ms
64 bytes from 169.254.59.100: icmp_seq=33 ttl=31 time=2.29 ms
64 bytes from 169.254.59.100: icmp_seq=34 ttl=31 time=1.40 ms
64 bytes from 169.254.59.100: icmp_seq=35 ttl=31 time=0.858 ms
64 bytes from 169.254.59.100: icmp_seq=36 ttl=31 time=1.01 ms
64 bytes from 169.254.59.100: icmp_seq=37 ttl=31 time=0.774 ms
64 bytes from 169.254.59.100: icmp_seq=38 ttl=31 time=0.993 ms
64 bytes from 169.254.59.100: icmp_seq=39 ttl=31 time=1.52 ms
64 bytes from 169.254.59.100: icmp_seq=40 ttl=31 time=2.36 ms
64 bytes from 169.254.59.100: icmp_seq=41 ttl=31 time=2.17 ms
64 bytes from 169.254.59.100: icmp_seq=42 ttl=31 time=0.832 ms
64 bytes from 169.254.59.100: icmp_seq=43 ttl=31 time=0.894 ms
64 bytes from 169.254.59.100: icmp_seq=44 ttl=31 time=2.14 ms
64 bytes from 169.254.59.100: icmp_seq=45 ttl=31 time=1.53 ms
^C
--- 169.254.59.100 ping statistics ---
45 packets transmitted, 45 received, 0% packet loss, time 44405ms
rtt min/avg/max/mdev = 0.410/1.447/2.778/0.590 ms
(base) kim@kim-System-Product-Name:~/velocitydrivesp-support$ 
(base) kim@kim-System-Product-Name:~/velocitydrivesp-support$ 
(base) kim@kim-System-Product-Name:~/velocitydrivesp-support$ # TAS 상태에서 최대 대역폭 UDP 전송 (60초)
sudo ip netns exec ns1 iperf3 -c 169.254.59.100 -u -b 0 -t 60 -p 5201
[sudo] password for kim: 
Connecting to host 169.254.59.100, port 5201
[  5] local 169.254.59.170 port 60289 connected to 169.254.59.100 port 5201
[ ID] Interval           Transfer     Bitrate         Total Datagrams
[  5]   0.00-1.00   sec   114 MBytes   957 Mbits/sec  82669  
[  5]   1.00-2.00   sec   114 MBytes   956 Mbits/sec  82547  
[  5]   2.00-3.00   sec   114 MBytes   956 Mbits/sec  82563  
[  5]   3.00-4.00   sec   114 MBytes   956 Mbits/sec  82578  
^C[  5]   4.00-4.85   sec  96.4 MBytes   956 Mbits/sec  69783  
- - - - - - - - - - - - - - - - - - - - - - - - -
[ ID] Interval           Transfer     Bitrate         Jitter    Lost/Total Datagrams
[  5]   0.00-4.85   sec   553 MBytes   956 Mbits/sec  0.000 ms  0/400140 (0%)  sender
[  5]   0.00-4.85   sec  0.00 Bytes  0.00 bits/sec  0.000 ms  0/0 (0%)  receiver
iperf3: interrupt - the client has terminated
(base) kim@kim-System-Product-Name:~/velocitydrivesp-support$ # 고정 10µs TAS만 적용 (토글은 필요없음 for throughput)
BT=$(( $(date +%s%N) + 3_000_000_000 ))
sudo ip netns exec ns1 tc qdisc replace dev enp7s0 root handle 100: taprio \
  clockid CLOCK_TAI num_tc 1 map 0 0 0 0 0 0 0 0 queues 1@1 \
  base-time $BT sched-entry S 1 5000 sched-entry S 0 5000 flags 0x1
echo "✔ TAS 10µs cycle 적용 완료"
bash: 1753750987045214152 + 3_000_000_000: value too great for base (error token is "3_000_000_000")
Error: There should be at least one entry in the schedule.
✔ TAS 10µs cycle 적용 완료
(base) kim@kim-System-Product-Name:~/velocitydrivesp-support$ sudo ip netns exec ns2 python3 receiver.py latencies_load_tas.csv
python3: can't open file '/home/kim/velocitydrivesp-support/receiver.py': [Errno 2] No such file or directory
(base) kim@kim-System-Product-Name:~/velocitydrivesp-support$ cd ..
(base) kim@kim-System-Product-Name:~$ cd ..
(base) kim@kim-System-Product-Name:/home$ ls
gemini-agent  kim
(base) kim@kim-System-Product-Name:/home$ cd kim/
(base) kim@kim-System-Product-Name:~$ # TAS 상태에서 동시에 10µs 간격으로 100 000개 전송
sudo ip netns exec ns1 python3 sender.py 10 100000 169.254.59.100
# → 완료 후 자동 종료
(base) kim@kim-System-Product-Name:~$ python3 plot_latency_compare.py latencies_load_tas.csv latencies_load_no.csv

## TAS vs No‑TAS under load

| Mode   |   Count |   Mean(ns) |   P50(ns) |   P95(ns) |   P99(ns) |   Max(ns) |
|--------|---------|------------|-----------|-----------|-----------|-----------|
| TAS    |  100000 |    25865.9 |     22721 |     51215 |     67712 |    226587 |
| No-TAS |  100000 |    19117.7 |     18147 |     24536 |     48756 |    170242 |

✔ Saved compare histogram: /home/kim/latency_load_compare.png
(base) kim@kim-System-Product-Name:~$ sudo ip netns exec ns2 python3 receiver.py latencies_load_tas.csv
^CTraceback (most recent call last):
  File "/home/kim/receiver.py", line 14, in <module>
    data,addr = sock.recvfrom(8)
                ^^^^^^^^^^^^^^^^
KeyboardInterrupt

(base) kim@kim-System-Product-Name:~$ python3 plot_latency_compare.py latencies_load_tas.csv latencies_load_no.csv

## TAS vs No‑TAS under load

| Mode   |   Count |   Mean(ns) |   P50(ns) |   P95(ns) |   P99(ns) |   Max(ns) |
|--------|---------|------------|-----------|-----------|-----------|-----------|
| TAS    |  100000 |   194215   |    195354 |    263367 |    271173 |    353343 |
| No-TAS |  100000 |    19117.7 |     18147 |     24536 |     48756 |    170242 |

✔ Saved compare histogram: /home/kim/latency_load_compare.png
(base) kim@kim-System-Product-Name:~$ python3 plot_latency_compare.py latencies_load_tas.csv latencies_load_no.csv

## TAS vs No‑TAS under load

| Mode   |   Count |   Mean(ns) |   P50(ns) |   P95(ns) |   P99(ns) |   Max(ns) |
|--------|---------|------------|-----------|-----------|-----------|-----------|
| TAS    |  100000 |     194215 |    195354 |    263367 |    271173 |    353343 |
| No-TAS |  100000 |     598310 |    597483 |    873277 |    939794 |   1060900 |

✔ Saved compare histogram: /home/kim/latency_load_compare.png
(base) kim@kim-System-Product-Name:~$ python3 - << 'EOF'
import pandas as pd
import matplotlib.pyplot as plt
import numpy as np

# CSV 불러오기
df_tas = pd.read_csv("latencies_load_tas.csv", header=0)
df_no  = pd.read_csv("latencies_load_no.csv", header=0)

# 공통 x축 구간 설정
max_latency = max(df_tas["latency_ns"].max(), df_no["latency_ns"].max())
bins = np.linspace(0, max_latency, 200)

# 히스토그램
plt.figure(figsize=(6,4))
plt.hist(df_tas["latency_ns"], bins=bins, histtype="step", label="TAS")
plt.hist(df_no ["latency_ns"], bins=bins, histtype="step", label="No‑TAS")
plt.title("Latency under Saturation: TAS vs No‑TAS")
plt.xlabel("Latency (ns)")
plt.ylabel("Count")
plt.legend()
plt.grid(True)
plt.tight_layout()
plt.show()
EOF
^CTraceback (most recent call last):
  File "<stdin>", line 23, in <module>
  File "/home/kim/miniconda3/lib/python3.13/site-packages/matplotlib/pyplot.py", line 614, in show
    return _get_backend_mod().show(*args, **kwargs)
           ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "/home/kim/miniconda3/lib/python3.13/site-packages/matplotlib/backend_bases.py", line 3548, in show
    cls.mainloop()
    ~~~~~~~~~~~~^^
  File "/home/kim/miniconda3/lib/python3.13/site-packages/matplotlib/backends/_backend_tk.py", line 544, in start_main_loop
    first_manager.window.mainloop()
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "/home/kim/miniconda3/lib/python3.13/tkinter/__init__.py", line 1599, in mainloop
    self.tk.mainloop(n)
    ~~~~~~~~~~~~~~~~^^^
KeyboardInterrupt

(base) kim@kim-System-Product-Name:~$ sudo ip netns exec ns2 python3 receiver.py latencies_prio.csv
^C
(base) kim@kim-System-Product-Name:~$ ^C
(base) kim@kim-System-Product-Name:~$ ^C
(base) kim@kim-System-Product-Name:~$ # 최대 UDP 포화(≈1Gbps) 60초
sudo ip netns exec ns1 iperf3 -c 10.0.0.2 -u -b 0 -t 60 -p 5201
[sudo] password for kim: 
Connecting to host 10.0.0.2, port 5201
[  5] local 10.0.0.1 port 41984 connected to 10.0.0.2 port 5201
[ ID] Interval           Transfer     Bitrate         Total Datagrams
[  5]   0.00-1.00   sec   702 MBytes  5.88 Gbits/sec  508201  
[  5]   1.00-2.00   sec   755 MBytes  6.34 Gbits/sec  546631  
[  5]   2.00-3.00   sec   758 MBytes  6.36 Gbits/sec  549267  
[  5]   3.00-4.00   sec   741 MBytes  6.21 Gbits/sec  536284  
[  5]   4.00-5.00   sec   774 MBytes  6.50 Gbits/sec  560461  
[  5]   5.00-6.00   sec   767 MBytes  6.43 Gbits/sec  555398  
[  5]   6.00-7.00   sec   787 MBytes  6.60 Gbits/sec  570067  
[  5]   7.00-8.00   sec   773 MBytes  6.49 Gbits/sec  559962  
[  5]   8.00-9.00   sec   784 MBytes  6.58 Gbits/sec  567889  
[  5]   9.00-10.00  sec   774 MBytes  6.49 Gbits/sec  560613  
[  5]  10.00-11.00  sec   769 MBytes  6.45 Gbits/sec  556522  
[  5]  11.00-12.00  sec   765 MBytes  6.42 Gbits/sec  553993  
[  5]  12.00-13.00  sec   765 MBytes  6.42 Gbits/sec  553865  
[  5]  13.00-14.00  sec   769 MBytes  6.45 Gbits/sec  557211  
[  5]  14.00-15.00  sec   765 MBytes  6.42 Gbits/sec  554169  
[  5]  15.00-16.00  sec   753 MBytes  6.31 Gbits/sec  545174  
[  5]  16.00-17.00  sec   758 MBytes  6.37 Gbits/sec  549067  
[  5]  17.00-18.00  sec   758 MBytes  6.36 Gbits/sec  549244  
[  5]  18.00-19.00  sec   758 MBytes  6.36 Gbits/sec  549089  
^C[  5]  19.00-19.16  sec   124 MBytes  6.48 Gbits/sec  89867  
- - - - - - - - - - - - - - - - - - - - - - - - -
[ ID] Interval           Transfer     Bitrate         Jitter    Lost/Total Datagrams
[  5]   0.00-19.16  sec  14.3 GBytes  6.39 Gbits/sec  0.000 ms  0/10572980 (0%)  sender
[  5]   0.00-19.16  sec  0.00 Bytes  0.00 bits/sec  0.000 ms  0/0 (0%)  receiver
iperf3: interrupt - the client has terminated
(base) kim@kim-System-Product-Name:~$ python3 plot_latency_compare.py latencies_prio.csv latencies_load_no.csv

## TAS vs No‑TAS under load

| Mode   |   Count |   Mean(ns) |   P50(ns) |   P95(ns) |   P99(ns) |   Max(ns) |
|--------|---------|------------|-----------|-----------|-----------|-----------|
| TAS    |   20000 |     7498.2 |      6798 |     10670 |     15019 |     83458 |
| No-TAS |  100000 |   598310   |    597483 |    873277 |    939794 |   1060900 |

✔ Saved compare histogram: /home/kim/latency_load_compare.png
(base) kim@kim-System-Product-Name:~$ python3 plot_latency_compare.py latencies_load_tas.csv latencies_load_no.csv

## TAS vs No‑TAS under load

| Mode   |   Count |   Mean(ns) |   P50(ns) |   P95(ns) |   P99(ns) |   Max(ns) |
|--------|---------|------------|-----------|-----------|-----------|-----------|
| TAS    |  100000 |     194215 |    195354 |    263367 |    271173 |    353343 |
| No-TAS |  100000 |     598310 |    597483 |    873277 |    939794 |   1060900 |

✔ Saved compare histogram: /home/kim/latency_load_compare.png
(base) kim@kim-System-Product-Name:~$ ^C
(base) kim@kim-System-Product-Name:~$ sudo ip netns exec ns1 iperf3 -c 10.0.0.2 -u -b 0 -t 60 -p 5201
Connecting to host 10.0.0.2, port 5201
[  5] local 10.0.0.1 port 37414 connected to 10.0.0.2 port 5201
[ ID] Interval           Transfer     Bitrate         Total Datagrams
[  5]   0.00-1.00   sec   755 MBytes  6.33 Gbits/sec  546631  
[  5]   1.00-2.00   sec   754 MBytes  6.32 Gbits/sec  545815  
[  5]   2.00-3.00   sec   758 MBytes  6.36 Gbits/sec  548737  
[  5]   3.00-4.00   sec   755 MBytes  6.33 Gbits/sec  546429  
[  5]   4.00-5.00   sec   764 MBytes  6.41 Gbits/sec  553523  
[  5]   5.00-6.00   sec   766 MBytes  6.43 Gbits/sec  554753  
[  5]   6.00-7.00   sec   768 MBytes  6.44 Gbits/sec  556431  
[  5]   7.00-8.00   sec   774 MBytes  6.50 Gbits/sec  560395  
[  5]   8.00-9.00   sec   764 MBytes  6.40 Gbits/sec  553132  
[  5]   9.00-10.00  sec   755 MBytes  6.34 Gbits/sec  547055  
[  5]  10.00-11.00  sec   766 MBytes  6.42 Gbits/sec  554828  
[  5]  11.00-12.00  sec   765 MBytes  6.42 Gbits/sec  554269  
[  5]  12.00-13.00  sec   753 MBytes  6.32 Gbits/sec  545515  
[  5]  13.00-14.00  sec   765 MBytes  6.41 Gbits/sec  553828  
[  5]  14.00-15.00  sec   758 MBytes  6.35 Gbits/sec  548563  
[  5]  15.00-16.00  sec   753 MBytes  6.32 Gbits/sec  545257  
[  5]  16.00-17.00  sec   756 MBytes  6.34 Gbits/sec  547656  
[  5]  17.00-18.00  sec   760 MBytes  6.38 Gbits/sec  550419  
[  5]  18.00-19.00  sec   748 MBytes  6.28 Gbits/sec  541384  
[  5]  18.00-19.00  sec   748 MBytes  6.28 Gbits/sec  541384  
- - - - - - - - - - - - - - - - - - - - - - - - -
[ ID] Interval           Transfer     Bitrate         Jitter    Lost/Total Datagrams
[  5]   0.00-19.00  sec  14.8 GBytes  6.70 Gbits/sec  0.000 ms  0/10995465 (0%)  sender
[  5]   0.00-19.00  sec  0.00 Bytes  0.00 bits/sec  0.000 ms  0/0 (0%)  receiver
iperf3: error - the server has terminated
(base) kim@kim-System-Product-Name:~$ ^C
(base) kim@kim-System-Product-Name:~$ python3 plot_latency_compare.py latencies_prio.csv latencies_load_no.csv

## TAS vs No‑TAS under load

| Mode   |   Count |   Mean(ns) |   P50(ns) |   P95(ns) |   P99(ns) |   Max(ns) |
|--------|---------|------------|-----------|-----------|-----------|-----------|
| TAS    |  100000 |     7981.3 |      6989 |     10924 |     15679 |     89602 |
| No-TAS |  100000 |   598310   |    597483 |    873277 |    939794 |   1060900 |

✔ Saved compare histogram: /home/kim/latency_load_compare.png
(base) kim@kim-System-Product-Name:~$ 
(base) kim@kim-System-Product-Name:~$ sudo tcpdump -i enp9s0 -w tas_10us.pcap -nn -tt
[sudo] password for kim: 
tcpdump: listening on enp9s0, link-type EN10MB (Ethernet), snapshot length 262144 bytes
^C98 packets captured
98 packets received by filter
0 packets dropped by kernel
(base) kim@kim-System-Product-Name:~$ ^C
(base) kim@kim-System-Product-Name:~$ sudo tcpdump -i enp9s0 -w tas_10us.pcap -nn -tt
# (2µs면 파일명을 tas_2us.pcap으로 변경)
[sudo] password for kim: 
tcpdump: listening on enp9s0, link-type EN10MB (Ethernet), snapshot length 262144 bytes
tcpdump: pcap_loop: The interface disappeared
613 packets captured
613 packets received by filter
0 packets dropped by kernel
(base) kim@kim-System-Product-Name:~$ sudo ip netns exec ns1 ~/setup_tas.sh 10
# → “base-time=…” 메시지 출력
#    3초 기다렸다가 실제 스케줄링이 시작됩니다.
Warning: sch_taprio: Size table not specified, frame length estimations may be inaccurate.
TAS on enp7s0: cycle=10µs (open=5000ns/close=5000ns) starting at base-time=1753685089439843758
(base) kim@kim-System-Product-Name:~$ sudo ip netns exec ns2 tcpdump -i enp9s0 -w toggle_test.pcap -nn -tt
tcpdump: listening on enp9s0, link-type EN10MB (Ethernet), snapshot length 262144 bytes
^C0 packets captured
0 packets received by filter
0 packets dropped by kernel
(base) kim@kim-System-Product-Name:~$ ^C
(base) kim@kim-System-Product-Name:~$ # 예: 총 3회 반복 × (10s+10s) = 60초 캡처
sudo ./capture_ns2.sh $((3* (10+10) + 1)) toggle_test.pcap
./capture_ns2.sh: line 3: [[: $#: syntax error: operand expected (error token is "$#")
[Capture] ns2 enp9s0 for $DUR sec → $OUT
timeout: invalid time interval ‘$DUR’
Try 'timeout --help' for more information.
Capture done → $OUT
(base) kim@kim-System-Product-Name:~$ sudo ip netns exec ns2 tcpdump -i enp9s0 -w toggle_test.pcap -nn -tt
tcpdump: listening on enp9s0, link-type EN10MB (Ethernet), snapshot length 262144 bytes
^C1 packet captured
1 packet received by filter
0 packets dropped by kernel
(base) kim@kim-System-Product-Name:~$ ^C
(base) kim@kim-System-Product-Name:~$ sudo ip netns exec ns1 ./send_hping3.sh 10
# → 10µs 간격으로 계속 송신, 토글 중에도 그대로 놔둡니다. 
[Sender] UDP @ 10µs → 169.254.59.100 on enp7s0 (infinite)
HPING 169.254.59.100 (enp7s0 169.254.59.100): udp mode set, 28 headers + 0 data bytes
ICMP Port Unreachable from ip=169.254.59.100 name=UNKNOWN   
status=0 port=2179 seq=0
ICMP Port Unreachable from ip=169.254.59.100 name=UNKNOWN   
status=0 port=2180 seq=1
ICMP Port Unreachable from ip=169.254.59.100 name=UNKNOWN   
status=0 port=2181 seq=2
ICMP Port Unreachable from ip=169.254.59.100 name=UNKNOWN   
status=0 port=2182 seq=3
ICMP Port Unreachable from ip=169.254.59.100 get hostname...status=0 port=2183 seq=4
ICMP Port Unreachable from ip=169.254.59.100 name=UNKNOWN   
status=0 port=2184 seq=5
ICMP Port Unreachable from ip=169.254.59.100 name=UNKNOWN   
status=0 port=1489 seq=64846
ICMP Port Unreachable from ipname=UNKNOWN   
status=0 port=888 seq=129781
ICMP Port Unreachable from ip=169.254.59.100 name=UNKNOWN   
status=0 port=65249 seq=194142
ICMP Port Unreachable from ip=169.254.59.100 name=UNKNOWN   
status=0 port=65373 seq=259802
ICMP Port Unreachable from ip=169.254.59.100 name=UNKNOWN   
status=0 port=279 seq=325780
ICMP Port Unreachable from ip=169.254.59.100 name=UNKNOWN   
status=0 port=848 seq=391885
ICMP Port Unreachable from ip=169.254.59.100 name=UNKNOWN   
status=0 port=1006 seq=457579
ICMP Port Unreachable from ip=169.254.59.100 name=UNKNOWN   
status=0 port=28 seq=522137
ICMP Port Unreachable from ip=169.254.59.100 name=UNKNOWN   
status=0 port=757 seq=588402
ICMP Port Unreachable from ip=169.254.59.100 get hostname...status=0 port=1237 seq=654418
ICMP Port Unreachable from ipname=UNKNOWN   
status=0 port=1629 seq=720346
 name=UNKNOWN   
status=0 port=1191 seq=785444
ICMP Port Unreachable from ip=169.254.59.100 get hostname...status=0 port=65430 seq=849683
ICMP Port Unreachable from ip=169.254.59.100 name=UNKNOWN   
status=0 port=225 seq=915550
 name=UNKNOWN   
status=0 port=477 seq=981338
 name=UNKNOWN   
status=0 port=681 seq=1047078
 name=UNKNOWN   
status=0 port=241 seq=1112174
ICMP Port Unreachable from ip=169.254.59.100 name=UNKNOWN   
status=0 port=63949 seq=1175882
ICMP Port Unreachable from ip=169.254.59.100 get hostname...status=0 port=61977 seq=1239446
ICMP Port Unreachable from ip=169.254.59.100 get hostname...status=0 port=62269 seq=1305274
^C
--- 169.254.59.100 hping statistic ---
1358895 packets transmitted, 26 packets received, 100% packet loss
round-trip min/avg/max = 1.0/1.7/3.1 ms
(base) kim@kim-System-Product-Name:~$ sudo ./toggle_tas.sh 3 10
[16:01:00] Iter 1 – TAS 10µs (open=5000ns)
Warning: sch_taprio: Size table not specified, frame length estimations may be inaccurate.
 → holding for 10s
[16:01:10] Iter 1 – TAS 2µs (open=1000ns)
Warning: sch_taprio: Size table not specified, frame length estimations may be inaccurate.
 → holding for 10s
[16:01:20] Iter 2 – TAS 10µs (open=5000ns)
Warning: sch_taprio: Size table not specified, frame length estimations may be inaccurate.
 → holding for 10s
[16:01:30] Iter 2 – TAS 2µs (open=1000ns)
Warning: sch_taprio: Size table not specified, frame length estimations may be inaccurate.
 → holding for 10s
[16:01:40] Iter 3 – TAS 10µs (open=5000ns)
Warning: sch_taprio: Size table not specified, frame length estimations may be inaccurate.
 → holding for 10s
^C
(base) kim@kim-System-Product-Name:~$ # enp7s0 확인
sudo ip link set dev enp7s0 down
sudo ip link set dev enp7s0 up
ip link show enp7s0
sudo ethtool enp7s0 | grep "Link detected"

# enp9s0 확인
sudo ip link set dev enp9s0 down
sudo ip link set dev enp9s0 up
ip link show enp9s0
sudo ethtool enp9s0 | grep "Link detected"
[sudo] password for kim: 
Cannot find device "enp7s0"
Cannot find device "enp7s0"
Device "enp7s0" does not exist.
netlink error: no device matches name (offset 24)
netlink error: No such device
netlink error: no device matches name (offset 24)
netlink error: No such device
netlink error: no device matches name (offset 24)
netlink error: No such device
netlink error: no device matches name (offset 24)
netlink error: No such device
netlink error: no device matches name (offset 24)
netlink error: No such device
netlink error: no device matches name (offset 24)
netlink error: No such device
netlink error: no device matches name (offset 24)
netlink error: No such device
Cannot find device "enp9s0"
Cannot find device "enp9s0"
Device "enp9s0" does not exist.
netlink error: no device matches name (offset 24)
netlink error: No such device
netlink error: no device matches name (offset 24)
netlink error: No such device
netlink error: no device matches name (offset 24)
netlink error: No such device
netlink error: no device matches name (offset 24)
netlink error: No such device
netlink error: no device matches name (offset 24)
netlink error: No such device
netlink error: no device matches name (offset 24)
netlink error: No such device
netlink error: no device matches name (offset 24)
netlink error: No such device
(base) kim@kim-System-Product-Name:~$ # 호스트에서
sudo ip link set dev enp9s0 down
sudo ip link set dev enp9s0 netns ns2

# ns2 에서
sudo ip netns exec ns2 ethtool -r enp9s0   # PHY 리셋 (가능한 경우)
sudo ip netns exec ns2 ip link set dev enp9s0 up
sudo ip netns exec ns2 ethtool enp9s0 | grep "Link detected"
Cannot find device "enp9s0"
Cannot find device "enp9s0"
	Link detected: no
(base) kim@kim-System-Product-Name:~$ 
(base) kim@kim-System-Product-Name:~$ 
(base) kim@kim-System-Product-Name:~$ 
(base) kim@kim-System-Product-Name:~$ tshark -r toggle_test.pcap \
  -q \
  -T fields \
    -e frame.time_epoch \
    -e frame.time_delta_displayed \
  -E header=y -E separator=, \
> toggle_test.csv

# 확인 (헤더 + 몇 줄)
head -n5 toggle_test.csv
frame.time_epoch,frame.time_delta_displayed
1753686058.943628000,0.000000000
1753686058.943643000,0.000015000
1753686058.943671000,0.000028000
1753686058.943672000,0.000001000
(base) kim@kim-System-Product-Name:~$ python3 - << 'EOF'
import pandas as pd
import matplotlib.pyplot as plt

# CSV 로드
df = pd.read_csv("toggle_test.csv")

# 나노초 단위 변환
df["time_ns"]    = df["frame.time_epoch"] * 1e9
df["delta_ns"]   = df["frame.time_delta_displayed"] * 1e9

for cycle_us in [10, 2]:
    cycle_ns = cycle_us * 1000
    df["mod_ns"] = df["time_ns"] % cycle_ns

    plt.figure(figsize=(6,4))
    plt.scatter(df["mod_ns"], df["delta_ns"], s=5)
    plt.title(f"Qbv {cycle_us}µs cycle")
    plt.xlabel("time mod cycle (ns)")
    plt.ylabel("inter‑arrival (ns)")
    plt.grid(True)

plt.show()
EOF
(base) kim@kim-System-Product-Name:~$ # 1) ns1 안에서 enp7s0을 기본 네임스페이스(1)로 복귀
sudo ip netns exec ns1 ip link set dev enp7s0 netns 1

# 2) ns2 안에서 enp9s0을 기본 네임스페이스(1)로 복귀
sudo ip netns exec ns2 ip link set dev enp9s0 netns 1

# 3) 네임스페이스 삭제
sudo ip netns del ns1
sudo ip netns del ns2

# 4) 호스트 네임스페이스에서 인터페이스 업 및 확인
sudo ip link set dev enp7s0 up
sudo ip link set dev enp9s0 up

ip link show enp7s0
ip link show enp9s0
8: enp7s0: <NO-CARRIER,BROADCAST,MULTICAST,UP> mtu 1500 qdisc mq state DOWN mode DEFAULT group default qlen 1000
    link/ether 68:05:ca:bd:96:e7 brd ff:ff:ff:ff:ff:ff
9: enp9s0: <NO-CARRIER,BROADCAST,MULTICAST,UP> mtu 1500 qdisc mq state DOWN mode DEFAULT group default qlen 1000
    link/ether d4:5d:64:b2:5d:c3 brd ff:ff:ff:ff:ff:ff
(base) kim@kim-System-Product-Name:~$ sudo ethtool -T enp7s0   # 타임스탬프 지원 확인
sudo ethtool -T enp9s0
Time stamping parameters for enp7s0:
Capabilities:
	hardware-transmit
	software-transmit
	hardware-receive
	software-receive
	software-system-clock
	hardware-raw-clock
PTP Hardware Clock: 0
Hardware Transmit Timestamp Modes:
	off
	on
Hardware Receive Filter Modes:
	none
	all
Time stamping parameters for enp9s0:
Capabilities:
	hardware-transmit
	software-transmit
	hardware-receive
	software-receive
	software-system-clock
	hardware-raw-clock
PTP Hardware Clock: 1
Hardware Transmit Timestamp Modes:
	off
	on
Hardware Receive Filter Modes:
	none
	all
(base) kim@kim-System-Product-Name:~$ 
(base) kim@kim-System-Product-Name:~$ 
(base) kim@kim-System-Product-Name:~$ sudo ethtool -T enp9s0
Time stamping parameters for enp9s0:
Capabilities:
	hardware-transmit
	software-transmit
	hardware-receive
	software-receive
	software-system-clock
	hardware-raw-clock
PTP Hardware Clock: 1
Hardware Transmit Timestamp Modes:
	off
	on
Hardware Receive Filter Modes:
	none
	all
(base) kim@kim-System-Product-Name:~$ sudo ip netns del ns1 2>/dev/null; sudo ip netns del ns2 2>/dev/null
sudo ip netns add ns1; sudo ip netns add ns2
(base) kim@kim-System-Product-Name:~$ # 3) 물리 NIC을 네임스페이스로 이동
sudo ip link set dev enp7s0 down
sudo ip link set dev enp9s0 down
sudo ip link set dev enp7s0 netns ns1
sudo ip link set dev enp9s0 netns ns2

# 4) 각 네임스페이스에서 인터페이스 UP & IP 할당
sudo ip netns exec ns1 ip link set lo up
sudo ip netns exec ns1 ip link set dev enp7s0 up
sudo ip netns exec ns1 ip addr add 169.254.59.170/16 dev enp7s0

sudo ip netns exec ns2 ip link set lo up
sudo ip netns exec ns2 ip link set dev enp9s0 up
sudo ip netns exec ns2 ip addr add 169.254.59.100/16 dev enp9s0

# 5) 링크 검증
sudo ip netns exec ns1 ethtool enp7s0 | grep "Link detected"
sudo ip netns exec ns2 ethtool enp9s0 | grep "Link detected"
	Link detected: no
	Link detected: no
(base) kim@kim-System-Product-Name:~$ # 호스트 기본 네임스페이스
sudo ip link set enp7s0 up
sudo ip link set enp9s0 up
sudo ethtool enp7s0 | grep "Link detected"
sudo ethtool enp9s0 | grep "Link detected"
Cannot find device "enp7s0"
Cannot find device "enp9s0"
netlink error: no device matches name (offset 24)
netlink error: No such device
netlink error: no device matches name (offset 24)
netlink error: No such device
netlink error: no device matches name (offset 24)
netlink error: No such device
netlink error: no device matches name (offset 24)
netlink error: No such device
netlink error: no device matches name (offset 24)
netlink error: No such device
netlink error: no device matches name (offset 24)
netlink error: No such device
netlink error: no device matches name (offset 24)
netlink error: No such device
netlink error: no device matches name (offset 24)
netlink error: No such device
netlink error: no device matches name (offset 24)
netlink error: No such device
netlink error: no device matches name (offset 24)
netlink error: No such device
netlink error: no device matches name (offset 24)
netlink error: No such device
netlink error: no device matches name (offset 24)
netlink error: No such device
netlink error: no device matches name (offset 24)
netlink error: No such device
netlink error: no device matches name (offset 24)
netlink error: No such device
(base) kim@kim-System-Product-Name:~$ # 1) 기본 네임스페이스에서 두 NIC 모두 완전 재설정
sudo ip link set dev enp7s0 down
sudo ip link set dev enp9s0 down

# 2) PHY 재협상(강제) → autoneg 끄고 100 Mb/s full‑duplex로 고정
sudo ethtool -s enp7s0 speed 100 duplex full autoneg off
sudo ethtool -s enp9s0 speed 100 duplex full autoneg off

# 3) 다시 UP
sudo ip link set dev enp7s0 up
sudo ip link set dev enp9s0 up

# 4) 상태 확인
ip link show enp7s0
sudo ethtool enp7s0 | grep "Link detected"
ip link show enp9s0
sudo ethtool enp9s0 | grep "Link detected"
Cannot find device "enp7s0"
Cannot find device "enp9s0"
netlink error: no device matches name (offset 24)
netlink error: No such device
netlink error: no device matches name (offset 24)
netlink error: No such device
Cannot find device "enp7s0"
Cannot find device "enp9s0"
Device "enp7s0" does not exist.
netlink error: no device matches name (offset 24)
netlink error: No such device
netlink error: no device matches name (offset 24)
netlink error: No such device
netlink error: no device matches name (offset 24)
netlink error: No such device
netlink error: no device matches name (offset 24)
netlink error: No such device
netlink error: no device matches name (offset 24)
netlink error: No such device
netlink error: no device matches name (offset 24)
netlink error: No such device
netlink error: no device matches name (offset 24)
netlink error: No such device
Device "enp9s0" does not exist.
netlink error: no device matches name (offset 24)
netlink error: No such device
netlink error: no device matches name (offset 24)
netlink error: No such device
netlink error: no device matches name (offset 24)
netlink error: No such device
netlink error: no device matches name (offset 24)
netlink error: No such device
netlink error: no device matches name (offset 24)
netlink error: No such device
netlink error: no device matches name (offset 24)
netlink error: No such device
netlink error: no device matches name (offset 24)
netlink error: No such device
(base) kim@kim-System-Product-Name:~$ ^C
(base) kim@kim-System-Product-Name:~$ # 1) ns1 안에서 enp7s0 복귀
sudo ip netns exec ns1 ip link set dev enp7s0 netns 1

# 2) ns2 안에서 enp9s0 복귀
sudo ip netns exec ns2 ip link set dev enp9s0 netns 1

# 3) 네임스페이스 삭제
sudo ip netns del ns1
sudo ip netns del ns2

# 4) 호스트 네임스페이스에서 인터페이스 UP
sudo ip link set dev enp7s0 up
sudo ip link set dev enp9s0 up

# 5) 복귀 확인
ip link show enp7s0
ip link show enp9s0
8: enp7s0: <NO-CARRIER,BROADCAST,MULTICAST,UP> mtu 1500 qdisc mq state DOWN mode DEFAULT group default qlen 1000
    link/ether 68:05:ca:bd:96:e7 brd ff:ff:ff:ff:ff:ff
9: enp9s0: <NO-CARRIER,BROADCAST,MULTICAST,UP> mtu 1500 qdisc mq state DOWN mode DEFAULT group default qlen 1000
    link/ether d4:5d:64:b2:5d:c3 brd ff:ff:ff:ff:ff:ff
(base) kim@kim-System-Product-Name:~$ # 1) autoneg 켜기 → 기본 negotiation 모드로 복귀
sudo ethtool -s enp7s0 autoneg on
sudo ethtool -s enp9s0 autoneg on

# 2) PHY 리셋을 위해 링크 down/up
sudo ip link set dev enp7s0 down
sudo ip link set dev enp7s0 up
sudo ip link set dev enp9s0 down
sudo ip link set dev enp9s0 up

# 3) 링크 상태 확인
sudo ethtool enp7s0 | grep "Link detected"
sudo ethtool enp9s0 | grep "Link detected"
	Link detected: no
	Link detected: no
(base) kim@kim-System-Product-Name:~$ # 1) ns1 안에서 enp7s0 복귀
sudo ip netns exec ns1 ip link set dev enp7s0 netns 1

# 2) ns2 안에서 enp9s0 복귀
sudo ip netns exec ns2 ip link set dev enp9s0 netns 1

# 3) 네임스페이스 삭제
sudo ip netns del ns1
sudo ip netns del ns2

# 4) 호스트 네임스페이스에서 인터페이스 UP
sudo ip link set dev enp7s0 up
sudo ip link set dev enp9s0 up

# 5) 복귀 확인
ip link show enp7s0
ip link show enp9s0
Cannot open network namespace "ns1": No such file or directory
Cannot open network namespace "ns2": No such file or directory
Cannot remove namespace file "/run/netns/ns1": No such file or directory
Cannot remove namespace file "/run/netns/ns2": No such file or directory
8: enp7s0: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc mq state UP mode DEFAULT group default qlen 1000
    link/ether 68:05:ca:bd:96:e7 brd ff:ff:ff:ff:ff:ff
9: enp9s0: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc mq state UP mode DEFAULT group default qlen 1000
    link/ether d4:5d:64:b2:5d:c3 brd ff:ff:ff:ff:ff:ff
(base) kim@kim-System-Product-Name:~$ # 1) ns1 안에서 enp7s0 복귀
sudo ip netns exec ns1 ip link set dev enp7s0 netns 1

# 2) ns2 안에서 enp9s0 복귀
sudo ip netns exec ns2 ip link set dev enp9s0 netns 1

# 3) 네임스페이스 삭제
sudo ip netns del ns1
sudo ip netns del ns2

# 4) 호스트 네임스페이스에서 인터페이스 UP
sudo ip link set dev enp7s0 up
sudo ip link set dev enp9s0 up

# 5) 복귀 확인
ip link show enp7s0
ip link show enp9s0
Cannot open network namespace "ns1": No such file or directory
Cannot open network namespace "ns2": No such file or directory
Cannot remove namespace file "/run/netns/ns1": No such file or directory
Cannot remove namespace file "/run/netns/ns2": No such file or directory
8: enp7s0: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc mq state UP mode DEFAULT group default qlen 1000
    link/ether 68:05:ca:bd:96:e7 brd ff:ff:ff:ff:ff:ff
9: enp9s0: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc mq state UP mode DEFAULT group default qlen 1000
    link/ether d4:5d:64:b2:5d:c3 brd ff:ff:ff:ff:ff:ff
(base) kim@kim-System-Product-Name:~$ sudo ethtool -s enp7s0 autoneg on
sudo ethtool -s enp9s0 autoneg on
(base) kim@kim-System-Product-Name:~$ 
(base) kim@kim-System-Product-Name:~$ 
(base) kim@kim-System-Product-Name:~$ # 1) 기존 네임스페이스 삭제
sudo ip netns del ns1 2>/dev/null
sudo ip netns del ns2 2>/dev/null

# 2) 네임스페이스 생성
sudo ip netns add ns1
sudo ip netns add ns2

# 3) 물리 NIC down → 네임스페이스로 이동
sudo ip link set dev enp7s0 down
sudo ip link set dev enp9s0 down
sudo ip link set dev enp7s0 netns ns1
sudo ip link set dev enp9s0 netns ns2

# 4) 각 네임스페이스에서 lo, NIC up 및 IP 할당
sudo ip netns exec ns1 ip link set lo up
sudo ip netns exec ns1 ip link set dev enp7s0 up
sudo ip netns exec ns1 ip addr add 169.254.59.170/16 dev enp7s0

sudo ip netns exec ns2 ip link set lo up
sudo ip netns exec ns2 ip link set dev enp9s0 up
sudo ip netns exec ns2 ip addr add 169.254.59.100/16 dev enp9s0

# 5) 링크 검증
sudo ip netns exec ns1 ethtool enp7s0 | grep "Link detected"
sudo ip netns exec ns2 ethtool enp9s0 | grep "Link detected"
	Link detected: no
	Link detected: no
(base) kim@kim-System-Product-Name:~$ ^C
(base) kim@kim-System-Product-Name:~$ sudo ip netns exec ns1 ethtool enp7s0 | grep "Link detected"
sudo ip netns exec ns2 ethtool enp9s0 | grep "Link detected"
	Link detected: yes
	Link detected: yes
(base) kim@kim-System-Product-Name:~$ sudo ip netns exec ns1 ethtool enp7s0 | grep "Link detected"
sudo ip netns exec ns2 ethtool enp9s0 | grep "Link detected"
	Link detected: yes
	Link detected: yes
(base) kim@kim-System-Product-Name:~$ sudo ip netns exec ns1 tc qdisc replace dev enp7s0 root handle 100: taprio \
  clockid CLOCK_TAI \
  num_tc 1 \
  map 0 0 0 0 0 0 0 0 \
  queues 1@0 \
  base-time $(($(date +%s%N)+3000000000)) \
  sched-entry S 01 5000 \
  sched-entry S 00 5000

echo "TAS 10µs cycle 설정됨 (3초 뒤 작동 시작)"
Warning: sch_taprio: Size table not specified, frame length estimations may be inaccurate.
TAS 10µs cycle 설정됨 (3초 뒤 작동 시작)
(base) kim@kim-System-Product-Name:~$ sudo ip netns exec ns1 hping3 --udp -I enp7s0 -p 54321 169.254.59.100 -i u10
# → 10µs 간격 무한 송신, Ctrl‑C로 중지
HPING 169.254.59.100 (enp7s0 169.254.59.100): udp mode set, 28 headers + 0 data bytes
ICMP Port Unreachable from ip=169.254.59.100 name=UNKNOWN   
status=0 port=2921 seq=0
ICMP Port Unreachable from ip=169.254.59.100 name=UNKNOWN   
status=0 port=2923 seq=2
ICMP Port Unreachable from ipname=UNKNOWN   
status=0 port=2924 seq=3
ICMP Port Unreachable from ipname=UNKNOWN   
status=0 port=2922 seq=1
ICMP Port Unreachable from ip=169.254.59.100 name=UNKNOWN   
status=0 port=2925 seq=4
ICMP Port Unreachable from ip=169.254.59.100 name=UNKNOWN   
status=0 port=2926 seq=5
 name=UNKNOWN   
status=0 port=2341 seq=64956
ICMP Port Unreachable from ip=169.254.59.100 name=UNKNOWN   
status=0 port=1617 seq=129768
ICMP Port Unreachable from ip=169.254.59.100 name=UNKNOWN   
status=0 port=789 seq=194476
ICMP Port Unreachable from ip=169.254.59.100 get hostname...status=0 port=65445 seq=259132
 name=UNKNOWN   
status=0 port=64532 seq=323755
 name=UNKNOWN   
status=0 port=63361 seq=388120
ICMP Port Unreachable from ipname=UNKNOWN   
status=0 port=61233 seq=451528
 name=UNKNOWN   
status=0 port=59310 seq=515141
ICMP Port Unreachable from ip=169.254.59.100 name=UNKNOWN   
status=0 port=59113 seq=580480
ICMP Port Unreachable from ip=169.254.59.100 name=UNKNOWN   
status=0 port=57345 seq=644248
ICMP Port Unreachable from ip=169.254.59.100 name=UNKNOWN   
status=0 port=54950 seq=707389
 name=UNKNOWN   
status=0 port=52737 seq=770712
^C
--- 169.254.59.100 hping statistic ---
780931 packets transmitted, 18 packets received, 100% packet loss
round-trip min/avg/max = 1.0/1.7/3.0 ms
(base) kim@kim-System-Product-Name:~$ sudo ip netns exec ns2 tcpdump -i enp9s0 -tt -nn -l \
  | awk 'BEGIN{OFS=","}{
      split($1,t,".");
      ts_ns = t[1]*1e9 + t[2];
      if(NR>1) print ts_ns, ts_ns-prev;
      prev = ts_ns
    }' \
  > times.csv
# 이 창은 패킷 수집이 끝난 후 Ctrl‑C 로 중지하세요.
[sudo] password for kim: 
tcpdump: verbose output suppressed, use -v[v]... for full protocol decode
listening on enp9s0, link-type EN10MB (Ethernet), snapshot length 262144 bytes
^C1143981 packets captured
1143981 packets received by filter
0 packets dropped by kernel

(base) kim@kim-System-Product-Name:~$ ^C
(base) kim@kim-System-Product-Name:~$ sudo ip netns exec ns2 tcpdump -i enp9s0 -tt -nn -l \
  | awk 'BEGIN{OFS=","}{
      split($1,t,".");
      ts_ns = t[1]*1e9 + t[2];
      if (NR>1) print ts_ns, ts_ns-prev;
      prev = ts_ns
    }' \
  > times.csv

# 이 터미널은 Ctrl‑C 하기 전까지 그대로 두세요.
tcpdump: verbose output suppressed, use -v[v]... for full protocol decode
listening on enp9s0, link-type EN10MB (Ethernet), snapshot length 262144 bytes
^C1885878 packets captured
1885878 packets received by filter
0 packets dropped by kernel

(base) kim@kim-System-Product-Name:~$ python3 - << 'EOF'
import pandas as pd
import matplotlib.pyplot as plt

df = pd.read_csv("times.csv", names=["time_ns","delta_ns"])
df["mod_ns"] = df.time_ns % (10*1000)

plt.figure()
plt.scatter(df.mod_ns, df.delta_ns, s=5)
plt.title("Qbv 10µs cycle (TXTIME‑assist)")
plt.xlabel("time mod cycle (ns)")
plt.ylabel("inter-arrival (ns)")
plt.grid(True)
plt.show()
EOF
(base) kim@kim-System-Product-Name:~$ # 예: 10µs 간격, 20000개 전송
sudo ip netns exec ns1 ./sender.py 10 20000 169.254.59.100
(base) kim@kim-System-Product-Name:~$ # 예: 10µs 간격, 20000개 전송
sudo ip netns exec ns1 ./sender.py 10 20000 169.254.59.100
(base) kim@kim-System-Product-Name:~$ python3 - << 'EOF'
import pandas as pd
import matplotlib.pyplot as plt

df = pd.read_csv("latencies.csv")
for cycle_us in [10, 2]:
    cycle_ns = cycle_us * 1000
    df_sub = df[df.tx_time_ns.notna()]
    df_sub["mod_ns"] = df_sub["tx_time_ns"] % cycle_ns
    plt.figure(figsize=(6,4))
    plt.scatter(df_sub["mod_ns"], df_sub["latency_ns"], s=5)
    plt.title(f"Qbv {cycle_us}µs cycle (payload TS)")
    plt.xlabel("tx_time mod cycle (ns)")
    plt.ylabel("latency (ns)")
    plt.grid(True)
plt.show()
EOF
Traceback (most recent call last):
  File "<stdin>", line 7, in <module>
  File "/home/kim/miniconda3/lib/python3.13/site-packages/pandas/core/generic.py", line 6318, in __getattr__
    return object.__getattribute__(self, name)
           ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^
AttributeError: 'DataFrame' object has no attribute 'tx_time_ns'
(base) kim@kim-System-Product-Name:~$ python3 - << 'EOF'
import pandas as pd
import matplotlib.pyplot as plt

# 1) CSV를 header 없이 읽고, 직접 컬럼 이름을 붙입니다.
df = pd.read_csv("latencies.csv",
                 header=0,       # 첫 줄을 건너뛰고
                 names=["tx_time_ns","latency_ns"])

# 2) cycle 별로 모듈로 계산 및 플롯
for cycle_us in [10, 2]:
    cycle_ns = cycle_us * 1000
    # 잔여 시간 계산
    df["mod_ns"] = df["tx_time_ns"] % cycle_ns

    plt.figure(figsize=(6,4))
    plt.scatter(df["mod_ns"], df["latency_ns"], s=5)
    plt.title(f"Qbv {cycle_us}µs cycle (payload TS)")
    plt.xlabel("tx_time mod cycle (ns)")
    plt.ylabel("latency (ns)")
    plt.grid(True)

plt.show()
EOF


^V^C^C^C^C^CTraceback (most recent call last):
  File "<stdin>", line 22, in <module>
  File "/home/kim/miniconda3/lib/python3.13/site-packages/matplotlib/pyplot.py", line 614, in show
    return _get_backend_mod().show(*args, **kwargs)
           ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "/home/kim/miniconda3/lib/python3.13/site-packages/matplotlib/backend_bases.py", line 3548, in show
    cls.mainloop()
    ~~~~~~~~~~~~^^
  File "/home/kim/miniconda3/lib/python3.13/site-packages/matplotlib/backends/_backend_tk.py", line 544, in start_main_loop
    first_manager.window.mainloop()
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "/home/kim/miniconda3/lib/python3.13/tkinter/__init__.py", line 1599, in mainloop
    self.tk.mainloop(n)
    ~~~~~~~~~~~~~~~~^^^
KeyboardInterrupt

(base) kim@kim-System-Product-Name:~$ 
(base) kim@kim-System-Product-Name:~$ 
(base) kim@kim-System-Product-Name:~$ 
(base) kim@kim-System-Product-Name:~$ 
(base) kim@kim-System-Product-Name:~$ 
(base) kim@kim-System-Product-Name:~$ echo "1) ns1→호스트 네임스페이스로 enp7s0 복귀..."
sudo ip netns exec ns1 ip link set dev enp7s0 netns 1

echo "2) ns2→호스트 네임스페이스로 enp9s0 복귀..."
sudo ip netns exec ns2 ip link set dev enp9s0 netns 1

echo "3) ns1, ns2 네임스페이스 삭제..."
sudo ip netns del ns1
sudo ip netns del ns2

echo "4) 호스트 네임스페이스에서 NIC up..."
sudo ip link set dev enp7s0 up
sudo ip link set dev enp9s0 up
1) ns1→호스트 네임스페이스로 enp7s0 복귀...
[sudo] password for kim: 
Cannot find device "enp7s0"
2) ns2→호스트 네임스페이스로 enp9s0 복귀...
Cannot find device "enp9s0"
3) ns1, ns2 네임스페이스 삭제...
4) 호스트 네임스페이스에서 NIC up...
(base) kim@kim-System-Product-Name:~$ 
(base) kim@kim-System-Product-Name:~$ 
(base) kim@kim-System-Product-Name:~$ sudo ip netns del ns1 2>/dev/null
sudo ip netns del ns2 2>/dev/null

# 2) 네임스페이스 생성
sudo ip netns add ns1
sudo ip netns add ns2

# 3) 물리 NIC 이동
sudo ip link set enp7s0 down
sudo ip link set enp9s0 down
sudo ip link set enp7s0 netns ns1
sudo ip link set enp9s0 netns ns2

# 4) 네임스페이스별 인터페이스 업 & IP 할당
sudo ip netns exec ns1 ip link set lo up
sudo ip netns exec ns1 ip link set dev enp7s0 up
sudo ip netns exec ns1 ip addr add 169.254.59.170/16 dev enp7s0

sudo ip netns exec ns2 ip link set lo up
sudo ip netns exec ns2 ip link set dev enp9s0 up
sudo ip netns exec ns2 ip addr add 169.254.59.100/16 dev enp9s0
(base) kim@kim-System-Product-Name:~$ sudo ip netns exec ns2 python3 receiver.py latencies.csv
# → latencies.csv 에 [tx_time_ns, latency_ns] 계속 기록
#   (이 창은 Ctrl‑C로 중지하지 마세요)
^CTraceback (most recent call last):
  File "/home/kim/receiver.py", line 14, in <module>
    data,addr = sock.recvfrom(8)
                ^^^^^^^^^^^^^^^^
KeyboardInterrupt

(base) kim@kim-System-Product-Name:~$ python3 analysis/plot_latency.py latencies.csv
python3: can't open file '/home/kim/analysis/plot_latency.py': [Errno 2] No such file or directory
(base) kim@kim-System-Product-Name:~$ cat << 'EOF' > plot_latency.py
#!/usr/bin/env python3
import pandas as pd
import matplotlib.pyplot as plt
import numpy as np
import os
from tabulate import tabulate

# 입력 CSV
csv_path = "latencies.csv"
df = pd.read_csv(csv_path)

# 요약 통계
summary = []
for cycle_us in [2, 10]:
    cycle_ns = cycle_us * 1000
    sub = df[df["tx_time_ns"] % cycle_ns < cycle_ns]
    desc = sub["latency_ns"].describe(percentiles=[.01, .05, .5, .95, .99])
    summary.append({
        "Cycle (µs)": cycle_us,
        "Count": int(desc["count"]),
        "Mean (ns)": f"{desc['mean']:.1f}",
        "Std (ns)": f"{desc['std']:.1f}",
        "Min": int(desc["min"]),
        "1%":  int(desc["1%"]),
        "5%":  int(desc["5%"]),
        "50%": int(desc["50%"]),
        "95%": int(desc["95%"]),
        "99%": int(desc["99%"]),
        "Max": int(desc["max"]),
    })

print("\n## 요약 통계")
print(tabulate(summary, headers="keys", tablefmt="github"))

# 히스토그램
hist_path = os.path.expanduser("~/latency_histogram.png")
plt.figure(figsize=(6,4))
bins = np.linspace(0, df["latency_ns"].max(), 200)
for cycle_us in [2, 10]:
    sub = df[df["tx_time_ns"] % (cycle_us*1000) < cycle_us*1000]
    plt.hist(sub["latency_ns"], bins=bins, histtype="step", label=f"{cycle_us}µs")
plt.title("Latency Histogram")
chmod +x plot_latency.py     {cdf_path}")}")")) < cycle_us*1000]
(base) kim@kim-System-Product-Name:~$ # 이제 파일이 생성된 위치에서
python3 plot_latency.py

## 요약 통계
|   Cycle (µs) |   Count |   Mean (ns) |   Std (ns) |   Min |    1% |    5% |   50% |   95% |   99% |    Max |
|--------------|---------|-------------|------------|-------|-------|-------|-------|-------|-------|--------|
|            2 |   20000 |     20572.2 |     6640.3 | 13875 | 14658 | 15125 | 18994 | 31535 | 49808 | 271800 |
|           10 |   20000 |     20572.2 |     6640.3 | 13875 | 14658 | 15125 | 18994 | 31535 | 49808 | 271800 |

✔ 저장된 히스토그램: /home/kim/latency_histogram.png
✔ 저장된 CDF:        /home/kim/latency_cdf.png
(base) kim@kim-System-Product-Name:~$ # 1) TAS 스케줄 삭제
sudo ip netns exec ns1 tc qdisc del dev enp7s0 root

# 2) tcpdump로 인터‐배열 덤프 (No‑TAS)
sudo ip netns exec ns2 tcpdump -i enp9s0 -tt -nn -l \
  | awk 'BEGIN{OFS=","}{
      split($1,t,".");
      ts_ns = t[1]*1e9 + t[2];
      if(NR>1) print ts_ns, ts_ns-prev;
      prev = ts_ns
    }' \
  > times_no_tas.csv
# → 이 터미널은 Ctrl‑C 전까지 켜 두세요.
tcpdump: verbose output suppressed, use -v[v]... for full protocol decode
listening on enp9s0, link-type EN10MB (Ethernet), snapshot length 262144 bytes
^C20002 packets captured
20002 packets received by filter
0 packets dropped by kernel

(base) kim@kim-System-Product-Name:~$ python3 - << 'EOF'
import pandas as pd
import matplotlib.pyplot as plt
import numpy as np
from tabulate import tabulate

# TAS 데이터 (payload TS)
df_tas = pd.read_csv("latencies.csv")
# No‑TAS 데이터
df_no = pd.read_csv("latencies_no_tas.csv", names=["time_ns","delta_ns"])
# delta→latency 약식 처리 (여기선 delta 그대로 사용)
df_no = df_no.rename(columns={"delta_ns":"latency_ns"})

summary = []
for label, df in [("TAS", df_tas), ("No‑TAS", df_no)]:
    lat = df["latency_ns"]
    desc = lat.describe(percentiles=[.5, .95, .99])
    summary.append({
        "Mode": label,
        "Count": int(desc["count"]),
        "Mean": f"{desc['mean']:.1f}",
        "P50": int(desc["50%"]),
        "P95": int(desc["95%"]),
        "P99": int(desc["99%"]),
        "Max": int(desc["max"]),
    })

print("\n## TAS vs No‑TAS 요약 통계")
print(tabulate(summary, headers="keys", tablefmt="github"))

# 히스토그램 비교
plt.figure(figsize=(6,4))
bins = np.linspace(0, max(df_tas["latency_ns"].max(), df_no["latency_ns"].max()), 200)
plt.hist(df_tas["latency_ns"], bins=bins, histtype="step", label="TAS")
plt.hist(df_no["latency_ns"], bins=bins, histtype="step", label="No‑TAS")
plt.title("Latency Histogram: TAS vs No‑TAS")
plt.xlabel("latency (ns)")
plt.ylabel("count")
plt.legend()
plt.grid(True)
plt.tight_layout()
plt.savefig("~/latency_compare_hist.png")
plt.show()
EOF
Traceback (most recent call last):
  File "/home/kim/miniconda3/lib/python3.13/site-packages/pandas/core/indexes/base.py", line 3812, in get_loc
    return self._engine.get_loc(casted_key)
           ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^
  File "pandas/_libs/index.pyx", line 167, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 196, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 7088, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 7096, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'mean'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "<stdin>", line 20, in <module>
  File "/home/kim/miniconda3/lib/python3.13/site-packages/pandas/core/series.py", line 1130, in __getitem__
    return self._get_value(key)
           ~~~~~~~~~~~~~~~^^^^^
  File "/home/kim/miniconda3/lib/python3.13/site-packages/pandas/core/series.py", line 1246, in _get_value
    loc = self.index.get_loc(label)
  File "/home/kim/miniconda3/lib/python3.13/site-packages/pandas/core/indexes/base.py", line 3819, in get_loc
    raise KeyError(key) from err
KeyError: 'mean'
(base) kim@kim-System-Product-Name:~$ 
(base) kim@kim-System-Product-Name:~$ 
(base) kim@kim-System-Product-Name:~$ python3 - << 'EOF'
import pandas as pd, numpy as np
import matplotlib.pyplot as plt
from tabulate import tabulate
import os

# 1) TAS 측정 결과 로드 (payload TS)
df_tas = pd.read_csv("latencies.csv", header=0)  
#   → 칼럼: tx_time_ns, latency_ns

# 2) No‑TAS Payload‑TS 결과 로드 (receiver.py가 만든 파일)
df_no = pd.read_csv("latencies_no_tas.csv", header=0)  
#   → 칼럼: tx_time_ns, latency_ns

# 3) 동일한 컬럼명 통일
df_no = df_no.rename(columns={"tx_time_ns":"tx_time_ns","latency_ns":"latency_ns"})

summary = []
for label, df in [("TAS", df_tas), ("No‑TAS", df_no)]:
    lat = df["latency_ns"].astype(float)
    desc = lat.describe(percentiles=[.5, .95, .99])
    summary.append({
        "Mode":    label,
        "Count":   int(desc["count"]),
        "Mean(ns)": round(desc["mean"],1),
        "P50(ns)": int(desc["50%"]),
        "P95(ns)": int(desc["95%"]),
        "P99(ns)": int(desc["99%"]),
        "Max(ns)": int(desc["max"]),
    })

print("\n## TAS vs No‑TAS 요약 통계")
print(tabulate(summary, headers="keys", tablefmt="github"))

# 4) 히스토그램 비교
hist_path = os.path.expanduser("~/latency_compare_hist.png")
plt.figure(figsize=(6,4))
bins = np.linspace(
    0,
    max(df_tas["latency_ns"].max(), df_no["latency_ns"].max()),
    200
)
plt.hist(df_tas["latency_ns"], bins=bins, histtype="step", label="TAS")
EOFnt(f"\n✔ 저장된 비교 히스토그램: {hist_path}")="step", label="No‑TAS")

## TAS vs No‑TAS 요약 통계
| Mode   |   Count |   Mean(ns) |   P50(ns) |   P95(ns) |   P99(ns) |   Max(ns) |
|--------|---------|------------|-----------|-----------|-----------|-----------|
| TAS    |   20000 |    20572.2 |     18994 |     31535 |     49808 |    271800 |
| No‑TAS |   20000 |    19525.7 |     18333 |     29732 |     50728 |    186095 |

✔ 저장된 비교 히스토그램: /home/kim/latency_compare_hist.png
(base) kim@kim-System-Product-Name:~$ 
(base) kim@kim-System-Product-Name:~$ 
(base) kim@kim-System-Product-Name:~$ 
(base) kim@kim-System-Product-Name:~$ # ns1 에서 iperf3 서버 실행
sudo ip netns exec ns2 iperf3 -s -u -p 5201
[sudo] password for kim: 
iperf3: parameter error - some option you are trying to set is client only

Usage: iperf3 [-s|-c host] [options]
Try `iperf3 --help' for more information.
(base) kim@kim-System-Product-Name:~$ # UDP/클라이언트가 접속하면 자동으로 UDP 모드로 동작합니다.
sudo ip netns exec ns2 iperf3 -s -p 5201
-----------------------------------------------------------
Server listening on 5201 (test #1)
-----------------------------------------------------------
Accepted connection from 169.254.59.170, port 55102
[  5] local 169.254.59.100 port 5201 connected to 169.254.59.170 port 47053
[ ID] Interval           Transfer     Bitrate         Jitter    Lost/Total Datagrams
[  5]   0.00-1.00   sec   114 MBytes   956 Mbits/sec  0.017 ms  0/82495 (0%)  
[  5]   1.00-2.00   sec   114 MBytes   956 Mbits/sec  0.031 ms  0/82553 (0%)  
[  5]   2.00-3.00   sec   114 MBytes   956 Mbits/sec  0.011 ms  0/82560 (0%)  
[  5]   3.00-4.00   sec   114 MBytes   956 Mbits/sec  0.009 ms  0/82560 (0%)  
[  5]   4.00-5.00   sec   114 MBytes   956 Mbits/sec  0.026 ms  0/82560 (0%)  
[  5]   5.00-6.00   sec   114 MBytes   956 Mbits/sec  0.010 ms  0/82560 (0%)  
[  5]   6.00-7.00   sec   114 MBytes   956 Mbits/sec  0.032 ms  0/82560 (0%)  
[  5]   7.00-8.00   sec   114 MBytes   956 Mbits/sec  0.021 ms  0/82560 (0%)  
[  5]   8.00-9.00   sec   114 MBytes   956 Mbits/sec  0.020 ms  0/82560 (0%)  
[  5]   9.00-10.00  sec   114 MBytes   956 Mbits/sec  0.014 ms  0/82561 (0%)  
[  5]  10.00-11.00  sec   114 MBytes   956 Mbits/sec  0.029 ms  0/82560 (0%)  
[  5]  11.00-12.00  sec   114 MBytes   956 Mbits/sec  0.027 ms  0/82560 (0%)  
[  5]  12.00-13.00  sec   114 MBytes   956 Mbits/sec  0.019 ms  0/82560 (0%)  
[  5]  13.00-14.00  sec   114 MBytes   956 Mbits/sec  0.034 ms  0/82560 (0%)  
[  5]  14.00-15.00  sec   114 MBytes   956 Mbits/sec  0.013 ms  0/82560 (0%)  
[  5]  15.00-16.00  sec   114 MBytes   956 Mbits/sec  0.022 ms  0/82560 (0%)  
[  5]  16.00-17.00  sec   114 MBytes   956 Mbits/sec  0.016 ms  0/82560 (0%)  
[  5]  17.00-18.00  sec   114 MBytes   956 Mbits/sec  0.024 ms  0/82560 (0%)  
[  5]  18.00-19.00  sec   114 MBytes   956 Mbits/sec  0.011 ms  0/82560 (0%)  
[  5]  19.00-20.00  sec   114 MBytes   956 Mbits/sec  0.021 ms  0/82560 (0%)  
[  5]  20.00-21.00  sec   114 MBytes   956 Mbits/sec  0.012 ms  0/82560 (0%)  
[  5]  21.00-22.00  sec   114 MBytes   956 Mbits/sec  0.015 ms  0/82560 (0%)  
[  5]  22.00-23.00  sec   114 MBytes   956 Mbits/sec  0.011 ms  0/82560 (0%)  
[  5]  23.00-24.00  sec   114 MBytes   956 Mbits/sec  0.011 ms  0/82560 (0%)  
[  5]  24.00-25.00  sec   114 MBytes   956 Mbits/sec  0.020 ms  0/82560 (0%)  
[  5]  25.00-26.00  sec   114 MBytes   956 Mbits/sec  0.038 ms  0/82560 (0%)  
[  5]  26.00-27.00  sec   114 MBytes   956 Mbits/sec  0.010 ms  0/82560 (0%)  
[  5]  27.00-28.00  sec   114 MBytes   956 Mbits/sec  0.029 ms  0/82560 (0%)  
[  5]  28.00-29.00  sec   114 MBytes   956 Mbits/sec  0.009 ms  0/82561 (0%)  
[  5]  29.00-30.00  sec   114 MBytes   956 Mbits/sec  0.011 ms  0/82560 (0%)  
[  5]  30.00-31.00  sec   114 MBytes   956 Mbits/sec  0.018 ms  0/82560 (0%)  
[  5]  31.00-32.00  sec   114 MBytes   956 Mbits/sec  0.011 ms  0/82560 (0%)  
[  5]  32.00-33.00  sec   114 MBytes   956 Mbits/sec  0.042 ms  0/82560 (0%)  
[  5]  33.00-34.00  sec   114 MBytes   956 Mbits/sec  0.010 ms  0/82560 (0%)  
[  5]  34.00-35.00  sec   114 MBytes   956 Mbits/sec  0.031 ms  0/82560 (0%)  
[  5]  35.00-36.00  sec   114 MBytes   956 Mbits/sec  0.010 ms  0/82560 (0%)  
[  5]  36.00-37.00  sec   114 MBytes   956 Mbits/sec  0.039 ms  0/82560 (0%)  
[  5]  37.00-38.00  sec   114 MBytes   956 Mbits/sec  0.048 ms  0/82560 (0%)  
[  5]  38.00-39.00  sec   114 MBytes   956 Mbits/sec  0.013 ms  0/82560 (0%)  
[  5]  39.00-40.00  sec   114 MBytes   956 Mbits/sec  0.008 ms  0/82560 (0%)  
[  5]  40.00-41.00  sec   114 MBytes   956 Mbits/sec  0.028 ms  0/82558 (0%)  
[  5]  41.00-42.00  sec   114 MBytes   956 Mbits/sec  0.022 ms  0/82558 (0%)  
[  5]  42.00-43.00  sec   114 MBytes   956 Mbits/sec  0.011 ms  0/82561 (0%)  
[  5]  43.00-44.00  sec   114 MBytes   956 Mbits/sec  0.016 ms  0/82557 (0%)  
[  5]  44.00-45.00  sec   114 MBytes   956 Mbits/sec  0.019 ms  0/82554 (0%)  
[  5]  45.00-46.00  sec   114 MBytes   956 Mbits/sec  0.047 ms  0/82561 (0%)  
[  5]  46.00-47.00  sec   114 MBytes   956 Mbits/sec  0.032 ms  0/82558 (0%)  
[  5]  47.00-48.00  sec   114 MBytes   956 Mbits/sec  0.008 ms  0/82559 (0%)  
[  5]  48.00-49.00  sec   114 MBytes   956 Mbits/sec  0.028 ms  0/82561 (0%)  
[  5]  49.00-50.00  sec   114 MBytes   956 Mbits/sec  0.044 ms  0/82560 (0%)  
[  5]  50.00-51.00  sec   114 MBytes   956 Mbits/sec  0.023 ms  0/82559 (0%)  
[  5]  51.00-52.00  sec   114 MBytes   956 Mbits/sec  0.027 ms  0/82560 (0%)  
[  5]  52.00-53.00  sec   114 MBytes   956 Mbits/sec  0.017 ms  0/82567 (0%)  
[  5]  53.00-54.00  sec   114 MBytes   956 Mbits/sec  0.029 ms  0/82560 (0%)  
[  5]  54.00-55.00  sec   114 MBytes   956 Mbits/sec  0.024 ms  0/82554 (0%)  
[  5]  55.00-56.00  sec   114 MBytes   956 Mbits/sec  0.020 ms  0/82560 (0%)  
[  5]  56.00-57.00  sec   114 MBytes   956 Mbits/sec  0.041 ms  0/82559 (0%)  
[  5]  57.00-58.00  sec   114 MBytes   956 Mbits/sec  0.013 ms  0/82567 (0%)  
[  5]  58.00-59.00  sec   114 MBytes   956 Mbits/sec  0.008 ms  0/82553 (0%)  
[  5]  59.00-60.00  sec   114 MBytes   956 Mbits/sec  0.027 ms  0/82561 (0%)  
[  5]  60.00-60.00  sec   160 KBytes   965 Mbits/sec  0.013 ms  0/119 (0%)  
- - - - - - - - - - - - - - - - - - - - - - - - -
[ ID] Interval           Transfer     Bitrate         Jitter    Lost/Total Datagrams
[  5]   0.00-60.00  sec  6.68 GBytes   956 Mbits/sec  0.013 ms  0/4953636 (0%)  receiver
-----------------------------------------------------------
Server listening on 5201 (test #2)
-----------------------------------------------------------
Accepted connection from 169.254.59.170, port 60842
[  5] local 169.254.59.100 port 5201 connected to 169.254.59.170 port 50729
[ ID] Interval           Transfer     Bitrate         Jitter    Lost/Total Datagrams
[  5]   0.00-1.00   sec  0.00 Bytes  0.00 bits/sec  0.000 ms  0/0 (0%)  
[  5]   1.00-2.00   sec  0.00 Bytes  0.00 bits/sec  0.000 ms  0/0 (0%)  
[  5]   2.00-3.00   sec  0.00 Bytes  0.00 bits/sec  0.000 ms  0/0 (0%)  
[  5]   3.00-4.00   sec  0.00 Bytes  0.00 bits/sec  0.000 ms  0/0 (0%)  
[  5]   4.00-5.00   sec  0.00 Bytes  0.00 bits/sec  0.000 ms  0/0 (0%)  
[  5]   5.00-6.00   sec  0.00 Bytes  0.00 bits/sec  0.000 ms  0/0 (0%)  
[  5]   6.00-7.00   sec  0.00 Bytes  0.00 bits/sec  0.000 ms  0/0 (0%)  
[  5]   7.00-8.00   sec  0.00 Bytes  0.00 bits/sec  0.000 ms  0/0 (0%)  
[  5]   8.00-9.00   sec  0.00 Bytes  0.00 bits/sec  0.000 ms  0/0 (0%)  
[  5]   9.00-10.00  sec  0.00 Bytes  0.00 bits/sec  0.000 ms  0/0 (0%)  
[  5]  10.00-11.00  sec  0.00 Bytes  0.00 bits/sec  0.000 ms  0/0 (0%)  
[  5]  11.00-12.00  sec  0.00 Bytes  0.00 bits/sec  0.000 ms  0/0 (0%)  
[  5]  12.00-13.00  sec  0.00 Bytes  0.00 bits/sec  0.000 ms  0/0 (0%)  
[  5]  13.00-14.00  sec  0.00 Bytes  0.00 bits/sec  0.000 ms  0/0 (0%)  
[  5]  14.00-15.00  sec  0.00 Bytes  0.00 bits/sec  0.000 ms  0/0 (0%)  
[  5]  15.00-16.00  sec  0.00 Bytes  0.00 bits/sec  0.000 ms  0/0 (0%)  
[  5]  16.00-17.00  sec  0.00 Bytes  0.00 bits/sec  0.000 ms  0/0 (0%)  
[  5]  17.00-18.00  sec  0.00 Bytes  0.00 bits/sec  0.000 ms  0/0 (0%)  
[  5]  18.00-19.00  sec  0.00 Bytes  0.00 bits/sec  0.000 ms  0/0 (0%)  
[  5]  19.00-20.00  sec  0.00 Bytes  0.00 bits/sec  0.000 ms  0/0 (0%)  
[  5]  20.00-21.00  sec  0.00 Bytes  0.00 bits/sec  0.000 ms  0/0 (0%)  
[  5]  21.00-22.00  sec  0.00 Bytes  0.00 bits/sec  0.000 ms  0/0 (0%)  
[  5]  22.00-23.00  sec  0.00 Bytes  0.00 bits/sec  0.000 ms  0/0 (0%)  
[  5]  23.00-24.00  sec  0.00 Bytes  0.00 bits/sec  0.000 ms  0/0 (0%)  
[  5]  24.00-25.00  sec  0.00 Bytes  0.00 bits/sec  0.000 ms  0/0 (0%)  
[  5]  25.00-26.00  sec  0.00 Bytes  0.00 bits/sec  0.000 ms  0/0 (0%)  
[  5]  26.00-27.00  sec  0.00 Bytes  0.00 bits/sec  0.000 ms  0/0 (0%)  
[  5]  27.00-28.00  sec  0.00 Bytes  0.00 bits/sec  0.000 ms  0/0 (0%)  
[  5]  28.00-29.00  sec  0.00 Bytes  0.00 bits/sec  0.000 ms  0/0 (0%)  
[  5]  29.00-30.00  sec  0.00 Bytes  0.00 bits/sec  0.000 ms  0/0 (0%)  
[  5]  30.00-31.00  sec  0.00 Bytes  0.00 bits/sec  0.000 ms  0/0 (0%)  
[  5]  31.00-32.00  sec  0.00 Bytes  0.00 bits/sec  0.000 ms  0/0 (0%)  
[  5]  32.00-33.00  sec  0.00 Bytes  0.00 bits/sec  0.000 ms  0/0 (0%)  
[  5]  33.00-34.00  sec  0.00 Bytes  0.00 bits/sec  0.000 ms  0/0 (0%)  
[  5]  34.00-35.00  sec  0.00 Bytes  0.00 bits/sec  0.000 ms  0/0 (0%)  
[  5]  35.00-36.00  sec  0.00 Bytes  0.00 bits/sec  0.000 ms  0/0 (0%)  
[  5]  36.00-37.00  sec  0.00 Bytes  0.00 bits/sec  0.000 ms  0/0 (0%)  
[  5]  37.00-38.00  sec  0.00 Bytes  0.00 bits/sec  0.000 ms  0/0 (0%)  
[  5]  38.00-39.00  sec  0.00 Bytes  0.00 bits/sec  0.000 ms  0/0 (0%)  
[  5]  39.00-40.00  sec  0.00 Bytes  0.00 bits/sec  0.000 ms  0/0 (0%)  
[  5]  40.00-41.00  sec  0.00 Bytes  0.00 bits/sec  0.000 ms  0/0 (0%)  
[  5]  41.00-42.00  sec  0.00 Bytes  0.00 bits/sec  0.000 ms  0/0 (0%)  
[  5]  42.00-43.00  sec  0.00 Bytes  0.00 bits/sec  0.000 ms  0/0 (0%)  
[  5]  43.00-44.00  sec  0.00 Bytes  0.00 bits/sec  0.000 ms  0/0 (0%)  
[  5]  44.00-45.00  sec  0.00 Bytes  0.00 bits/sec  0.000 ms  0/0 (0%)  
[  5]  45.00-46.00  sec  0.00 Bytes  0.00 bits/sec  0.000 ms  0/0 (0%)  
[  5]  46.00-47.00  sec  0.00 Bytes  0.00 bits/sec  0.000 ms  0/0 (0%)  
[  5]  47.00-48.00  sec  0.00 Bytes  0.00 bits/sec  0.000 ms  0/0 (0%)  
[  5]  48.00-49.00  sec  0.00 Bytes  0.00 bits/sec  0.000 ms  0/0 (0%)  
[  5]  49.00-50.00  sec  0.00 Bytes  0.00 bits/sec  0.000 ms  0/0 (0%)  
[  5]  50.00-51.00  sec  0.00 Bytes  0.00 bits/sec  0.000 ms  0/0 (0%)  
[  5]  51.00-52.00  sec  0.00 Bytes  0.00 bits/sec  0.000 ms  0/0 (0%)  
[  5]  52.00-53.00  sec  0.00 Bytes  0.00 bits/sec  0.000 ms  0/0 (0%)  
[  5]  53.00-54.00  sec  0.00 Bytes  0.00 bits/sec  0.000 ms  0/0 (0%)  
[  5]  54.00-55.00  sec  0.00 Bytes  0.00 bits/sec  0.000 ms  0/0 (0%)  
[  5]  55.00-56.00  sec  0.00 Bytes  0.00 bits/sec  0.000 ms  0/0 (0%)  
[  5]  56.00-57.00  sec  0.00 Bytes  0.00 bits/sec  0.000 ms  0/0 (0%)  
[  5]  57.00-58.00  sec  0.00 Bytes  0.00 bits/sec  0.000 ms  0/0 (0%)  
[  5]  58.00-59.00  sec  0.00 Bytes  0.00 bits/sec  0.000 ms  0/0 (0%)  
[  5]  59.00-60.00  sec  0.00 Bytes  0.00 bits/sec  0.000 ms  0/0 (0%)  
- - - - - - - - - - - - - - - - - - - - - - - - -
[ ID] Interval           Transfer     Bitrate         Jitter    Lost/Total Datagrams
[  5]   0.00-60.00  sec  0.00 Bytes  0.00 bits/sec  0.000 ms  0/0 (0%)  receiver
WARNING:  Size of data read does not correspond to offered length
iperf3: error - unable to receive results: Bad file descriptor
-----------------------------------------------------------
Server listening on 5201 (test #3)
-----------------------------------------------------------
WARNING:  Size of data read does not correspond to offered length
iperf3: error - unable to receive parameters from client: Bad file descriptor
-----------------------------------------------------------
Server listening on 5201 (test #4)
-----------------------------------------------------------
Accepted connection from 169.254.59.170, port 46584
[  5] local 169.254.59.100 port 5201 connected to 169.254.59.170 port 44367
[ ID] Interval           Transfer     Bitrate         Jitter    Lost/Total Datagrams
[  5]   0.00-1.00   sec   114 MBytes   955 Mbits/sec  0.012 ms  0/82481 (0%)  
[  5]   1.00-2.00   sec   114 MBytes   956 Mbits/sec  0.010 ms  0/82561 (0%)  
[  5]   2.00-3.00   sec   114 MBytes   956 Mbits/sec  0.024 ms  0/82560 (0%)  
[  5]   3.00-4.00   sec   114 MBytes   956 Mbits/sec  0.015 ms  0/82560 (0%)  
[  5]   4.00-5.00   sec   114 MBytes   956 Mbits/sec  0.024 ms  0/82560 (0%)  
[  5]   5.00-6.00   sec   114 MBytes   956 Mbits/sec  0.010 ms  0/82561 (0%)  
[  5]   6.00-7.00   sec   114 MBytes   956 Mbits/sec  0.010 ms  0/82559 (0%)  
[  5]   7.00-8.00   sec   114 MBytes   956 Mbits/sec  0.013 ms  0/82560 (0%)  
[  5]   8.00-9.00   sec   114 MBytes   956 Mbits/sec  0.012 ms  0/82560 (0%)  
[  5]   9.00-10.00  sec   114 MBytes   956 Mbits/sec  0.008 ms  0/82560 (0%)  
[  5]  10.00-11.00  sec   114 MBytes   956 Mbits/sec  0.009 ms  0/82561 (0%)  
[  5]  11.00-12.00  sec   114 MBytes   956 Mbits/sec  0.011 ms  0/82560 (0%)  
[  5]  12.00-13.00  sec   114 MBytes   956 Mbits/sec  0.010 ms  0/82560 (0%)  
[  5]  13.00-14.00  sec   114 MBytes   956 Mbits/sec  0.021 ms  0/82560 (0%)  
[  5]  14.00-15.00  sec   114 MBytes   956 Mbits/sec  0.010 ms  0/82560 (0%)  
[  5]  15.00-16.00  sec   114 MBytes   956 Mbits/sec  0.009 ms  0/82560 (0%)  
[  5]  16.00-17.00  sec   114 MBytes   956 Mbits/sec  0.010 ms  0/82560 (0%)  
[  5]  17.00-18.00  sec   114 MBytes   956 Mbits/sec  0.017 ms  0/82560 (0%)  
[  5]  18.00-19.00  sec   114 MBytes   956 Mbits/sec  0.010 ms  0/82560 (0%)  
[  5]  19.00-20.00  sec   114 MBytes   956 Mbits/sec  0.017 ms  0/82560 (0%)  
[  5]  20.00-21.00  sec   114 MBytes   956 Mbits/sec  0.017 ms  0/82560 (0%)  
[  5]  21.00-22.00  sec   114 MBytes   956 Mbits/sec  0.008 ms  0/82560 (0%)  
[  5]  22.00-23.00  sec   114 MBytes   956 Mbits/sec  0.024 ms  0/82560 (0%)  
[  5]  23.00-24.00  sec   114 MBytes   956 Mbits/sec  0.014 ms  0/82560 (0%)  
[  5]  24.00-25.00  sec   114 MBytes   956 Mbits/sec  0.016 ms  0/82560 (0%)  
[  5]  25.00-26.00  sec   114 MBytes   956 Mbits/sec  0.011 ms  0/82560 (0%)  
[  5]  26.00-27.00  sec   114 MBytes   956 Mbits/sec  0.011 ms  0/82560 (0%)  
[  5]  27.00-28.00  sec   114 MBytes   956 Mbits/sec  0.009 ms  0/82560 (0%)  
[  5]  28.00-29.00  sec   114 MBytes   956 Mbits/sec  0.014 ms  0/82560 (0%)  
[  5]  29.00-30.00  sec   114 MBytes   956 Mbits/sec  0.028 ms  0/82560 (0%)  
[  5]  30.00-31.00  sec   114 MBytes   956 Mbits/sec  0.011 ms  0/82560 (0%)  
[  5]  31.00-32.00  sec   114 MBytes   956 Mbits/sec  0.016 ms  0/82545 (0%)  
[  5]  32.00-33.00  sec   114 MBytes   957 Mbits/sec  0.008 ms  0/82575 (0%)  
[  5]  33.00-34.00  sec   114 MBytes   956 Mbits/sec  0.020 ms  0/82555 (0%)  
[  5]  34.00-35.00  sec   114 MBytes   956 Mbits/sec  0.021 ms  0/82557 (0%)  
[  5]  35.00-36.00  sec   114 MBytes   956 Mbits/sec  0.016 ms  0/82558 (0%)  
[  5]  36.00-37.00  sec   114 MBytes   956 Mbits/sec  0.025 ms  0/82557 (0%)  
[  5]  37.00-38.00  sec   114 MBytes   956 Mbits/sec  0.018 ms  0/82561 (0%)  
[  5]  38.00-39.00  sec   114 MBytes   956 Mbits/sec  0.007 ms  0/82557 (0%)  
[  5]  39.00-40.00  sec   114 MBytes   956 Mbits/sec  0.013 ms  0/82567 (0%)  
[  5]  40.00-41.00  sec   114 MBytes   956 Mbits/sec  0.022 ms  0/82555 (0%)  
[  5]  41.00-42.00  sec   114 MBytes   956 Mbits/sec  0.019 ms  0/82560 (0%)  
[  5]  42.00-43.00  sec   114 MBytes   956 Mbits/sec  0.025 ms  0/82558 (0%)  
[  5]  43.00-44.00  sec   114 MBytes   956 Mbits/sec  0.058 ms  0/82560 (0%)  
[  5]  44.00-45.00  sec   114 MBytes   956 Mbits/sec  0.009 ms  0/82559 (0%)  
[  5]  45.00-46.00  sec   114 MBytes   956 Mbits/sec  0.009 ms  0/82560 (0%)  
[  5]  46.00-47.00  sec   114 MBytes   956 Mbits/sec  0.027 ms  0/82560 (0%)  
[  5]  47.00-48.00  sec   114 MBytes   956 Mbits/sec  0.014 ms  0/82561 (0%)  
[  5]  48.00-49.00  sec   114 MBytes   956 Mbits/sec  0.021 ms  0/82566 (0%)  
[  5]  49.00-50.00  sec   114 MBytes   956 Mbits/sec  0.021 ms  0/82554 (0%)  
[  5]  49.00-50.00  sec   114 MBytes   956 Mbits/sec  0.021 ms  0/82554 (0%)  
- - - - - - - - - - - - - - - - - - - - - - - - -
[ ID] Interval           Transfer     Bitrate         Jitter    Lost/Total Datagrams
[  5]   0.00-50.00  sec  5.64 GBytes   969 Mbits/sec  0.010 ms  0/4182865 (0%)  receiver
iperf3: the client has terminated
-----------------------------------------------------------
Server listening on 5201 (test #5)
-----------------------------------------------------------
^Ciperf3: interrupt - the server has terminated
(base) kim@kim-System-Product-Name:~$ ^C
(base) kim@kim-System-Product-Name:~$ ^C
(base) kim@kim-System-Product-Name:~$ # TAS 상태에서 최대 UDP 포화(≈1Gbps) 60초
sudo ip netns exec ns1 iperf3 -c 169.254.59.100 -u -b 0 -t 60 -p 5201
# → 완료 후 자동 종료
Connecting to host 169.254.59.100, port 5201
[  5] local 169.254.59.170 port 54110 connected to 169.254.59.100 port 5201
[ ID] Interval           Transfer     Bitrate         Total Datagrams
[  5]   0.00-1.00   sec   114 MBytes   957 Mbits/sec  82674  
[  5]   1.00-2.00   sec   113 MBytes   947 Mbits/sec  81730  
[  5]   2.00-3.00   sec   113 MBytes   947 Mbits/sec  81737  
[  5]   3.00-4.00   sec   113 MBytes   946 Mbits/sec  81728  
[  5]   4.00-5.00   sec   113 MBytes   947 Mbits/sec  81712  
[  5]   5.00-6.00   sec   113 MBytes   947 Mbits/sec  81726  
[  5]   6.00-7.00   sec   113 MBytes   946 Mbits/sec  81690  
[  5]   7.00-8.00   sec   113 MBytes   950 Mbits/sec  82021  
[  5]   8.00-9.00   sec   114 MBytes   956 Mbits/sec  82578  
[  5]   9.00-10.00  sec   114 MBytes   957 Mbits/sec  82594  
[  5]  10.00-11.00  sec   114 MBytes   956 Mbits/sec  82547  
[  5]  11.00-12.00  sec   114 MBytes   953 Mbits/sec  82244  
[  5]  12.00-13.00  sec   113 MBytes   946 Mbits/sec  81687  
[  5]  13.00-14.00  sec   113 MBytes   947 Mbits/sec  81713  
[  5]  14.00-15.00  sec   113 MBytes   947 Mbits/sec  81744  
[  5]  15.00-16.00  sec   113 MBytes   947 Mbits/sec  81692  
[  5]  16.00-17.00  sec   113 MBytes   947 Mbits/sec  81749  
[  5]  17.00-18.00  sec   113 MBytes   946 Mbits/sec  81645  
[  5]  18.00-19.00  sec   114 MBytes   955 Mbits/sec  82417  
[  5]  19.00-20.00  sec   114 MBytes   956 Mbits/sec  82562  
[  5]  20.00-21.00  sec   114 MBytes   956 Mbits/sec  82532  
[  5]  21.00-22.00  sec   114 MBytes   956 Mbits/sec  82555  
[  5]  22.00-23.00  sec   113 MBytes   946 Mbits/sec  81674  
[  5]  23.00-24.00  sec   113 MBytes   947 Mbits/sec  81746  
[  5]  24.00-25.00  sec   113 MBytes   946 Mbits/sec  81682  
[  5]  25.00-26.00  sec   113 MBytes   947 Mbits/sec  81724  
[  5]  26.00-27.00  sec   113 MBytes   947 Mbits/sec  81720  
[  5]  27.00-28.00  sec   113 MBytes   946 Mbits/sec  81704  
[  5]  28.00-29.00  sec   113 MBytes   951 Mbits/sec  82123  
[  5]  29.00-30.00  sec   114 MBytes   956 Mbits/sec  82572  
[  5]  30.00-31.00  sec   114 MBytes   957 Mbits/sec  82625  
[  5]  31.00-32.00  sec   114 MBytes   956 Mbits/sec  82485  
[  5]  32.00-33.00  sec   114 MBytes   957 Mbits/sec  82578  
[  5]  33.00-34.00  sec   114 MBytes   956 Mbits/sec  82594  
[  5]  34.00-35.00  sec   114 MBytes   956 Mbits/sec  82516  
[  5]  35.00-36.00  sec   114 MBytes   956 Mbits/sec  82562  
[  5]  36.00-37.00  sec   114 MBytes   957 Mbits/sec  82610  
[  5]  37.00-38.00  sec   114 MBytes   957 Mbits/sec  82547  
[  5]  38.00-39.00  sec   114 MBytes   956 Mbits/sec  82531  
[  5]  39.00-40.00  sec   114 MBytes   957 Mbits/sec  82577  
[  5]  40.00-41.00  sec   114 MBytes   956 Mbits/sec  82579  
[  5]  41.00-42.00  sec   114 MBytes   956 Mbits/sec  82532  
[  5]  42.00-43.00  sec   114 MBytes   956 Mbits/sec  82532  
[  5]  43.00-44.00  sec   114 MBytes   957 Mbits/sec  82609  
[  5]  44.00-45.00  sec   114 MBytes   952 Mbits/sec  82204  
[  5]  45.00-46.00  sec   113 MBytes   946 Mbits/sec  81696  
[  5]  46.00-47.00  sec   113 MBytes   947 Mbits/sec  81696  
[  5]  47.00-48.00  sec   113 MBytes   946 Mbits/sec  81702  
[  5]  48.00-49.00  sec   113 MBytes   947 Mbits/sec  81734  
[  5]  49.00-50.00  sec   113 MBytes   947 Mbits/sec  81720  
[  5]  50.00-51.00  sec   113 MBytes   946 Mbits/sec  81727  
[  5]  51.00-52.00  sec   114 MBytes   955 Mbits/sec  82443  
[  5]  52.00-53.00  sec   114 MBytes   956 Mbits/sec  82563  
[  5]  53.00-54.00  sec   114 MBytes   956 Mbits/sec  82547  
[  5]  54.00-55.00  sec   114 MBytes   957 Mbits/sec  82578  
[  5]  55.00-56.00  sec   114 MBytes   956 Mbits/sec  82547  
[  5]  56.00-57.00  sec   114 MBytes   957 Mbits/sec  82577  
[  5]  57.00-58.00  sec   114 MBytes   956 Mbits/sec  82564  
[  5]  58.00-59.00  sec   114 MBytes   957 Mbits/sec  82547  
[  5]  59.00-60.00  sec   114 MBytes   956 Mbits/sec  82563  
- - - - - - - - - - - - - - - - - - - - - - - - -
[ ID] Interval           Transfer     Bitrate         Jitter    Lost/Total Datagrams
[  5]   0.00-60.00  sec  6.65 GBytes   952 Mbits/sec  0.000 ms  0/4931507 (0%)  sender
[  5]   0.00-60.00  sec  6.65 GBytes   952 Mbits/sec  0.015 ms  0/4931436 (0%)  receiver

iperf Done.
(base) kim@kim-System-Product-Name:~$ sudo ip netns exec ns1 iperf3 -c 169.254.59.100 -u -b 0 -t 60 -p 5201
Connecting to host 169.254.59.100, port 5201
[  5] local 169.254.59.170 port 54897 connected to 169.254.59.100 port 5201
[ ID] Interval           Transfer     Bitrate         Total Datagrams
[  5]   0.00-1.00   sec   114 MBytes   957 Mbits/sec  82624  
[  5]   1.00-2.00   sec   114 MBytes   957 Mbits/sec  82578  
[  5]   2.00-3.00   sec   114 MBytes   956 Mbits/sec  82516  
[  5]   3.00-4.00   sec   114 MBytes   957 Mbits/sec  82594  
[  5]   4.00-5.00   sec   114 MBytes   956 Mbits/sec  82492  
[  5]   5.00-6.00   sec   113 MBytes   947 Mbits/sec  81729  
[  5]   6.00-7.00   sec   113 MBytes   946 Mbits/sec  81699  
[  5]   7.00-8.00   sec   113 MBytes   946 Mbits/sec  81673  
[  5]   8.00-9.00   sec   113 MBytes   947 Mbits/sec  81734  
[  5]   9.00-10.00  sec   113 MBytes   946 Mbits/sec  81661  
[  5]  10.00-11.00  sec   113 MBytes   947 Mbits/sec  81719  
[  5]  11.00-12.00  sec   114 MBytes   952 Mbits/sec  82215  
[  5]  12.00-13.00  sec   114 MBytes   957 Mbits/sec  82578  
[  5]  13.00-14.00  sec   114 MBytes   956 Mbits/sec  82547  
[  5]  14.00-15.00  sec   114 MBytes   956 Mbits/sec  82547  
[  5]  15.00-16.00  sec   114 MBytes   956 Mbits/sec  82533  
[  5]  16.00-17.00  sec   114 MBytes   957 Mbits/sec  82608  
[  5]  17.00-18.00  sec   114 MBytes   956 Mbits/sec  82563  
[  5]  18.00-19.00  sec   114 MBytes   956 Mbits/sec  82531  
[  5]  19.00-20.00  sec   114 MBytes   956 Mbits/sec  82563  
[  5]  20.00-21.00  sec   114 MBytes   957 Mbits/sec  82578  
[  5]  21.00-22.00  sec   114 MBytes   956 Mbits/sec  82563  
[  5]  22.00-23.00  sec   114 MBytes   956 Mbits/sec  82547  
[  5]  23.00-24.00  sec   114 MBytes   956 Mbits/sec  82547  
[  5]  24.00-25.00  sec   114 MBytes   957 Mbits/sec  82578  
[  5]  25.00-26.00  sec   114 MBytes   956 Mbits/sec  82563  
[  5]  26.00-27.00  sec   112 MBytes   941 Mbits/sec  81221  
[  5]  27.00-28.00  sec   114 MBytes   956 Mbits/sec  82563  
[  5]  28.00-29.00  sec   114 MBytes   956 Mbits/sec  82567  
[  5]  29.00-30.00  sec   114 MBytes   956 Mbits/sec  82558  
[  5]  30.00-31.00  sec   114 MBytes   957 Mbits/sec  82579  
[  5]  31.00-32.00  sec   114 MBytes   956 Mbits/sec  82531  
[  5]  32.00-33.00  sec   114 MBytes   956 Mbits/sec  82563  
[  5]  33.00-34.00  sec   114 MBytes   957 Mbits/sec  82594  
[  5]  34.00-35.00  sec   114 MBytes   957 Mbits/sec  82547  
[  5]  35.00-36.00  sec   114 MBytes   956 Mbits/sec  82547  
[  5]  36.00-37.00  sec   114 MBytes   956 Mbits/sec  82547  
[  5]  37.00-38.00  sec   114 MBytes   956 Mbits/sec  82562  
[  5]  38.00-39.00  sec   114 MBytes   956 Mbits/sec  82561  
[  5]  39.00-40.00  sec   114 MBytes   956 Mbits/sec  82562  
[  5]  40.00-41.00  sec   114 MBytes   956 Mbits/sec  82581  
[  5]  41.00-42.00  sec   114 MBytes   956 Mbits/sec  82625  
[  5]  42.00-43.00  sec   114 MBytes   956 Mbits/sec  82485  
[  5]  43.00-44.00  sec   114 MBytes   956 Mbits/sec  82625  
[  5]  44.00-45.00  sec   114 MBytes   956 Mbits/sec  82547  
[  5]  45.00-46.00  sec   114 MBytes   957 Mbits/sec  82516  
[  5]  46.00-47.00  sec   114 MBytes   956 Mbits/sec  82625  
[  5]  46.00-47.00  sec   114 MBytes   956 Mbits/sec  82625  
- - - - - - - - - - - - - - - - - - - - - - - - -
[ ID] Interval           Transfer     Bitrate         Jitter    Lost/Total Datagrams
[  5]   0.00-47.00  sec  5.29 GBytes   967 Mbits/sec  0.000 ms  0/3921833 (0%)  sender
[  5]   0.00-47.00  sec  0.00 Bytes  0.00 bits/sec  0.000 ms  0/0 (0%)  receiver
iperf3: error - the server has terminated
(base) kim@kim-System-Product-Name:~$ ^C
(base) kim@kim-System-Product-Name:~$ # No‑TAS 지연 기록용
sudo ip netns exec ns2 python3 receiver.py latencies_load_no.csv
# → 이 창은 Ctrl‑C 전까지 유지
^CTraceback (most recent call last):
  File "/home/kim/receiver.py", line 14, in <module>
    data,addr = sock.recvfrom(8)
                ^^^^^^^^^^^^^^^^
KeyboardInterrupt

(base) kim@kim-System-Product-Name:~$ ^C
(base) kim@kim-System-Product-Name:~$ sudo ip netns exec ns2 python3 receiver.py latencies_prio.csv
# → 이 창은 Ctrl‑C 전까지 유지
^CTraceback (most recent call last):
  File "/home/kim/receiver.py", line 14, in <module>
    data,addr = sock.recvfrom(8)
                ^^^^^^^^^^^^^^^^
KeyboardInterrupt

(base) kim@kim-System-Product-Name:~$ sudo ip netns exec ns2 python3 receiver.py latencies_prio.csv
^CTraceback (most recent call last):
  File "/home/kim/receiver.py", line 14, in <module>
    data,addr = sock.recvfrom(8)
                ^^^^^^^^^^^^^^^^
KeyboardInterrupt

(base) kim@kim-System-Product-Name:~$ 
(base) kim@kim-System-Product-Name:~$ sudo ip netns exec ns1 python3 sender.py 10 20000 169.254.59.100
# → 10µs 간격으로 20000개 전송
[sudo] password for kim: 
(base) kim@kim-System-Product-Name:~$ # No‑TAS 모드에서도 Payload‑TS 리시버는 latencies_no_tas.csv에 기록
sudo ip netns exec ns2 python3 receiver.py latencies_no_tas.csv
# → Ctrl‑C 하지 마세요
^CTraceback (most recent call last):
  File "/home/kim/receiver.py", line 14, in <module>
    data,addr = sock.recvfrom(8)
                ^^^^^^^^^^^^^^^^
KeyboardInterrupt

(base) kim@kim-System-Product-Name:~$ # 최대 대역폭(무제한) UDP 스트림을 60초간 전송
sudo ip netns exec ns1 iperf3 -c 169.254.59.100 -u -b 0 -t 60 -p 5201
[sudo] password for kim: 
Connecting to host 169.254.59.100, port 5201
[  5] local 169.254.59.170 port 47053 connected to 169.254.59.100 port 5201
[ ID] Interval           Transfer     Bitrate         Total Datagrams
[  5]   0.00-1.00   sec   114 MBytes   956 Mbits/sec  82560  
[  5]   1.00-2.00   sec   114 MBytes   957 Mbits/sec  82578  
[  5]   2.00-3.00   sec   114 MBytes   957 Mbits/sec  82594  
[  5]   3.00-4.00   sec   114 MBytes   956 Mbits/sec  82547  
[  5]   4.00-5.00   sec   114 MBytes   956 Mbits/sec  82546  
[  5]   5.00-6.00   sec   114 MBytes   956 Mbits/sec  82564  
[  5]   6.00-7.00   sec   114 MBytes   956 Mbits/sec  82547  
[  5]   7.00-8.00   sec   114 MBytes   956 Mbits/sec  82638  
[  5]   8.00-9.00   sec   114 MBytes   956 Mbits/sec  82487  
[  5]   9.00-10.00  sec   114 MBytes   956 Mbits/sec  82547  
[  5]  10.00-11.00  sec   114 MBytes   957 Mbits/sec  82594  
[  5]  11.00-12.00  sec   114 MBytes   956 Mbits/sec  82547  
[  5]  12.00-13.00  sec   114 MBytes   956 Mbits/sec  82547  
[  5]  13.00-14.00  sec   114 MBytes   956 Mbits/sec  82563  
[  5]  14.00-15.00  sec   114 MBytes   957 Mbits/sec  82656  
[  5]  15.00-16.00  sec   114 MBytes   956 Mbits/sec  82469  
[  5]  16.00-17.00  sec   114 MBytes   956 Mbits/sec  82547  
[  5]  17.00-18.00  sec   114 MBytes   956 Mbits/sec  82563  
[  5]  18.00-19.00  sec   114 MBytes   956 Mbits/sec  82547  
[  5]  19.00-20.00  sec   114 MBytes   957 Mbits/sec  82672  
[  5]  20.00-21.00  sec   114 MBytes   956 Mbits/sec  82547  
[  5]  21.00-22.00  sec   114 MBytes   956 Mbits/sec  82495  
[  5]  22.00-23.00  sec   114 MBytes   956 Mbits/sec  82618  
[  5]  23.00-24.00  sec   114 MBytes   956 Mbits/sec  82466  
[  5]  24.00-25.00  sec   114 MBytes   957 Mbits/sec  82578  
[  5]  25.00-26.00  sec   114 MBytes   957 Mbits/sec  82578  
[  5]  26.00-27.00  sec   114 MBytes   956 Mbits/sec  82563  
[  5]  27.00-28.00  sec   114 MBytes   956 Mbits/sec  82547  
[  5]  28.00-29.00  sec   114 MBytes   957 Mbits/sec  82578  
[  5]  29.00-30.00  sec   114 MBytes   956 Mbits/sec  82516  
[  5]  30.00-31.00  sec   114 MBytes   957 Mbits/sec  82672  
[  5]  31.00-32.00  sec   114 MBytes   956 Mbits/sec  82438  
[  5]  32.00-33.00  sec   114 MBytes   957 Mbits/sec  82672  
[  5]  33.00-34.00  sec   114 MBytes   956 Mbits/sec  82547  
[  5]  34.00-35.00  sec   114 MBytes   956 Mbits/sec  82560  
[  5]  35.00-36.00  sec   114 MBytes   956 Mbits/sec  82565  
[  5]  36.00-37.00  sec   114 MBytes   956 Mbits/sec  82547  
[  5]  37.00-38.00  sec   114 MBytes   957 Mbits/sec  82516  
[  5]  38.00-39.00  sec   114 MBytes   956 Mbits/sec  82594  
[  5]  39.00-40.00  sec   114 MBytes   957 Mbits/sec  82516  
[  5]  40.00-41.00  sec   114 MBytes   956 Mbits/sec  82547  
[  5]  41.00-42.00  sec   114 MBytes   956 Mbits/sec  82562  
[  5]  42.00-43.00  sec   114 MBytes   957 Mbits/sec  82579  
[  5]  43.00-44.00  sec   114 MBytes   956 Mbits/sec  82531  
[  5]  44.00-45.00  sec   114 MBytes   957 Mbits/sec  82594  
[  5]  45.00-46.00  sec   114 MBytes   956 Mbits/sec  82547  
[  5]  46.00-47.00  sec   114 MBytes   956 Mbits/sec  82547  
[  5]  47.00-48.00  sec   114 MBytes   957 Mbits/sec  82623  
[  5]  48.00-49.00  sec   114 MBytes   956 Mbits/sec  82487  
[  5]  49.00-50.00  sec   114 MBytes   957 Mbits/sec  82578  
[  5]  50.00-51.00  sec   114 MBytes   956 Mbits/sec  82547  
[  5]  51.00-52.00  sec   114 MBytes   956 Mbits/sec  82563  
[  5]  52.00-53.00  sec   114 MBytes   956 Mbits/sec  82560  
[  5]  53.00-54.00  sec   114 MBytes   956 Mbits/sec  82565  
[  5]  54.00-55.00  sec   114 MBytes   956 Mbits/sec  82532  
[  5]  55.00-56.00  sec   114 MBytes   957 Mbits/sec  82609  
[  5]  56.00-57.00  sec   114 MBytes   956 Mbits/sec  82547  
[  5]  57.00-58.00  sec   114 MBytes   956 Mbits/sec  82563  
[  5]  58.00-59.00  sec   114 MBytes   956 Mbits/sec  82547  
[  5]  59.00-60.00  sec   114 MBytes   956 Mbits/sec  82594  
- - - - - - - - - - - - - - - - - - - - - - - - -
[ ID] Interval           Transfer     Bitrate         Jitter    Lost/Total Datagrams
[  5]   0.00-60.00  sec  6.68 GBytes   956 Mbits/sec  0.000 ms  0/4953648 (0%)  sender
[  5]   0.00-60.00  sec  6.68 GBytes   956 Mbits/sec  0.013 ms  0/4953636 (0%)  receiver

iperf Done.
(base) kim@kim-System-Product-Name:~$ sudo ip netns exec ns2 python3 receiver.py latencies_load.csv


# 10µs cycle(5µs/5µs) 기준; 일단 고정 적용
BT=$(( $(date +%s%N) + 3_000_000_000 ))
sudo ip netns exec ns1 tc qdisc replace dev enp7s0 root handle 100: taprio \
  clockid CLOCK_TAI num_tc 1 \
  map 0 0 0 0 0 0 0 0 queues 1@0 \
  base-time $BT \
  sched-entry S 01 5000 sched-entry S 00 5000 \
  flags 0x1
echo "✔ TAS 적용 완료 (10µs cycle)"
^CTraceback (most recent call last):
  File "/home/kim/receiver.py", line 14, in <module>
    data,addr = sock.recvfrom(8)
                ^^^^^^^^^^^^^^^^
KeyboardInterrupt

(base) kim@kim-System-Product-Name:~$ ^C
(base) kim@kim-System-Product-Name:~$ ^C
(base) kim@kim-System-Product-Name:~$ ^C
(base) kim@kim-System-Product-Name:~$ ^C
(base) kim@kim-System-Product-Name:~$ ^C
(base) kim@kim-System-Product-Name:~$ ^C
(base) kim@kim-System-Product-Name:~$ ^C
(base) kim@kim-System-Product-Name:~$ ^C
(base) kim@kim-System-Product-Name:~$ # 10µs cycle(5µs/5µs) 기준; 일단 고정 적용
BT=$(( $(date +%s%N) + 3_000_000_000 ))
sudo ip netns exec ns1 tc qdisc replace dev enp7s0 root handle 100: taprio \
  clockid CLOCK_TAI num_tc 1 \
  map 0 0 0 0 0 0 0 0 queues 1@0 \
  base-time $BT \
  sched-entry S 01 5000 sched-entry S 00 5000 \
  flags 0x1
echo "✔ TAS 적용 완료 (10µs cycle)"
bash: 1753750650670010445 + 3_000_000_000: value too great for base (error token is "3_000_000_000")
Error: There should be at least one entry in the schedule.
✔ TAS 적용 완료 (10µs cycle)
(base) kim@kim-System-Product-Name:~$ ^C
(base) kim@kim-System-Product-Name:~$ # TAS 스케줄 삭제 → 기본 FIFO 모드
sudo ip netns exec ns1 tc qdisc del dev enp7s0 root

# 새로운 수신기 실행 (다른 파일명)
sudo ip netns exec ns2 python3 receiver.py latencies_load_no.csv
# → latencies_load_no.csv 에 기록 (Ctrl‑C 하지 마세요)
Traceback (most recent call last):
  File "/home/kim/receiver.py", line 9, in <module>
    sock.bind(("0.0.0.0", port))
OSError: [Errno 98] Address already in use
(base) kim@kim-System-Product-Name:~$ # TAS 스케줄 삭제 → 기본 FIFO 모드
sudo ip netns exec ns1 tc qdisc del dev enp7s0 root

# 새로운 수신기 실행 (다른 파일명)
sudo ip netns exec ns2 python3 receiver.py latencies_load_no.csv
# → latencies_load_no.csv 에 기록 (Ctrl‑C 하지 마세요)
Error: Cannot delete qdisc with handle of zero.
^CTraceback (most recent call last):
  File "/home/kim/receiver.py", line 14, in <module>
    data,addr = sock.recvfrom(8)
                ^^^^^^^^^^^^^^^^
KeyboardInterrupt

(base) kim@kim-System-Product-Name:~$ # TAS 상태에서 동시에 10µs 간격으로 100 000개 전송
sudo ip netns exec ns1 python3 sender.py 10 100000 169.254.59.100
# → 완료 후 자동 종료
(base) kim@kim-System-Product-Name:~$ sudo ip netns exec ns1 python3 sender.py 10 100000 169.254.59.100
(base) kim@kim-System-Product-Name:~$ sudo ip netns exec ns1 python3 sender.py 10 100000 169.254.59.100
(base) kim@kim-System-Product-Name:~$ sudo ip netns exec ns1 python3 sender.py 10 100000 169.254.59.100
(base) kim@kim-System-Product-Name:~$ sudo ip netns exec ns1 python3 sender.py 10 100000 169.254.59.100
(base) kim@kim-System-Product-Name:~$ # 60초간 최대 UDP 포화 스트림
sudo ip netns exec ns1 iperf3 -c 169.254.59.100 -u -b 0 -t 60 -p 5201
Connecting to host 169.254.59.100, port 5201
[  5] local 169.254.59.170 port 49724 connected to 169.254.59.100 port 5201
[ ID] Interval           Transfer     Bitrate         Total Datagrams
[  5]   0.00-1.00   sec   114 MBytes   957 Mbits/sec  82704  
[  5]   1.00-2.00   sec   114 MBytes   956 Mbits/sec  82562  
[  5]   2.00-3.00   sec   114 MBytes   956 Mbits/sec  82532  
[  5]   3.00-4.00   sec   113 MBytes   947 Mbits/sec  81789  
[  5]   4.00-5.00   sec   113 MBytes   946 Mbits/sec  81681  
[  5]   5.00-6.00   sec   113 MBytes   947 Mbits/sec  81712  
[  5]   6.00-7.00   sec   113 MBytes   946 Mbits/sec  81675  
[  5]   7.00-8.00   sec   113 MBytes   947 Mbits/sec  81720  
[  5]   8.00-9.00   sec   113 MBytes   946 Mbits/sec  81680  
[  5]   9.00-10.00  sec   113 MBytes   951 Mbits/sec  82133  
[  5]  10.00-11.00  sec   114 MBytes   956 Mbits/sec  82572  
[  5]  11.00-12.00  sec   114 MBytes   956 Mbits/sec  82538  
[  5]  12.00-13.00  sec   114 MBytes   957 Mbits/sec  82578  
[  5]  13.00-14.00  sec   114 MBytes   956 Mbits/sec  82547  
[  5]  14.00-15.00  sec   114 MBytes   956 Mbits/sec  82547  
[  5]  15.00-16.00  sec   114 MBytes   954 Mbits/sec  82507  
[  5]  16.00-17.00  sec   114 MBytes   954 Mbits/sec  82201  
[  5]  17.00-18.00  sec   114 MBytes   957 Mbits/sec  82578  
[  5]  18.00-19.00  sec   114 MBytes   956 Mbits/sec  82532  
[  5]  19.00-20.00  sec   114 MBytes   956 Mbits/sec  82561  
[  5]  20.00-21.00  sec   114 MBytes   956 Mbits/sec  82564  
[  5]  21.00-22.00  sec   114 MBytes   957 Mbits/sec  82594  
[  5]  22.00-23.00  sec   114 MBytes   956 Mbits/sec  82531  
[  5]  23.00-24.00  sec   114 MBytes   956 Mbits/sec  82532  
[  5]  24.00-25.00  sec   114 MBytes   957 Mbits/sec  82594  
[  5]  25.00-26.00  sec   114 MBytes   956 Mbits/sec  82562  
[  5]  26.00-27.00  sec   114 MBytes   956 Mbits/sec  82563  
[  5]  27.00-28.00  sec   114 MBytes   956 Mbits/sec  82547  
[  5]  28.00-29.00  sec   114 MBytes   956 Mbits/sec  82561  
[  5]  29.00-30.00  sec   114 MBytes   957 Mbits/sec  82580  
[  5]  30.00-31.00  sec   114 MBytes   956 Mbits/sec  82563  
[  5]  31.00-32.00  sec   114 MBytes   956 Mbits/sec  82531  
[  5]  32.00-33.00  sec   114 MBytes   957 Mbits/sec  82594  
[  5]  33.00-34.00  sec   114 MBytes   956 Mbits/sec  82563  
[  5]  34.00-35.00  sec   114 MBytes   956 Mbits/sec  82528  
[  5]  35.00-36.00  sec   114 MBytes   956 Mbits/sec  82550  
[  5]  36.00-37.00  sec   114 MBytes   956 Mbits/sec  82563  
[  5]  37.00-38.00  sec   114 MBytes   957 Mbits/sec  82578  
[  5]  38.00-39.00  sec   114 MBytes   956 Mbits/sec  82547  
[  5]  39.00-40.00  sec   114 MBytes   956 Mbits/sec  82563  
[  5]  40.00-41.00  sec   114 MBytes   957 Mbits/sec  82578  
[  5]  41.00-42.00  sec   114 MBytes   956 Mbits/sec  82547  
[  5]  42.00-43.00  sec   114 MBytes   956 Mbits/sec  82563  
[  5]  43.00-44.00  sec   114 MBytes   956 Mbits/sec  82530  
[  5]  44.00-45.00  sec   114 MBytes   957 Mbits/sec  82599  
[  5]  45.00-46.00  sec   114 MBytes   956 Mbits/sec  82512  
[  5]  46.00-47.00  sec   114 MBytes   957 Mbits/sec  82594  
[  5]  47.00-48.00  sec   114 MBytes   956 Mbits/sec  82547  
[  5]  48.00-49.00  sec   114 MBytes   956 Mbits/sec  82563  
[  5]  49.00-50.00  sec   114 MBytes   957 Mbits/sec  82578  
[  5]  50.00-51.00  sec   114 MBytes   956 Mbits/sec  82547  
[  5]  51.00-52.00  sec   114 MBytes   956 Mbits/sec  82563  
[  5]  52.00-53.00  sec   114 MBytes   957 Mbits/sec  82578  
[  5]  53.00-54.00  sec   114 MBytes   956 Mbits/sec  82547  
[  5]  54.00-55.00  sec   114 MBytes   956 Mbits/sec  82530  
[  5]  55.00-56.00  sec   114 MBytes   957 Mbits/sec  82595  
[  5]  56.00-57.00  sec   114 MBytes   956 Mbits/sec  82547  
[  5]  57.00-58.00  sec   114 MBytes   956 Mbits/sec  82563  
[  5]  58.00-59.00  sec   114 MBytes   957 Mbits/sec  82578  
[  5]  59.00-60.00  sec   114 MBytes   956 Mbits/sec  82547  
- - - - - - - - - - - - - - - - - - - - - - - - -
[ ID] Interval           Transfer     Bitrate         Jitter    Lost/Total Datagrams
[  5]   0.00-60.00  sec  6.67 GBytes   955 Mbits/sec  0.000 ms  0/4947763 (0%)  sender
[  5]   0.00-60.00  sec  6.67 GBytes   955 Mbits/sec  0.034 ms  2755/4947720 (0.056%)  receiver

iperf Done.
(base) kim@kim-System-Product-Name:~$ ^C
(base) kim@kim-System-Product-Name:~$ sudo ip netns exec ns1 python3 sender.py 10 20000 10.0.0.2
# → 완료되면 자동 종료
(base) kim@kim-System-Product-Name:~$ sudo ip netns exec ns1 python3 sender.py 10 100000 10.0.0.2
(base) kim@kim-System-Product-Name:~$ 
(base) kim@kim-System-Product-Name:~$ sudo bash toggle_tas.sh 3 10
# → 10µs ↔ 2µs 스케줄을 3회 반복, 각 10초 유지
#   끝나면 자동 종료됩니다.
[sudo] password for kim: 
[17:46:52] Iter 1 – TAS 10µs
Warning: sch_taprio: Size table not specified, frame length estimations may be inaccurate.
[17:47:02] Iter 1 – TAS 2µs
Warning: sch_taprio: Size table not specified, frame length estimations may be inaccurate.
[17:47:12] Iter 2 – TAS 10µs
Warning: sch_taprio: Size table not specified, frame length estimations may be inaccurate.
[17:47:22] Iter 2 – TAS 2µs
Warning: sch_taprio: Size table not specified, frame length estimations may be inaccurate.
[17:47:32] Iter 3 – TAS 10µs
Warning: sch_taprio: Size table not specified, frame length estimations may be inaccurate.
[17:47:42] Iter 3 – TAS 2µs
Warning: sch_taprio: Size table not specified, frame length estimations may be inaccurate.
toggle done
(base) kim@kim-System-Product-Name:~$ python3 analysis/plot_latency.py latencies.csv
python3: can't open file '/home/kim/analysis/plot_latency.py': [Errno 2] No such file or directory
(base) kim@kim-System-Product-Name:~$ sudo ip netns exec ns1 python3 sender.py 10 20000 169.254.59.100
(base) kim@kim-System-Product-Name:~$ sudo ip netns exec ns1 iperf3 -c 169.254.59.100 -u -b 0 -t 60 -p 5201
[sudo] password for kim: 
Connecting to host 169.254.59.100, port 5201
[  5] local 169.254.59.170 port 50729 connected to 169.254.59.100 port 5201
[ ID] Interval           Transfer     Bitrate         Total Datagrams
[  5]   0.00-1.00   sec  1.70 GBytes  14.6 Gbits/sec  1257404  
[  5]   1.00-2.00   sec  1.71 GBytes  14.7 Gbits/sec  1270068  
[  5]   2.00-3.00   sec  1.71 GBytes  14.7 Gbits/sec  1264896  
[  5]   3.00-4.00   sec  1.72 GBytes  14.8 Gbits/sec  1274638  
[  5]   4.00-5.00   sec  1.72 GBytes  14.8 Gbits/sec  1277576  
[  5]   5.00-6.00   sec  1.72 GBytes  14.8 Gbits/sec  1277554  
[  5]   6.00-7.00   sec  1.70 GBytes  14.6 Gbits/sec  1262553  
[  5]   7.00-8.00   sec  1.70 GBytes  14.6 Gbits/sec  1263936  
[  5]   8.00-9.00   sec  1.66 GBytes  14.3 Gbits/sec  1232483  
[  5]   9.00-10.00  sec  1.68 GBytes  14.4 Gbits/sec  1243044  
[  5]  10.00-11.00  sec  1.66 GBytes  14.3 Gbits/sec  1234308  
[  5]  11.00-12.00  sec  1.65 GBytes  14.2 Gbits/sec  1222496  
[  5]  12.00-13.00  sec  1.65 GBytes  14.2 Gbits/sec  1224259  
[  5]  13.00-14.00  sec  1.57 GBytes  13.5 Gbits/sec  1163373  
[  5]  14.00-15.00  sec  1.61 GBytes  13.8 Gbits/sec  1190629  
[  5]  15.00-16.00  sec  1.66 GBytes  14.3 Gbits/sec  1230802  
[  5]  16.00-17.00  sec  1.68 GBytes  14.4 Gbits/sec  1243923  
[  5]  17.00-18.00  sec  1.64 GBytes  14.1 Gbits/sec  1216179  
[  5]  18.00-19.00  sec  1.67 GBytes  14.3 Gbits/sec  1236192  
[  5]  19.00-20.00  sec  1.75 GBytes  15.0 Gbits/sec  1296234  
[  5]  20.00-21.00  sec  1.76 GBytes  15.1 Gbits/sec  1306679  
[  5]  21.00-22.00  sec  1.74 GBytes  14.9 Gbits/sec  1287188  
[  5]  22.00-23.00  sec  1.76 GBytes  15.1 Gbits/sec  1304595  
[  5]  23.00-24.00  sec  1.75 GBytes  15.0 Gbits/sec  1299202  
[  5]  24.00-25.00  sec  1.76 GBytes  15.1 Gbits/sec  1303628  
[  5]  25.00-26.00  sec  1.75 GBytes  15.1 Gbits/sec  1300519  
[  5]  26.00-27.00  sec  1.76 GBytes  15.1 Gbits/sec  1307832  
[  5]  27.00-28.00  sec  1.76 GBytes  15.1 Gbits/sec  1305306  
[  5]  28.00-29.00  sec  1.72 GBytes  14.8 Gbits/sec  1279133  
[  5]  29.00-30.00  sec  1.68 GBytes  14.5 Gbits/sec  1248023  
[  5]  30.00-31.00  sec  1.67 GBytes  14.3 Gbits/sec  1235566  
[  5]  31.00-32.00  sec  1.69 GBytes  14.6 Gbits/sec  1256434  
[  5]  32.00-33.00  sec  1.68 GBytes  14.4 Gbits/sec  1245499  
[  5]  33.00-34.00  sec  1.66 GBytes  14.2 Gbits/sec  1230110  
[  5]  34.00-35.00  sec  1.64 GBytes  14.1 Gbits/sec  1214721  
[  5]  35.00-36.00  sec  1.67 GBytes  14.3 Gbits/sec  1234829  
[  5]  36.00-37.00  sec  1.67 GBytes  14.3 Gbits/sec  1236093  
[  5]  37.00-38.00  sec  1.65 GBytes  14.2 Gbits/sec  1223681  
[  5]  38.00-39.00  sec  1.74 GBytes  14.9 Gbits/sec  1287419  
[  5]  39.00-40.00  sec  1.78 GBytes  15.3 Gbits/sec  1319649  
[  5]  40.00-41.00  sec  1.75 GBytes  15.0 Gbits/sec  1297176  
[  5]  41.00-42.00  sec  1.73 GBytes  14.9 Gbits/sec  1283573  
[  5]  42.00-43.00  sec  1.68 GBytes  14.5 Gbits/sec  1248489  
[  5]  43.00-44.00  sec  1.72 GBytes  14.8 Gbits/sec  1274998  
[  5]  44.00-45.00  sec  1.75 GBytes  15.0 Gbits/sec  1295827  
[  5]  45.00-46.00  sec  1.75 GBytes  15.0 Gbits/sec  1298775  
[  5]  46.00-47.00  sec  1.72 GBytes  14.8 Gbits/sec  1273403  
[  5]  47.00-48.00  sec  1.67 GBytes  14.4 Gbits/sec  1241501  
[  5]  48.00-49.00  sec  1.67 GBytes  14.3 Gbits/sec  1236769  
[  5]  49.00-50.00  sec  1.64 GBytes  14.1 Gbits/sec  1217092  
[  5]  50.00-51.00  sec  1.66 GBytes  14.3 Gbits/sec  1234219  
[  5]  51.00-52.00  sec  1.67 GBytes  14.3 Gbits/sec  1235557  
[  5]  52.00-53.00  sec  1.67 GBytes  14.3 Gbits/sec  1235248  
[  5]  53.00-54.00  sec  1.66 GBytes  14.3 Gbits/sec  1230857  
[  5]  54.00-55.00  sec  1.62 GBytes  13.9 Gbits/sec  1201490  
[  5]  55.00-56.00  sec  1.63 GBytes  14.0 Gbits/sec  1206831  
[  5]  56.00-57.00  sec  1.63 GBytes  14.0 Gbits/sec  1210556  
[  5]  57.00-58.00  sec  1.63 GBytes  14.0 Gbits/sec  1205541  
[  5]  58.00-59.00  sec  1.63 GBytes  14.0 Gbits/sec  1208531  
^C[  5]  60.00-62.94  sec  0.00 Bytes  0.00 bits/sec  0  
- - - - - - - - - - - - - - - - - - - - - - - - -
[ ID] Interval           Transfer     Bitrate         Jitter    Lost/Total Datagrams
[  5]   0.00-62.94  sec   101 GBytes  13.8 Gbits/sec  0.000 ms  0/75174140 (0%)  sender
[  5]   0.00-62.94  sec  0.00 Bytes  0.00 bits/sec  0.000 ms  0/0 (0%)  receiver
iperf3: interrupt - the client has terminated
(base) kim@kim-System-Product-Name:~$ sudo ip netns exec ns2 python3 receiver.py latencies_load_tas.csv
# → latencies_load_tas.csv 에 [tx_time_ns, latency_ns] 기록
#   (이 창은 Ctrl‑C 하지 마세요)
^CTraceback (most recent call last):
  File "/home/kim/receiver.py", line 14, in <module>
    data,addr = sock.recvfrom(8)
                ^^^^^^^^^^^^^^^^
KeyboardInterrupt

(base) kim@kim-System-Product-Name:~$ # TAS 없이 동일한 송신
sudo ip netns exec ns1 python3 sender.py 10 100000 169.254.59.100
(base) kim@kim-System-Product-Name:~$ ^C
(base) kim@kim-System-Product-Name:~$ sudo ip netns exec ns1 tc qdisc del dev enp7s0 root
Error: Cannot delete qdisc with handle of zero.
(base) kim@kim-System-Product-Name:~$ # 1) TAS qdisc를 기본 FIFO로 교체
sudo ip netns exec ns1 tc qdisc replace dev enp7s0 root pfifo_fast

# 2) 확인: qdisc 목록에 pfifo_fast이 보이면 성공
sudo ip netns exec ns1 tc qdisc show dev enp7s0
qdisc pfifo_fast 8001: root refcnt 9 bands 3 priomap 1 2 2 2 1 2 0 0 1 1 1 1 1 1 1 1
(base) kim@kim-System-Product-Name:~$ # 1) TAS qdisc를 기본 FIFO로 교체
sudo ip netns exec ns1 tc qdisc replace dev enp7s0 root pfifo_fast

# 2) 확인: qdisc 목록에 pfifo_fast이 보이면 성공
sudo ip netns exec ns1 tc qdisc show dev enp7s0
qdisc pfifo_fast 8001: root refcnt 9 bands 3 priomap 1 2 2 2 1 2 0 0 1 1 1 1 1 1 1 1
(base) kim@kim-System-Product-Name:~$ # 10µs 간격으로 100 000개 패킷 전송
sudo ip netns exec ns1 python3 sender.py 10 100000 169.254.59.100
# → 완료되면 자동 종료
(base) kim@kim-System-Product-Name:~$ ^C
(base) kim@kim-System-Product-Name:~$ 
(base) kim@kim-System-Product-Name:~$ sudo ip netns exec ns1 python3 sender.py 10 20000 169.254.59.100
[sudo] password for kim: 
(base) kim@kim-System-Product-Name:~$ sudo ip netns exec ns1 python3 sender.py 10 20000 169.254.59.100
(base) kim@kim-System-Product-Name:~$ sudo ip netns exec ns1 python3 sender.py 10 20000 169.254.59.100
(base) kim@kim-System-Product-Name:~$ sudo ip netns exec ns1 python3 sender.py 10 20000 169.254.59.100
(base) kim@kim-System-Product-Name:~$ sudo ip netns exec ns1 python3 sender.py 10 20000 169.254.59.100
(base) kim@kim-System-Product-Name:~$ sudo ip netns exec ns1 python3 sender.py 10 20000 169.254.59.100
(base) kim@kim-System-Product-Name:~$ sudo ip netns exec ns1 python3 sender.py 10 20000 169.254.59.100
(base) kim@kim-System-Product-Name:~$ # 먼저 cross‑traffic 시작 (Terminal 1에서 계속) 후,
# Payload‑TS 송신 시작 (패킷 수 늘림)
sudo ip netns exec ns1 python3 sender.py 10 100000 169.254.59.100
# → 10µs 간격, 100k개 패킷 전송
# 완료되면 자동 종료
(base) kim@kim-System-Product-Name:~$ ^C
(base) kim@kim-System-Product-Name:~$ ^C
(base) kim@kim-System-Product-Name:~$ 
(base) kim@kim-System-Product-Name:~$ sudo bash toggle_tas.sh 3 10
[sudo] password for kim: 
[09:53:06] Iter 1 – TAS 10µs
Warning: sch_taprio: Size table not specified, frame length estimations may be inaccurate.
[09:53:16] Iter 1 – TAS 2µs
Warning: sch_taprio: Size table not specified, frame length estimations may be inaccurate.
[09:53:26] Iter 2 – TAS 10µs
Warning: sch_taprio: Size table not specified, frame length estimations may be inaccurate.
[09:53:36] Iter 2 – TAS 2µs
Warning: sch_taprio: Size table not specified, frame length estimations may be inaccurate.
[09:53:46] Iter 3 – TAS 10µs
Warning: sch_taprio: Size table not specified, frame length estimations may be inaccurate.
[09:53:56] Iter 3 – TAS 2µs
Warning: sch_taprio: Size table not specified, frame length estimations may be inaccurate.
toggle done
(base) kim@kim-System-Product-Name:~$ #!/usr/bin/env python3
# plot_latency_compare.py <latencies_load.csv>

import pandas as pd, numpy as np
import matplotlib.pyplot as plt
from tabulate import tabulate
import os, sys

csv = sys.argv[1]
df = pd.read_csv(csv, header=0)

# TAS vs No‑TAS 구분 컬럼 추가 (sender.py/receiver.py에서 기록 시 'mode' 열이 있으면 사용)
# 여기서는 latencies_load.csv 하나만 있으므로, 실험 시 파일명을 달리 저장하거나 수동 레이블링 필요.

# 예시: 실험 전 TAS 모드로, 파일명 latencies_load_tas.csv 저장 → No‑TAS로 latencies_load_no.csv
# 간단히 두 파일을 비교하는 형태로 작성하세요.

# (생략: 두 DataFrame 불러와 describe→히스토그램 생성 등)
Command 'import' not found, but can be installed with:
sudo apt install graphicsmagick-imagemagick-compat  # version 1.4+really1.3.42-1, or
sudo apt install imagemagick-6.q16                  # version 8:6.9.11.60+dfsg-1.6ubuntu1
sudo apt install imagemagick-6.q16hdri              # version 8:6.9.11.60+dfsg-1.6ubuntu1
Command 'import' not found, but can be installed with:
sudo apt install graphicsmagick-imagemagick-compat  # version 1.4+really1.3.42-1, or
sudo apt install imagemagick-6.q16                  # version 8:6.9.11.60+dfsg-1.6ubuntu1
sudo apt install imagemagick-6.q16hdri              # version 8:6.9.11.60+dfsg-1.6ubuntu1
Command 'from' not found, but can be installed with:
sudo apt install mailutils
Command 'import' not found, but can be installed with:
sudo apt install graphicsmagick-imagemagick-compat  # version 1.4+really1.3.42-1, or
sudo apt install imagemagick-6.q16                  # version 8:6.9.11.60+dfsg-1.6ubuntu1
sudo apt install imagemagick-6.q16hdri              # version 8:6.9.11.60+dfsg-1.6ubuntu1
Command 'csv' not found, did you mean:
  command 'csc' from deb chicken-bin (5.3.0-1)
  command 'cst' from deb imx-code-signing-tool (3.3.2+dfsg-1)
  command 'cs' from deb csound (1:6.18.1+dfsg-1)
  command 'csr' from deb rheolef (7.2-3build3)
  command 'sv' from deb runit (2.1.2-54+usrmergeubuntu1)
  command 'csv2' from deb xml2 (0.5-4build1)
  command 'csi' from deb chicken-bin (5.3.0-1)
  command 'csh' from deb csh (20230828-1)
  command 'csh' from deb tcsh (6.24.10-3)
  command 'cvs' from deb cvs (2:1.12.13+real-30)
  command '2csv' from deb xml2 (0.5-4build1)
  command 'cpsv' from deb runit (2.1.2-54+usrmergeubuntu1)
Try: sudo apt install <deb name>
bash: syntax error near unexpected token `('
(base) kim@kim-System-Product-Name:~$ 
(base) kim@kim-System-Product-Name:~$ 
(base) kim@kim-System-Product-Name:~$ 
(base) kim@kim-System-Product-Name:~$ cat << 'EOF' > plot_latency_compare.py
#!/usr/bin/env python3
import pandas as pd, numpy as np
import matplotlib.pyplot as plt
from tabulate import tabulate
import os, sys

# 인자: latencies_load_tas.csv latencies_load_no.csv
tas_csv, notas_csv = sys.argv[1], sys.argv[2]

df_tas  = pd.read_csv(tas_csv,  header=0)
df_no   = pd.read_csv(notas_csv, header=0)

summary = []
for label, df in [("TAS", df_tas), ("No-TAS", df_no)]:
    lat = df["latency_ns"].astype(float)
    desc = lat.describe(percentiles=[.5, .95, .99])
    summary.append({
        "Mode":    label,
        "Count":   int(desc["count"]),
        "Mean(ns)":f"{desc['mean']:.1f}",
        "P50(ns)": int(desc["50%"]),
        "P95(ns)": int(desc["95%"]),
        "P99(ns)": int(desc["99%"]),
        "Max(ns)": int(desc["max"])
    })

print("\n## TAS vs No‑TAS under load\n")
print(tabulate(summary, headers="keys", tablefmt="github"))

# 히스토그램 저장
hist = os.path.expanduser("~/latency_load_compare.png")
bins = np.linspace(0,
                  max(df_tas["latency_ns"].max(), df_no["latency_ns"].max()),
                  200)
plt.figure(figsize=(6,4))
plt.hist(df_tas["latency_ns"], bins=bins, histtype="step", label="TAS")
plt.hist(df_no ["latency_ns"], bins=bins, histtype="step", label="No-TAS")
plt.title("Under Load: TAS vs No‑TAS")
plt.xlabel("latency (ns)")
plt.ylabel("count")
plt.legend(); plt.grid(True); plt.tight_layout()
plt.savefig(hist)
chmod +x plot_latency_compare.pyram: {hist}")
(base) kim@kim-System-Product-Name:~$ python3 plot_latency_compare.py latencies_load_tas.csv latencies_load_no.csv
Traceback (most recent call last):
  File "/home/kim/plot_latency_compare.py", line 10, in <module>
    df_tas  = pd.read_csv(tas_csv,  header=0)
  File "/home/kim/miniconda3/lib/python3.13/site-packages/pandas/io/parsers/readers.py", line 1026, in read_csv
    return _read(filepath_or_buffer, kwds)
  File "/home/kim/miniconda3/lib/python3.13/site-packages/pandas/io/parsers/readers.py", line 620, in _read
    parser = TextFileReader(filepath_or_buffer, **kwds)
  File "/home/kim/miniconda3/lib/python3.13/site-packages/pandas/io/parsers/readers.py", line 1620, in __init__
    self._engine = self._make_engine(f, self.engine)
                   ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^
  File "/home/kim/miniconda3/lib/python3.13/site-packages/pandas/io/parsers/readers.py", line 1880, in _make_engine
    self.handles = get_handle(
                   ~~~~~~~~~~^
        f,
        ^^
    ...<6 lines>...
        storage_options=self.options.get("storage_options", None),
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/kim/miniconda3/lib/python3.13/site-packages/pandas/io/common.py", line 873, in get_handle
    handle = open(
        handle,
    ...<3 lines>...
        newline="",
    )
FileNotFoundError: [Errno 2] No such file or directory: 'latencies_load_tas.csv'
(base) kim@kim-System-Product-Name:~$ sudo ip netns exec ns1 iperf3 -c 169.254.59.100 -u -b 0 -t 60 -p 5201
Connecting to host 169.254.59.100, port 5201
iperf3: error - unable to send control message - port may not be available, the other side may have stopped running, etc.: Broken pipe
(base) kim@kim-System-Product-Name:~$ python3 plot_latency_compare.py latencies_load_tas.csv latencies_load_no.csv

## TAS vs No‑TAS under load

| Mode   |   Count |   Mean(ns) |   P50(ns) |   P95(ns) |   P99(ns) |   Max(ns) |
|--------|---------|------------|-----------|-----------|-----------|-----------|
| TAS    |  100000 |    25865.9 |     22721 |     51215 |     67712 |    226587 |
| No-TAS |   99989 |    19117.9 |     18147 |     24536 |     48757 |    170242 |

✔ Saved compare histogram: /home/kim/latency_load_compare.png
(base) kim@kim-System-Product-Name:~$  sudo ip netns exec ns1 iperf3 -c 169.254.59.100 -u -b 0 -t 60 -p 5201
Connecting to host 169.254.59.100, port 5201
[  5] local 169.254.59.170 port 44367 connected to 169.254.59.100 port 5201
[ ID] Interval           Transfer     Bitrate         Total Datagrams
[  5]   0.00-1.00   sec   114 MBytes   956 Mbits/sec  82567  
[  5]   1.00-2.00   sec   114 MBytes   957 Mbits/sec  82628  
[  5]   2.00-3.00   sec   114 MBytes   956 Mbits/sec  82500  
[  5]   3.00-4.00   sec   114 MBytes   956 Mbits/sec  82609  
[  5]   4.00-5.00   sec   114 MBytes   957 Mbits/sec  82501  
[  5]   5.00-6.00   sec   114 MBytes   956 Mbits/sec  82625  
[  5]   6.00-7.00   sec   114 MBytes   957 Mbits/sec  82531  
[  5]   7.00-8.00   sec   114 MBytes   956 Mbits/sec  82625  
[  5]   8.00-9.00   sec   114 MBytes   956 Mbits/sec  82545  
[  5]   9.00-10.00  sec   114 MBytes   956 Mbits/sec  82534  
[  5]  10.00-11.00  sec   114 MBytes   957 Mbits/sec  82578  
[  5]  11.00-12.00  sec   114 MBytes   957 Mbits/sec  82578  
[  5]  12.00-13.00  sec   114 MBytes   956 Mbits/sec  82532  
[  5]  13.00-14.00  sec   114 MBytes   956 Mbits/sec  82547  
[  5]  14.00-15.00  sec   114 MBytes   956 Mbits/sec  82562  
[  5]  15.00-16.00  sec   114 MBytes   957 Mbits/sec  82579  
[  5]  16.00-17.00  sec   114 MBytes   957 Mbits/sec  82578  
[  5]  17.00-18.00  sec   114 MBytes   956 Mbits/sec  82517  
[  5]  18.00-19.00  sec   114 MBytes   957 Mbits/sec  82593  
[  5]  19.00-20.00  sec   114 MBytes   956 Mbits/sec  82482  
[  5]  20.00-21.00  sec   114 MBytes   957 Mbits/sec  82580  
[  5]  21.00-22.00  sec   114 MBytes   956 Mbits/sec  82610  
[  5]  22.00-23.00  sec   114 MBytes   956 Mbits/sec  82485  
[  5]  23.00-24.00  sec   114 MBytes   956 Mbits/sec  82562  
[  5]  24.00-25.00  sec   114 MBytes   956 Mbits/sec  82563  
[  5]  25.00-26.00  sec   114 MBytes   957 Mbits/sec  82594  
[  5]  26.00-27.00  sec   114 MBytes   956 Mbits/sec  82531  
[  5]  27.00-28.00  sec   114 MBytes   956 Mbits/sec  82641  
[  5]  28.00-29.00  sec   114 MBytes   956 Mbits/sec  82563  
[  5]  29.00-30.00  sec   114 MBytes   956 Mbits/sec  82531  
[  5]  30.00-31.00  sec   114 MBytes   957 Mbits/sec  82594  
[  5]  31.00-32.00  sec   114 MBytes   956 Mbits/sec  82485  
[  5]  32.00-33.00  sec   114 MBytes   956 Mbits/sec  82609  
[  5]  33.00-34.00  sec   114 MBytes   956 Mbits/sec  82555  
[  5]  34.00-35.00  sec   114 MBytes   956 Mbits/sec  82492  
[  5]  35.00-36.00  sec   114 MBytes   957 Mbits/sec  82579  
[  5]  36.00-37.00  sec   114 MBytes   956 Mbits/sec  82594  
[  5]  37.00-38.00  sec   114 MBytes   957 Mbits/sec  82578  
[  5]  38.00-39.00  sec   114 MBytes   957 Mbits/sec  82594  
[  5]  39.00-40.00  sec   114 MBytes   956 Mbits/sec  82516  
[  5]  40.00-41.00  sec   114 MBytes   957 Mbits/sec  82578  
[  5]  41.00-42.00  sec   114 MBytes   956 Mbits/sec  82547  
[  5]  42.00-43.00  sec   114 MBytes   956 Mbits/sec  82563  
[  5]  43.00-44.00  sec   114 MBytes   956 Mbits/sec  82547  
[  5]  44.00-45.00  sec   114 MBytes   957 Mbits/sec  82578  
[  5]  45.00-46.00  sec   114 MBytes   956 Mbits/sec  82565  
[  5]  46.00-47.00  sec   114 MBytes   957 Mbits/sec  82576  
[  5]  47.00-48.00  sec   114 MBytes   956 Mbits/sec  82500  
[  5]  48.00-49.00  sec   114 MBytes   956 Mbits/sec  82561  
[  5]  49.00-50.00  sec   114 MBytes   956 Mbits/sec  82627  
^C[  5]  50.00-50.67  sec  75.7 MBytes   956 Mbits/sec  54818  
- - - - - - - - - - - - - - - - - - - - - - - - -
[ ID] Interval           Transfer     Bitrate         Jitter    Lost/Total Datagrams
[  5]   0.00-50.67  sec  5.64 GBytes   956 Mbits/sec  0.000 ms  0/4182927 (0%)  sender
[  5]   0.00-50.67  sec  0.00 Bytes  0.00 bits/sec  0.000 ms  0/0 (0%)  receiver
iperf3: interrupt - the client has terminated
(base) kim@kim-System-Product-Name:~$ ^C
(base) kim@kim-System-Product-Name:~$ ^C
(base) kim@kim-System-Product-Name:~$ ^C
(base) kim@kim-System-Product-Name:~$ #!/usr/bin/env bash
# teardown_namespaces.sh
# 리눅스 네임스페이스 및 veth 인터페이스 초기화 스크립트

set -e

echo "▶ 네임스페이스 및 veth 페어 초기화 시작..."

# 1) ns1, ns2 네임스페이스 삭제 (존재해도 무시)
sudo ip netns del ns1 2>/dev/null || true
sudo ip netns del ns2 2>/dev/null || true

# 2) 호스트에 남아 있는 veth0, veth1 삭제
for IF in veth0 veth1; do
  if ip link show "$IF" &>/dev/null; then
    sudo ip link delete "$IF"
    echo "  • 인터페이스 $IF 삭제됨"
  fi
done

echo "✔ 모든 네임스페이스 및 veth 초기화 완료."
▶ 네임스페이스 및 veth 페어 초기화 시작...
[sudo] password for kim: 
✔ 모든 네임스페이스 및 veth 초기화 완료.
(base) kim@kim-System-Product-Name:~$ 
